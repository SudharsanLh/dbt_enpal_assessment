[0m12:59:01.729091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107565790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d3a60>]}


============================== 12:59:01.731960 | 64a514ed-590f-4fa4-a4ec-cec4d079dda2 ==============================
[0m12:59:01.731960 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:59:01.732304 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'target_path': 'None'}
[0m12:59:01.847555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64a514ed-590f-4fa4-a4ec-cec4d079dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078affd0>]}
[0m12:59:01.882939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64a514ed-590f-4fa4-a4ec-cec4d079dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa5880>]}
[0m12:59:01.883563 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:59:01.956799 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:59:02.015031 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:59:02.015364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '64a514ed-590f-4fa4-a4ec-cec4d079dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e765e0>]}
[0m12:59:02.676054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64a514ed-590f-4fa4-a4ec-cec4d079dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109856100>]}
[0m12:59:02.721380 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:59:02.724291 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:59:02.737305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64a514ed-590f-4fa4-a4ec-cec4d079dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a84f0>]}
[0m12:59:02.737603 [info ] [MainThread]: Found 1 model, 1 source, 447 macros
[0m12:59:02.737793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a514ed-590f-4fa4-a4ec-cec4d079dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a24c0>]}
[0m12:59:02.738720 [info ] [MainThread]: 
[0m12:59:02.738935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:02.739096 [info ] [MainThread]: 
[0m12:59:02.739384 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:59:02.739860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:59:02.772100 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:59:02.772377 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:59:02.772556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:02.893065 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.120 seconds
[0m12:59:02.894172 [debug] [ThreadPool]: On list_postgres: Close
[0m12:59:02.894725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics)
[0m12:59:02.895055 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics"
"
[0m12:59:02.899347 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m12:59:02.899623 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: BEGIN
[0m12:59:02.899810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:02.913580 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:59:02.913961 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m12:59:02.914202 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics"} */
create schema if not exists "public_pipedrive_analytics"
[0m12:59:02.915608 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:59:02.916388 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m12:59:02.916657 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m12:59:02.916852 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m12:59:02.918075 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:59:02.918375 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: Close
[0m12:59:02.919299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_pipedrive_analytics, now list_postgres_public_pipedrive_analytics)
[0m12:59:02.924176 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:59:02.924423 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m12:59:02.924605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:02.934185 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:59:02.934605 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:59:02.934976 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m12:59:02.938412 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:59:02.939344 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m12:59:02.939808 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m12:59:02.943106 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:02.943364 [debug] [MainThread]: On master: BEGIN
[0m12:59:02.943532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:02.958948 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:59:02.959355 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:02.959649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:59:02.964292 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:59:02.965198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a514ed-590f-4fa4-a4ec-cec4d079dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cea1f0>]}
[0m12:59:02.965548 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:02.966075 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:02.966268 [debug] [MainThread]: On master: BEGIN
[0m12:59:02.966979 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:59:02.967260 [debug] [MainThread]: On master: COMMIT
[0m12:59:02.967497 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:02.967691 [debug] [MainThread]: On master: COMMIT
[0m12:59:02.968207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:02.968405 [debug] [MainThread]: On master: Close
[0m12:59:02.971546 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m12:59:02.971975 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m12:59:02.972397 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m12:59:02.972711 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m12:59:02.979062 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m12:59:02.979542 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m12:59:03.006865 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m12:59:03.007447 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:59:03.007651 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m12:59:03.007833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:59:03.019011 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:59:03.019337 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:59:03.019555 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m12:59:03.024702 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.005 seconds
[0m12:59:03.031226 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:59:03.031461 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m12:59:03.032429 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:03.040920 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m12:59:03.041142 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:59:03.041331 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m12:59:03.044954 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m12:59:03.048813 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m12:59:03.051573 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:59:03.051803 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m12:59:03.053056 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m12:59:03.054592 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m12:59:03.055810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64a514ed-590f-4fa4-a4ec-cec4d079dda2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d110a0>]}
[0m12:59:03.056199 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.08s]
[0m12:59:03.056535 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m12:59:03.057233 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:03.057435 [debug] [MainThread]: On master: BEGIN
[0m12:59:03.057594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:03.069589 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:59:03.069929 [debug] [MainThread]: On master: COMMIT
[0m12:59:03.070149 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:03.070314 [debug] [MainThread]: On master: COMMIT
[0m12:59:03.070749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:03.070970 [debug] [MainThread]: On master: Close
[0m12:59:03.071250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:03.071402 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m12:59:03.071571 [info ] [MainThread]: 
[0m12:59:03.071766 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m12:59:03.072150 [debug] [MainThread]: Command end result
[0m12:59:03.121349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:59:03.122501 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:59:03.126215 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m12:59:03.126407 [info ] [MainThread]: 
[0m12:59:03.126651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:03.126825 [info ] [MainThread]: 
[0m12:59:03.127006 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:59:03.128579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4475698, "process_in_blocks": "0", "process_kernel_time": 0.179429, "process_mem_max_rss": "134184960", "process_out_blocks": "0", "process_user_time": 1.868552}
[0m12:59:03.128828 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:03.128777 after 1.45 seconds
[0m12:59:03.129033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107565790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107851fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a69b50>]}
[0m12:59:03.129244 [debug] [MainThread]: Flushing usage events
[0m12:59:03.632708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:14:27.145986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110013820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111984d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111984b50>]}


============================== 00:14:27.148904 | 656e1958-48c7-487f-b516-668cb3c03e41 ==============================
[0m00:14:27.148904 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:14:27.149238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'target_path': 'None', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False'}
[0m00:14:27.297629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '656e1958-48c7-487f-b516-668cb3c03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a69ca0>]}
[0m00:14:27.332846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '656e1958-48c7-487f-b516-668cb3c03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11193c8b0>]}
[0m00:14:27.333438 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:14:27.405073 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:14:27.483351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m00:14:27.483667 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/activity.sql
[0m00:14:27.483906 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/sources.yml
[0m00:14:27.667773 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "postgres_public_activity".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("postgres_public", "activity").
  
  To fix this, change the name of one of these resources:
  - source.enpal_assessment_project.postgres_public.activity (models/staging/sources.yml)
  - source.enpal_assessment_project.postgres_public.activity (models/sources.yml)
[0m00:14:27.670453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5700432, "process_in_blocks": "0", "process_kernel_time": 0.183847, "process_mem_max_rss": "113033216", "process_out_blocks": "0", "process_user_time": 1.158093}
[0m00:14:27.670700 [debug] [MainThread]: Command `dbt run` failed at 00:14:27.670648 after 0.57 seconds
[0m00:14:27.670909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110013820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133bfc10>]}
[0m00:14:27.671116 [debug] [MainThread]: Flushing usage events
[0m00:14:28.206136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:15:50.502523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f04cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f04af0>]}


============================== 00:15:50.505318 | fbb7b718-8dfb-4c6f-bbac-0be5472777a2 ==============================
[0m00:15:50.505318 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:15:50.505651 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'empty': 'False', 'fail_fast': 'False', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'log_cache_events': 'False'}
[0m00:15:50.608111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbb7b718-8dfb-4c6f-bbac-0be5472777a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dea880>]}
[0m00:15:50.645420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbb7b718-8dfb-4c6f-bbac-0be5472777a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec8160>]}
[0m00:15:50.646474 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:15:50.718971 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:15:50.797668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m00:15:50.798008 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/activity.sql
[0m00:15:50.798226 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/sources.yml
[0m00:15:50.992049 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.activity' (models/staging/activity.sql) depends on a source named 'postgres_public.activity_types' which was not found
[0m00:15:50.993288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5335053, "process_in_blocks": "0", "process_kernel_time": 0.136202, "process_mem_max_rss": "113065984", "process_out_blocks": "0", "process_user_time": 1.178012}
[0m00:15:50.993531 [debug] [MainThread]: Command `dbt run` failed at 00:15:50.993480 after 0.53 seconds
[0m00:15:50.993742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111732df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112393910>]}
[0m00:15:50.993948 [debug] [MainThread]: Flushing usage events
[0m00:15:51.526769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:17:32.679749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f63b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f63970>]}


============================== 00:17:32.682808 | ed3adfa3-372f-4d0a-9c7a-77a4593ad8b3 ==============================
[0m00:17:32.682808 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:17:32.683151 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False'}
[0m00:17:32.795396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed3adfa3-372f-4d0a-9c7a-77a4593ad8b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f63970>]}
[0m00:17:32.830633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed3adfa3-372f-4d0a-9c7a-77a4593ad8b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106806730>]}
[0m00:17:32.831664 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:17:32.903557 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:17:32.980704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m00:17:32.981066 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/sources.yml
[0m00:17:32.981260 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/activity_types.sql
[0m00:17:33.218153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed3adfa3-372f-4d0a-9c7a-77a4593ad8b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108085940>]}
[0m00:17:33.263802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m00:17:33.265046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m00:17:33.275820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed3adfa3-372f-4d0a-9c7a-77a4593ad8b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa1760>]}
[0m00:17:33.276117 [info ] [MainThread]: Found 2 models, 2 sources, 447 macros
[0m00:17:33.276310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed3adfa3-372f-4d0a-9c7a-77a4593ad8b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f163d0>]}
[0m00:17:33.277074 [info ] [MainThread]: 
[0m00:17:33.277264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:17:33.277422 [info ] [MainThread]: 
[0m00:17:33.277686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:17:33.280070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:17:33.313686 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:17:33.313972 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:17:33.314145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:33.347890 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.034 seconds
[0m00:17:33.348729 [debug] [ThreadPool]: On list_postgres: Close
[0m00:17:33.349489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m00:17:33.353493 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:17:33.353696 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m00:17:33.353848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:33.365179 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:17:33.365392 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:17:33.365599 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m00:17:33.367961 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m00:17:33.368752 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m00:17:33.369218 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m00:17:33.372273 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:33.372510 [debug] [MainThread]: On master: BEGIN
[0m00:17:33.372673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:33.380820 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m00:17:33.381059 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:33.381283 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:17:33.383727 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m00:17:33.384471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed3adfa3-372f-4d0a-9c7a-77a4593ad8b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee8b50>]}
[0m00:17:33.384769 [debug] [MainThread]: On master: ROLLBACK
[0m00:17:33.385207 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:33.385372 [debug] [MainThread]: On master: BEGIN
[0m00:17:33.386141 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:17:33.386412 [debug] [MainThread]: On master: COMMIT
[0m00:17:33.386598 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:33.386766 [debug] [MainThread]: On master: COMMIT
[0m00:17:33.387221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:17:33.387432 [debug] [MainThread]: On master: Close
[0m00:17:33.389135 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m00:17:33.389495 [info ] [Thread-1  ]: 1 of 2 START sql table model public_pipedrive_analytics.activity_types ......... [RUN]
[0m00:17:33.389803 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.activity_types)
[0m00:17:33.390013 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m00:17:33.395456 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m00:17:33.396017 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m00:17:33.419849 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m00:17:33.420551 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:17:33.420767 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m00:17:33.420956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:17:33.433700 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m00:17:33.434046 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:17:33.434334 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."staging"."activity_types"
  );
  
[0m00:17:33.434945 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging.activity_types" does not exist
LINE 15: FROM "postgres"."staging"."activity_types"
              ^

[0m00:17:33.435169 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: ROLLBACK
[0m00:17:33.435688 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m00:17:33.451173 [debug] [Thread-1  ]: Database Error in model activity_types (models/staging/activity_types.sql)
  relation "staging.activity_types" does not exist
  LINE 15: FROM "postgres"."staging"."activity_types"
                ^
  compiled code at target/run/enpal_assessment_project/models/staging/activity_types.sql
[0m00:17:33.452627 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed3adfa3-372f-4d0a-9c7a-77a4593ad8b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061cb8b0>]}
[0m00:17:33.453064 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model public_pipedrive_analytics.activity_types  [[31mERROR[0m in 0.06s]
[0m00:17:33.453416 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m00:17:33.453653 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m00:17:33.454166 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.activity_types' to be skipped because of status 'error'.  Reason: Database Error in model activity_types (models/staging/activity_types.sql)
  relation "staging.activity_types" does not exist
  LINE 15: FROM "postgres"."staging"."activity_types"
                ^
  compiled code at target/run/enpal_assessment_project/models/staging/activity_types.sql.
[0m00:17:33.453911 [info ] [Thread-1  ]: 2 of 2 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m00:17:33.454568 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.test_model)
[0m00:17:33.454785 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m00:17:33.456841 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m00:17:33.457361 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m00:17:33.459839 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m00:17:33.460264 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:17:33.460458 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m00:17:33.460632 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:17:33.475507 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m00:17:33.475785 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:17:33.475990 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m00:17:33.480299 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.004 seconds
[0m00:17:33.486825 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:17:33.487107 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m00:17:33.488057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:17:33.490131 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:17:33.490379 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m00:17:33.491120 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:17:33.501316 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m00:17:33.501626 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:17:33.501827 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m00:17:33.504636 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m00:17:33.508709 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m00:17:33.511378 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:17:33.511613 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m00:17:33.515139 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m00:17:33.516746 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m00:17:33.517146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed3adfa3-372f-4d0a-9c7a-77a4593ad8b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048732e0>]}
[0m00:17:33.517538 [info ] [Thread-1  ]: 2 of 2 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.06s]
[0m00:17:33.517867 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m00:17:33.518485 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:33.518659 [debug] [MainThread]: On master: BEGIN
[0m00:17:33.518811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:33.527051 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m00:17:33.527449 [debug] [MainThread]: On master: COMMIT
[0m00:17:33.527671 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:33.527831 [debug] [MainThread]: On master: COMMIT
[0m00:17:33.528344 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:17:33.528612 [debug] [MainThread]: On master: Close
[0m00:17:33.528898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:33.529069 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m00:17:33.529297 [info ] [MainThread]: 
[0m00:17:33.529481 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:17:33.529966 [debug] [MainThread]: Command end result
[0m00:17:33.547917 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m00:17:33.549376 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m00:17:33.553424 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m00:17:33.553614 [info ] [MainThread]: 
[0m00:17:33.553829 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:17:33.554007 [info ] [MainThread]: 
[0m00:17:33.554224 [error] [MainThread]: [31mFailure in model activity_types (models/staging/activity_types.sql)[0m
[0m00:17:33.554430 [error] [MainThread]:   Database Error in model activity_types (models/staging/activity_types.sql)
  relation "staging.activity_types" does not exist
  LINE 15: FROM "postgres"."staging"."activity_types"
                ^
  compiled code at target/run/enpal_assessment_project/models/staging/activity_types.sql
[0m00:17:33.554591 [info ] [MainThread]: 
[0m00:17:33.554780 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/activity_types.sql
[0m00:17:33.554933 [info ] [MainThread]: 
[0m00:17:33.555104 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m00:17:33.556178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.924461, "process_in_blocks": "0", "process_kernel_time": 0.15796, "process_mem_max_rss": "133595136", "process_out_blocks": "0", "process_user_time": 1.42996}
[0m00:17:33.556417 [debug] [MainThread]: Command `dbt run` failed at 00:17:33.556368 after 0.92 seconds
[0m00:17:33.556637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806cd90>]}
[0m00:17:33.556860 [debug] [MainThread]: Flushing usage events
[0m00:17:34.060436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:21.693511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bcb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bc9a0>]}


============================== 00:29:21.696720 | 2b117c59-acdf-44ab-b4b8-db453007c759 ==============================
[0m00:29:21.696720 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:29:21.697081 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'no_print': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'warn_error': 'None', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'static_parser': 'True'}
[0m00:29:21.808655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b117c59-acdf-44ab-b4b8-db453007c759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cf05b0>]}
[0m00:29:21.844118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b117c59-acdf-44ab-b4b8-db453007c759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063748b0>]}
[0m00:29:21.845131 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:29:21.916939 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:29:21.993331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:29:21.993747 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/sources.yml
[0m00:29:21.993944 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/activity_types.sql
[0m00:29:22.233463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b117c59-acdf-44ab-b4b8-db453007c759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ea550>]}
[0m00:29:22.278766 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m00:29:22.280240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m00:29:22.290135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b117c59-acdf-44ab-b4b8-db453007c759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b521f0>]}
[0m00:29:22.290417 [info ] [MainThread]: Found 2 models, 7 sources, 447 macros
[0m00:29:22.290614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b117c59-acdf-44ab-b4b8-db453007c759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742d520>]}
[0m00:29:22.291395 [info ] [MainThread]: 
[0m00:29:22.291590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:29:22.291749 [info ] [MainThread]: 
[0m00:29:22.292010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:29:22.294407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:29:22.324791 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:29:22.325068 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:29:22.325232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:22.357931 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m00:29:22.358736 [debug] [ThreadPool]: On list_postgres: Close
[0m00:29:22.359472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m00:29:22.363554 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:29:22.363763 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m00:29:22.363909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:22.374445 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:29:22.374664 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:29:22.374855 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m00:29:22.377152 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m00:29:22.377888 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m00:29:22.378327 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m00:29:22.381184 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:22.381411 [debug] [MainThread]: On master: BEGIN
[0m00:29:22.381567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:22.388384 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m00:29:22.388600 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:22.388821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:29:22.391155 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m00:29:22.391869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b117c59-acdf-44ab-b4b8-db453007c759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a82eb0>]}
[0m00:29:22.392159 [debug] [MainThread]: On master: ROLLBACK
[0m00:29:22.392573 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:22.392763 [debug] [MainThread]: On master: BEGIN
[0m00:29:22.393382 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:29:22.393589 [debug] [MainThread]: On master: COMMIT
[0m00:29:22.393931 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:22.394164 [debug] [MainThread]: On master: COMMIT
[0m00:29:22.394610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:29:22.394825 [debug] [MainThread]: On master: Close
[0m00:29:22.396513 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m00:29:22.396896 [info ] [Thread-1  ]: 1 of 2 START sql table model public_pipedrive_analytics.activity_types ......... [RUN]
[0m00:29:22.397171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.activity_types)
[0m00:29:22.397387 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m00:29:22.402510 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m00:29:22.402977 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m00:29:22.426747 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m00:29:22.427435 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:29:22.427649 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m00:29:22.427842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:29:22.441078 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m00:29:22.441595 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:29:22.441841 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m00:29:22.448121 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.006 seconds
[0m00:29:22.454866 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:29:22.455129 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."activity_types__dbt_tmp" rename to "activity_types"
[0m00:29:22.456851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:29:22.466333 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m00:29:22.466611 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:29:22.466810 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m00:29:22.470651 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m00:29:22.474550 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."activity_types__dbt_backup"
[0m00:29:22.477154 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:29:22.477365 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."public_pipedrive_analytics"."activity_types__dbt_backup" cascade
[0m00:29:22.479627 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m00:29:22.481206 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m00:29:22.482499 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b117c59-acdf-44ab-b4b8-db453007c759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a527f0>]}
[0m00:29:22.482877 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public_pipedrive_analytics.activity_types .... [[32mSELECT 4579[0m in 0.08s]
[0m00:29:22.483199 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m00:29:22.483405 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m00:29:22.483644 [info ] [Thread-1  ]: 2 of 2 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m00:29:22.483958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.test_model)
[0m00:29:22.484216 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m00:29:22.486106 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m00:29:22.486576 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m00:29:22.488889 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m00:29:22.489426 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:29:22.489621 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m00:29:22.489790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:29:22.500050 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m00:29:22.500349 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:29:22.500557 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m00:29:22.503812 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m00:29:22.506868 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:29:22.507094 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m00:29:22.507729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:29:22.509558 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:29:22.509758 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m00:29:22.510312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:29:22.512412 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m00:29:22.512629 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:29:22.512817 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m00:29:22.514217 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m00:29:22.515773 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m00:29:22.516184 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:29:22.516384 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m00:29:22.517824 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m00:29:22.518564 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m00:29:22.518913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b117c59-acdf-44ab-b4b8-db453007c759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd9220>]}
[0m00:29:22.519303 [info ] [Thread-1  ]: 2 of 2 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.03s]
[0m00:29:22.519631 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m00:29:22.520348 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:22.520548 [debug] [MainThread]: On master: BEGIN
[0m00:29:22.520697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:29:22.528997 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m00:29:22.529330 [debug] [MainThread]: On master: COMMIT
[0m00:29:22.529538 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:22.529722 [debug] [MainThread]: On master: COMMIT
[0m00:29:22.530195 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:29:22.530361 [debug] [MainThread]: On master: Close
[0m00:29:22.530608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:22.530761 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m00:29:22.530971 [info ] [MainThread]: 
[0m00:29:22.531151 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m00:29:22.531611 [debug] [MainThread]: Command end result
[0m00:29:22.548543 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m00:29:22.549728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m00:29:22.553591 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m00:29:22.553798 [info ] [MainThread]: 
[0m00:29:22.554024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:22.554242 [info ] [MainThread]: 
[0m00:29:22.554553 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m00:29:22.555614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9076153, "process_in_blocks": "0", "process_kernel_time": 0.164408, "process_mem_max_rss": "130662400", "process_out_blocks": "0", "process_user_time": 1.413941}
[0m00:29:22.555845 [debug] [MainThread]: Command `dbt run` succeeded at 00:29:22.555797 after 0.91 seconds
[0m00:29:22.556045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f60d0>]}
[0m00:29:22.556256 [debug] [MainThread]: Flushing usage events
[0m00:29:23.110274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:51.186956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499db50>]}


============================== 00:37:51.190002 | c77bf3d8-d327-40ab-9779-ffeda18c7f7f ==============================
[0m00:37:51.190002 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:37:51.190354 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'log_cache_events': 'False', 'introspect': 'True', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False'}
[0m00:37:51.308064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c77bf3d8-d327-40ab-9779-ffeda18c7f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d0bb0>]}
[0m00:37:51.343017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c77bf3d8-d327-40ab-9779-ffeda18c7f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104969bb0>]}
[0m00:37:51.343612 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:37:51.414873 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:37:51.473770 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:37:51.474116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c77bf3d8-d327-40ab-9779-ffeda18c7f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d5730>]}
[0m00:37:52.139245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m00:37:52.146088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c77bf3d8-d327-40ab-9779-ffeda18c7f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb4130>]}
[0m00:37:52.195279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m00:37:52.196748 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m00:37:52.239898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c77bf3d8-d327-40ab-9779-ffeda18c7f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b229a0>]}
[0m00:37:52.240333 [info ] [MainThread]: Found 2 models, 7 sources, 447 macros
[0m00:37:52.240546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c77bf3d8-d327-40ab-9779-ffeda18c7f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c16c10>]}
[0m00:37:52.241463 [info ] [MainThread]: 
[0m00:37:52.241674 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:37:52.241833 [info ] [MainThread]: 
[0m00:37:52.242129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:37:52.244913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:37:52.276681 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:37:52.276956 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:37:52.277124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:52.308130 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.031 seconds
[0m00:37:52.308952 [debug] [ThreadPool]: On list_postgres: Close
[0m00:37:52.309689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m00:37:52.313999 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:37:52.314219 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m00:37:52.314375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:52.323901 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m00:37:52.324134 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:37:52.324323 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m00:37:52.326296 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m00:37:52.327083 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m00:37:52.327521 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m00:37:52.330829 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:52.331108 [debug] [MainThread]: On master: BEGIN
[0m00:37:52.331278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:52.338493 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m00:37:52.338718 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:52.338931 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:37:52.341113 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m00:37:52.341882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c77bf3d8-d327-40ab-9779-ffeda18c7f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105acc610>]}
[0m00:37:52.342168 [debug] [MainThread]: On master: ROLLBACK
[0m00:37:52.342639 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:52.342840 [debug] [MainThread]: On master: BEGIN
[0m00:37:52.343507 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:37:52.343687 [debug] [MainThread]: On master: COMMIT
[0m00:37:52.343878 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:52.344041 [debug] [MainThread]: On master: COMMIT
[0m00:37:52.344483 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:37:52.344662 [debug] [MainThread]: On master: Close
[0m00:37:52.346345 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m00:37:52.346691 [info ] [Thread-1  ]: 1 of 2 START sql table model public_pipedrive_analytics.activity_types ......... [RUN]
[0m00:37:52.346971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.activity_types)
[0m00:37:52.347178 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m00:37:52.352393 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m00:37:52.352867 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m00:37:52.375468 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m00:37:52.376059 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:37:52.376265 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m00:37:52.376447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:37:52.392922 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m00:37:52.393323 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:37:52.393739 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m00:37:52.398415 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.004 seconds
[0m00:37:52.405252 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:37:52.405525 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."activity_types" rename to "activity_types__dbt_backup"
[0m00:37:52.406375 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:37:52.409241 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:37:52.409458 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."activity_types__dbt_tmp" rename to "activity_types"
[0m00:37:52.410071 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:37:52.419802 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m00:37:52.420025 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:37:52.420212 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m00:37:52.423388 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m00:37:52.427029 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."activity_types__dbt_backup"
[0m00:37:52.429446 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:37:52.429698 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."public_pipedrive_analytics"."activity_types__dbt_backup" cascade
[0m00:37:52.435291 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m00:37:52.436738 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m00:37:52.438009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c77bf3d8-d327-40ab-9779-ffeda18c7f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10493ebe0>]}
[0m00:37:52.438410 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public_pipedrive_analytics.activity_types .... [[32mSELECT 4579[0m in 0.09s]
[0m00:37:52.438740 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m00:37:52.438960 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m00:37:52.439246 [info ] [Thread-1  ]: 2 of 2 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m00:37:52.439491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.test_model)
[0m00:37:52.439688 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m00:37:52.441480 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m00:37:52.441913 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m00:37:52.444117 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m00:37:52.444465 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:37:52.444657 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m00:37:52.444889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:37:52.455263 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m00:37:52.455543 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:37:52.455745 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m00:37:52.458737 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m00:37:52.461044 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:37:52.461263 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m00:37:52.463002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:37:52.465064 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:37:52.465282 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m00:37:52.466980 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:37:52.468253 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m00:37:52.468542 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:37:52.468751 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m00:37:52.474090 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m00:37:52.476854 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m00:37:52.477342 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:37:52.477549 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m00:37:52.480197 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m00:37:52.480966 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m00:37:52.481330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c77bf3d8-d327-40ab-9779-ffeda18c7f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033bb250>]}
[0m00:37:52.481713 [info ] [Thread-1  ]: 2 of 2 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.04s]
[0m00:37:52.482033 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m00:37:52.482659 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:52.482855 [debug] [MainThread]: On master: BEGIN
[0m00:37:52.483014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:37:52.493233 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:37:52.493509 [debug] [MainThread]: On master: COMMIT
[0m00:37:52.493682 [debug] [MainThread]: Using postgres connection "master"
[0m00:37:52.493836 [debug] [MainThread]: On master: COMMIT
[0m00:37:52.494272 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:37:52.494483 [debug] [MainThread]: On master: Close
[0m00:37:52.494748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:52.494904 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m00:37:52.495112 [info ] [MainThread]: 
[0m00:37:52.495342 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:37:52.495837 [debug] [MainThread]: Command end result
[0m00:37:52.509540 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m00:37:52.510562 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m00:37:52.514633 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m00:37:52.514843 [info ] [MainThread]: 
[0m00:37:52.515056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:37:52.515221 [info ] [MainThread]: 
[0m00:37:52.515400 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m00:37:52.516445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3741256, "process_in_blocks": "0", "process_kernel_time": 0.176291, "process_mem_max_rss": "132251648", "process_out_blocks": "0", "process_user_time": 1.878913}
[0m00:37:52.516659 [debug] [MainThread]: Command `dbt run` succeeded at 00:37:52.516611 after 1.37 seconds
[0m00:37:52.516858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049876d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c48250>]}
[0m00:37:52.517057 [debug] [MainThread]: Flushing usage events
[0m00:37:53.032270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:39:33.563571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105593820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106605d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106605b50>]}


============================== 00:39:33.565968 | be51c218-ec07-4c02-90fb-7c19ca75630e ==============================
[0m00:39:33.565968 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:39:33.566308 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'fail_fast': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m00:39:33.664798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be51c218-ec07-4c02-90fb-7c19ca75630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106436d30>]}
[0m00:39:33.700437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be51c218-ec07-4c02-90fb-7c19ca75630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb5250>]}
[0m00:39:33.700961 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:39:33.768795 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m00:39:33.827128 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:39:33.827478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be51c218-ec07-4c02-90fb-7c19ca75630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecb370>]}
[0m00:39:34.471760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be51c218-ec07-4c02-90fb-7c19ca75630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792d130>]}
[0m00:39:34.517446 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m00:39:34.519771 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m00:39:34.558739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be51c218-ec07-4c02-90fb-7c19ca75630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d70ca0>]}
[0m00:39:34.559129 [info ] [MainThread]: Found 2 models, 7 sources, 447 macros
[0m00:39:34.559334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be51c218-ec07-4c02-90fb-7c19ca75630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d70cd0>]}
[0m00:39:34.560119 [info ] [MainThread]: 
[0m00:39:34.560312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:34.560472 [info ] [MainThread]: 
[0m00:39:34.560740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:39:34.563224 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:39:34.593884 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:39:34.594155 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:39:34.594321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:34.616094 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m00:39:34.616866 [debug] [ThreadPool]: On list_postgres: Close
[0m00:39:34.618758 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:39:34.618945 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:39:34.619099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:34.626765 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m00:39:34.627478 [debug] [ThreadPool]: On list_postgres: Close
[0m00:39:34.627855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m00:39:34.628118 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m00:39:34.631391 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m00:39:34.631572 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m00:39:34.631722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:34.638541 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m00:39:34.638793 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m00:39:34.638968 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m00:39:34.639644 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m00:39:34.640159 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m00:39:34.640332 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m00:39:34.640484 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m00:39:34.641809 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m00:39:34.642005 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m00:39:34.642684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_staging, now list_postgres_public_pipedrive_analytics)
[0m00:39:34.646416 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:39:34.646610 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m00:39:34.646771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:34.655155 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m00:39:34.655425 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:39:34.655623 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m00:39:34.657592 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m00:39:34.658418 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m00:39:34.658897 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m00:39:34.659251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_staging)
[0m00:39:34.660683 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:39:34.661095 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m00:39:34.661250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:34.668221 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m00:39:34.668466 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m00:39:34.668666 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:39:34.670471 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m00:39:34.671220 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m00:39:34.671666 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m00:39:34.674461 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:34.674690 [debug] [MainThread]: On master: BEGIN
[0m00:39:34.674843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:34.682986 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m00:39:34.683204 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:34.683429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:39:34.685461 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m00:39:34.686240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be51c218-ec07-4c02-90fb-7c19ca75630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a7520>]}
[0m00:39:34.686536 [debug] [MainThread]: On master: ROLLBACK
[0m00:39:34.686951 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:34.687125 [debug] [MainThread]: On master: BEGIN
[0m00:39:34.687725 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:39:34.687895 [debug] [MainThread]: On master: COMMIT
[0m00:39:34.688054 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:34.688206 [debug] [MainThread]: On master: COMMIT
[0m00:39:34.689217 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:39:34.689415 [debug] [MainThread]: On master: Close
[0m00:39:34.691531 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m00:39:34.691926 [info ] [Thread-1  ]: 1 of 2 START sql table model public_staging.activity_types ..................... [RUN]
[0m00:39:34.692244 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now model.enpal_assessment_project.activity_types)
[0m00:39:34.692452 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m00:39:34.698678 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m00:39:34.699409 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m00:39:34.724015 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m00:39:34.724632 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:39:34.724838 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m00:39:34.725023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:34.736241 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m00:39:34.736486 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:39:34.736679 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."public_staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m00:39:34.740053 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m00:39:34.746514 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:39:34.746740 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."public_staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m00:39:34.747377 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:39:34.756009 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m00:39:34.756285 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:39:34.756476 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m00:39:34.760899 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m00:39:34.764783 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."activity_types__dbt_backup"
[0m00:39:34.767319 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m00:39:34.767529 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."public_staging"."activity_types__dbt_backup" cascade
[0m00:39:34.768773 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m00:39:34.770234 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m00:39:34.771460 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be51c218-ec07-4c02-90fb-7c19ca75630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c90700>]}
[0m00:39:34.771853 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public_staging.activity_types ................ [[32mSELECT 4579[0m in 0.08s]
[0m00:39:34.772181 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m00:39:34.772397 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m00:39:34.772641 [info ] [Thread-1  ]: 2 of 2 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m00:39:34.772968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.test_model)
[0m00:39:34.773205 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m00:39:34.774965 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m00:39:34.775381 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m00:39:34.777651 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m00:39:34.778085 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:39:34.778287 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m00:39:34.778467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:39:34.790594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m00:39:34.790921 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:39:34.791189 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m00:39:34.794159 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m00:39:34.797433 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:39:34.797705 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m00:39:34.798406 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:39:34.800664 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:39:34.800900 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m00:39:34.801672 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:39:34.803868 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m00:39:34.804110 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:39:34.804298 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m00:39:34.807678 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m00:39:34.809307 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m00:39:34.809714 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m00:39:34.809903 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m00:39:34.812184 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m00:39:34.813002 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m00:39:34.813387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be51c218-ec07-4c02-90fb-7c19ca75630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdd970>]}
[0m00:39:34.813784 [info ] [Thread-1  ]: 2 of 2 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.04s]
[0m00:39:34.814116 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m00:39:34.814783 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:34.814968 [debug] [MainThread]: On master: BEGIN
[0m00:39:34.815113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:39:34.823479 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m00:39:34.823746 [debug] [MainThread]: On master: COMMIT
[0m00:39:34.823923 [debug] [MainThread]: Using postgres connection "master"
[0m00:39:34.824078 [debug] [MainThread]: On master: COMMIT
[0m00:39:34.824451 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:39:34.824617 [debug] [MainThread]: On master: Close
[0m00:39:34.824863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:34.825017 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m00:39:34.825231 [info ] [MainThread]: 
[0m00:39:34.825409 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m00:39:34.825876 [debug] [MainThread]: Command end result
[0m00:39:34.841062 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m00:39:34.842240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m00:39:34.846552 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m00:39:34.846769 [info ] [MainThread]: 
[0m00:39:34.846980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:34.847147 [info ] [MainThread]: 
[0m00:39:34.847332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m00:39:34.848440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3257055, "process_in_blocks": "0", "process_kernel_time": 0.151762, "process_mem_max_rss": "132808704", "process_out_blocks": "0", "process_user_time": 1.857547}
[0m00:39:34.848668 [debug] [MainThread]: Command `dbt run` succeeded at 00:39:34.848621 after 1.33 seconds
[0m00:39:34.848881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105593820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107827490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076da4c0>]}
[0m00:39:34.849085 [debug] [MainThread]: Flushing usage events
[0m00:39:35.387324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:50.888575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080eecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080eeaf0>]}


============================== 01:02:50.891988 | d80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a ==============================
[0m01:02:50.891988 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:02:50.892361 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'empty': 'False', 'write_json': 'True', 'introspect': 'True', 'fail_fast': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'use_colors': 'True'}
[0m01:02:51.007961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e62b0>]}
[0m01:02:51.043259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b0250>]}
[0m01:02:51.043873 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:51.115813 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:02:51.173648 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:02:51.173959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b4070>]}
[0m01:02:51.829793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097de130>]}
[0m01:02:51.907441 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:02:51.908760 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:02:51.919555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c0970>]}
[0m01:02:51.919861 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:02:51.920059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e8dc0>]}
[0m01:02:51.920865 [info ] [MainThread]: 
[0m01:02:51.921067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:51.921226 [info ] [MainThread]: 
[0m01:02:51.921500 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:51.924143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:02:51.955550 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:51.955814 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:51.955973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:51.987772 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.032 seconds
[0m01:02:51.988570 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:51.990660 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:51.990875 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:51.991061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:52.000155 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m01:02:52.000887 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:52.002389 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:52.002593 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:52.002766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:52.011280 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m01:02:52.012102 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:52.012498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_ods)
[0m01:02:52.012777 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_ods"
"
[0m01:02:52.016169 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_ods"
[0m01:02:52.016384 [debug] [ThreadPool]: On create_postgres_public_ods: BEGIN
[0m01:02:52.016542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:52.024269 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:02:52.024500 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_ods"
[0m01:02:52.024670 [debug] [ThreadPool]: On create_postgres_public_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_ods"} */
create schema if not exists "public_ods"
[0m01:02:52.025207 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:02:52.025710 [debug] [ThreadPool]: On create_postgres_public_ods: COMMIT
[0m01:02:52.025885 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_ods"
[0m01:02:52.026041 [debug] [ThreadPool]: On create_postgres_public_ods: COMMIT
[0m01:02:52.027057 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:02:52.027220 [debug] [ThreadPool]: On create_postgres_public_ods: Close
[0m01:02:52.028005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_ods, now list_postgres_public_ods)
[0m01:02:52.031779 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_ods"
[0m01:02:52.031983 [debug] [ThreadPool]: On list_postgres_public_ods: BEGIN
[0m01:02:52.032144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:52.039365 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:02:52.039579 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_ods"
[0m01:02:52.039760 [debug] [ThreadPool]: On list_postgres_public_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_ods'
  
[0m01:02:52.041710 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:02:52.042415 [debug] [ThreadPool]: On list_postgres_public_ods: ROLLBACK
[0m01:02:52.042830 [debug] [ThreadPool]: On list_postgres_public_ods: Close
[0m01:02:52.043138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_ods, now list_postgres_public_staging)
[0m01:02:52.044556 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:02:52.044766 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m01:02:52.044951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:52.051945 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:02:52.052178 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m01:02:52.052362 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:02:52.054352 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:02:52.055091 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m01:02:52.055493 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m01:02:52.055813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_pipedrive_analytics)
[0m01:02:52.057375 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:02:52.057559 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:02:52.057711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:52.064582 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:02:52.064835 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:02:52.065028 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:02:52.067074 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:02:52.067882 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:02:52.068320 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:02:52.072252 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:52.072482 [debug] [MainThread]: On master: BEGIN
[0m01:02:52.072638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:52.079965 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m01:02:52.080247 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:52.080481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:52.084119 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:02:52.085012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c0dc0>]}
[0m01:02:52.085406 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:52.085934 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:52.086157 [debug] [MainThread]: On master: BEGIN
[0m01:02:52.086979 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:02:52.087227 [debug] [MainThread]: On master: COMMIT
[0m01:02:52.087410 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:52.087572 [debug] [MainThread]: On master: COMMIT
[0m01:02:52.088039 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:52.088238 [debug] [MainThread]: On master: Close
[0m01:02:52.090968 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m01:02:52.091355 [info ] [Thread-1  ]: 1 of 3 START sql table model public_staging.activity_types ..................... [RUN]
[0m01:02:52.091642 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.activity_types)
[0m01:02:52.091843 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m01:02:52.097353 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m01:02:52.098178 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m01:02:52.122255 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m01:02:52.122867 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:02:52.123073 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m01:02:52.123258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:02:52.135322 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m01:02:52.135536 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:02:52.135735 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."public_staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m01:02:52.139094 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:02:52.145502 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:02:52.145733 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."public_staging"."activity_types" rename to "activity_types__dbt_backup"
[0m01:02:52.146348 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:02:52.148221 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:02:52.148427 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."public_staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m01:02:52.149606 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:52.159223 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:02:52.159483 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:02:52.159686 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:02:52.163643 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m01:02:52.168536 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_staging"."activity_types__dbt_backup"
[0m01:02:52.171001 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:02:52.171208 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."public_staging"."activity_types__dbt_backup" cascade
[0m01:02:52.174422 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m01:02:52.175898 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m01:02:52.177175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fa310>]}
[0m01:02:52.177556 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public_staging.activity_types ................ [[32mSELECT 4579[0m in 0.08s]
[0m01:02:52.177875 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m01:02:52.178084 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m01:02:52.178386 [info ] [Thread-1  ]: 2 of 3 START sql table model public_ods.ods_deal ............................... [RUN]
[0m01:02:52.178638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.ods_deal)
[0m01:02:52.178833 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m01:02:52.180770 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m01:02:52.181281 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m01:02:52.183586 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m01:02:52.184127 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:02:52.184338 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m01:02:52.184709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:02:52.196131 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m01:02:52.196406 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:02:52.196607 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."public_ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."deal_changes"
  );
  
[0m01:02:52.202631 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.006 seconds
[0m01:02:52.205018 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:02:52.205243 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."public_ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m01:02:52.205857 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:02:52.206667 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:02:52.206872 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:02:52.207056 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:02:52.209006 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:02:52.210677 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_ods"."ods_deal__dbt_backup"
[0m01:02:52.211091 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:02:52.211287 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."public_ods"."ods_deal__dbt_backup" cascade
[0m01:02:52.211774 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m01:02:52.212537 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m01:02:52.212897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bff40>]}
[0m01:02:52.213293 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public_ods.ods_deal .......................... [[32mSELECT 15406[0m in 0.03s]
[0m01:02:52.213614 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m01:02:52.213836 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m01:02:52.214090 [info ] [Thread-1  ]: 3 of 3 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m01:02:52.214382 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal, now model.enpal_assessment_project.test_model)
[0m01:02:52.214603 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m01:02:52.216523 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m01:02:52.217025 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m01:02:52.220191 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m01:02:52.220604 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:02:52.220806 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m01:02:52.220997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:02:52.228029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m01:02:52.228293 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:02:52.228499 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m01:02:52.230890 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.002 seconds
[0m01:02:52.233110 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:02:52.233356 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m01:02:52.233982 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:02:52.236086 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:02:52.236363 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m01:02:52.237094 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:02:52.238131 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:02:52.238355 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:02:52.238535 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:02:52.240396 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:02:52.242151 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m01:02:52.242562 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:02:52.242757 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m01:02:52.245412 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m01:02:52.246181 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m01:02:52.246559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80b67c5-c5a9-4ba8-85c4-d35c5cb27c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1f880>]}
[0m01:02:52.246945 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.03s]
[0m01:02:52.247281 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m01:02:52.248054 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:52.248241 [debug] [MainThread]: On master: BEGIN
[0m01:02:52.248395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:52.257436 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:02:52.257679 [debug] [MainThread]: On master: COMMIT
[0m01:02:52.257853 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:52.258008 [debug] [MainThread]: On master: COMMIT
[0m01:02:52.258413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:52.258615 [debug] [MainThread]: On master: Close
[0m01:02:52.258869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:52.259030 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m01:02:52.259261 [info ] [MainThread]: 
[0m01:02:52.259447 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m01:02:52.259994 [debug] [MainThread]: Command end result
[0m01:02:52.274898 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:02:52.276014 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:02:52.280225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m01:02:52.280406 [info ] [MainThread]: 
[0m01:02:52.280621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:52.280798 [info ] [MainThread]: 
[0m01:02:52.280980 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:02:52.282410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4403884, "process_in_blocks": "0", "process_kernel_time": 0.203832, "process_mem_max_rss": "131694592", "process_out_blocks": "0", "process_user_time": 1.898571}
[0m01:02:52.282635 [debug] [MainThread]: Command `dbt run` succeeded at 01:02:52.282588 after 1.44 seconds
[0m01:02:52.282841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca1bb0>]}
[0m01:02:52.283047 [debug] [MainThread]: Flushing usage events
[0m01:02:52.778858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:04:42.918458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132c5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132c58b0>]}


============================== 01:04:42.920872 | 0a622f55-713b-4923-bf79-22a7c36c4f49 ==============================
[0m01:04:42.920872 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:04:42.921209 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'no_print': 'None', 'empty': 'False', 'partial_parse': 'True', 'warn_error': 'None'}
[0m01:04:43.021553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132730a0>]}
[0m01:04:43.057484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137e0340>]}
[0m01:04:43.058048 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:04:43.126851 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:04:43.185303 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:04:43.185665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a8c280>]}
[0m01:04:43.827544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11499a130>]}
[0m01:04:43.906297 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:04:43.907408 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:04:43.914004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149726a0>]}
[0m01:04:43.914300 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:04:43.914497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11499dca0>]}
[0m01:04:43.915280 [info ] [MainThread]: 
[0m01:04:43.915470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:43.915628 [info ] [MainThread]: 
[0m01:04:43.915898 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:04:43.918494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:04:43.948461 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:04:43.948755 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:04:43.948916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:43.969483 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m01:04:43.970309 [debug] [ThreadPool]: On list_postgres: Close
[0m01:04:43.972162 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:04:43.972341 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:04:43.972498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:43.980188 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m01:04:43.980913 [debug] [ThreadPool]: On list_postgres: Close
[0m01:04:43.982433 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:04:43.982643 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:04:43.982795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:43.990308 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m01:04:43.991190 [debug] [ThreadPool]: On list_postgres: Close
[0m01:04:43.991595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres__pipedrive_analytics)
[0m01:04:43.991872 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "_pipedrive_analytics"
"
[0m01:04:43.995286 [debug] [ThreadPool]: Using postgres connection "create_postgres__pipedrive_analytics"
[0m01:04:43.995486 [debug] [ThreadPool]: On create_postgres__pipedrive_analytics: BEGIN
[0m01:04:43.995636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:44.003588 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:04:44.003830 [debug] [ThreadPool]: Using postgres connection "create_postgres__pipedrive_analytics"
[0m01:04:44.004011 [debug] [ThreadPool]: On create_postgres__pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres__pipedrive_analytics"} */
create schema if not exists "_pipedrive_analytics"
[0m01:04:44.004616 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:04:44.005118 [debug] [ThreadPool]: On create_postgres__pipedrive_analytics: COMMIT
[0m01:04:44.005286 [debug] [ThreadPool]: Using postgres connection "create_postgres__pipedrive_analytics"
[0m01:04:44.005435 [debug] [ThreadPool]: On create_postgres__pipedrive_analytics: COMMIT
[0m01:04:44.006234 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:04:44.006537 [debug] [ThreadPool]: On create_postgres__pipedrive_analytics: Close
[0m01:04:44.006892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres__pipedrive_analytics, now create_postgres__ods)
[0m01:04:44.007139 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "_ods"
"
[0m01:04:44.008534 [debug] [ThreadPool]: Using postgres connection "create_postgres__ods"
[0m01:04:44.008765 [debug] [ThreadPool]: On create_postgres__ods: BEGIN
[0m01:04:44.008984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:44.015298 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m01:04:44.015522 [debug] [ThreadPool]: Using postgres connection "create_postgres__ods"
[0m01:04:44.015686 [debug] [ThreadPool]: On create_postgres__ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres__ods"} */
create schema if not exists "_ods"
[0m01:04:44.016253 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:04:44.016852 [debug] [ThreadPool]: On create_postgres__ods: COMMIT
[0m01:04:44.017046 [debug] [ThreadPool]: Using postgres connection "create_postgres__ods"
[0m01:04:44.017291 [debug] [ThreadPool]: On create_postgres__ods: COMMIT
[0m01:04:44.018091 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:04:44.018294 [debug] [ThreadPool]: On create_postgres__ods: Close
[0m01:04:44.018658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres__ods, now create_postgres__staging)
[0m01:04:44.018926 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "_staging"
"
[0m01:04:44.020530 [debug] [ThreadPool]: Using postgres connection "create_postgres__staging"
[0m01:04:44.020735 [debug] [ThreadPool]: On create_postgres__staging: BEGIN
[0m01:04:44.020906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:44.027551 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:04:44.027781 [debug] [ThreadPool]: Using postgres connection "create_postgres__staging"
[0m01:04:44.027952 [debug] [ThreadPool]: On create_postgres__staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres__staging"} */
create schema if not exists "_staging"
[0m01:04:44.028506 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:04:44.029046 [debug] [ThreadPool]: On create_postgres__staging: COMMIT
[0m01:04:44.029231 [debug] [ThreadPool]: Using postgres connection "create_postgres__staging"
[0m01:04:44.029383 [debug] [ThreadPool]: On create_postgres__staging: COMMIT
[0m01:04:44.030918 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:04:44.031073 [debug] [ThreadPool]: On create_postgres__staging: Close
[0m01:04:44.031777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres__staging, now list_postgres__pipedrive_analytics)
[0m01:04:44.035475 [debug] [ThreadPool]: Using postgres connection "list_postgres__pipedrive_analytics"
[0m01:04:44.035676 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: BEGIN
[0m01:04:44.035825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:44.043021 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:04:44.043244 [debug] [ThreadPool]: Using postgres connection "list_postgres__pipedrive_analytics"
[0m01:04:44.043434 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_pipedrive_analytics'
  
[0m01:04:44.045245 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:04:44.045934 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: ROLLBACK
[0m01:04:44.046352 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: Close
[0m01:04:44.046682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres__pipedrive_analytics, now list_postgres__ods)
[0m01:04:44.049198 [debug] [ThreadPool]: Using postgres connection "list_postgres__ods"
[0m01:04:44.049390 [debug] [ThreadPool]: On list_postgres__ods: BEGIN
[0m01:04:44.049541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:44.057943 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:04:44.058260 [debug] [ThreadPool]: Using postgres connection "list_postgres__ods"
[0m01:04:44.058448 [debug] [ThreadPool]: On list_postgres__ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_ods'
  
[0m01:04:44.060994 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:04:44.061861 [debug] [ThreadPool]: On list_postgres__ods: ROLLBACK
[0m01:04:44.062417 [debug] [ThreadPool]: On list_postgres__ods: Close
[0m01:04:44.062823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres__ods, now list_postgres__staging)
[0m01:04:44.064857 [debug] [ThreadPool]: Using postgres connection "list_postgres__staging"
[0m01:04:44.065119 [debug] [ThreadPool]: On list_postgres__staging: BEGIN
[0m01:04:44.065287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:44.075245 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:04:44.075482 [debug] [ThreadPool]: Using postgres connection "list_postgres__staging"
[0m01:04:44.075671 [debug] [ThreadPool]: On list_postgres__staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m01:04:44.077517 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:04:44.078257 [debug] [ThreadPool]: On list_postgres__staging: ROLLBACK
[0m01:04:44.078681 [debug] [ThreadPool]: On list_postgres__staging: Close
[0m01:04:44.081751 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.081989 [debug] [MainThread]: On master: BEGIN
[0m01:04:44.082154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:44.089804 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:04:44.090038 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.090263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:04:44.092284 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:04:44.092963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148f8490>]}
[0m01:04:44.093251 [debug] [MainThread]: On master: ROLLBACK
[0m01:04:44.093684 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.093874 [debug] [MainThread]: On master: BEGIN
[0m01:04:44.094472 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:04:44.094646 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.094805 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.094978 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.095425 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:44.095604 [debug] [MainThread]: On master: Close
[0m01:04:44.097376 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m01:04:44.097762 [info ] [Thread-1  ]: 1 of 3 START sql table model _staging.activity_types ........................... [RUN]
[0m01:04:44.098046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres__staging, now model.enpal_assessment_project.activity_types)
[0m01:04:44.098249 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m01:04:44.103688 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m01:04:44.104146 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m01:04:44.128200 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m01:04:44.128785 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:04:44.128989 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m01:04:44.129170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:44.141157 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m01:04:44.141425 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:04:44.141633 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."_staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m01:04:44.144383 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:04:44.151444 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:04:44.151675 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."_staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m01:04:44.152946 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:04:44.161201 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:04:44.161415 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:04:44.161599 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:04:44.164399 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m01:04:44.168000 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_staging"."activity_types__dbt_backup"
[0m01:04:44.170472 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:04:44.170681 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."_staging"."activity_types__dbt_backup" cascade
[0m01:04:44.171901 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:04:44.173349 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m01:04:44.174570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11439f640>]}
[0m01:04:44.174936 [info ] [Thread-1  ]: 1 of 3 OK created sql table model _staging.activity_types ...................... [[32mSELECT 4579[0m in 0.08s]
[0m01:04:44.175255 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m01:04:44.175468 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m01:04:44.175707 [info ] [Thread-1  ]: 2 of 3 START sql table model _ods.ods_deal ..................................... [RUN]
[0m01:04:44.175939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.ods_deal)
[0m01:04:44.176125 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m01:04:44.177931 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m01:04:44.178343 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m01:04:44.180473 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m01:04:44.180795 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:04:44.181014 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m01:04:44.181198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:44.192514 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m01:04:44.192831 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:04:44.193041 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."_ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."deal_changes"
  );
  
[0m01:04:44.198378 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.005 seconds
[0m01:04:44.200686 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:04:44.200942 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."_ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m01:04:44.201533 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:04:44.202336 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:04:44.202539 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:04:44.202724 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:04:44.204260 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:04:44.205922 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_ods"."ods_deal__dbt_backup"
[0m01:04:44.206338 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:04:44.206538 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."_ods"."ods_deal__dbt_backup" cascade
[0m01:04:44.207008 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m01:04:44.207773 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m01:04:44.208147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dcba30>]}
[0m01:04:44.208544 [info ] [Thread-1  ]: 2 of 3 OK created sql table model _ods.ods_deal ................................ [[32mSELECT 15406[0m in 0.03s]
[0m01:04:44.208863 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m01:04:44.209088 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m01:04:44.209405 [info ] [Thread-1  ]: 3 of 3 START sql table model _pipedrive_analytics.test_model ................... [RUN]
[0m01:04:44.209673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal, now model.enpal_assessment_project.test_model)
[0m01:04:44.209873 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m01:04:44.212600 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m01:04:44.213096 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m01:04:44.215343 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m01:04:44.215968 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:04:44.216223 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m01:04:44.216408 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:04:44.229085 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m01:04:44.229412 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:04:44.229655 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m01:04:44.232226 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.002 seconds
[0m01:04:44.234633 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:04:44.234865 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m01:04:44.236133 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:04:44.236973 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:04:44.237185 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:04:44.237372 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:04:44.240260 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m01:04:44.241800 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_pipedrive_analytics"."test_model__dbt_backup"
[0m01:04:44.242255 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:04:44.242450 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m01:04:44.242975 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m01:04:44.243725 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m01:04:44.244084 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a622f55-713b-4923-bf79-22a7c36c4f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dfe5b0>]}
[0m01:04:44.244494 [info ] [Thread-1  ]: 3 of 3 OK created sql table model _pipedrive_analytics.test_model .............. [[32mSELECT 4579[0m in 0.03s]
[0m01:04:44.244824 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m01:04:44.245525 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.245703 [debug] [MainThread]: On master: BEGIN
[0m01:04:44.245856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:44.256141 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:04:44.256394 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.256608 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.256791 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.257207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:44.257382 [debug] [MainThread]: On master: Close
[0m01:04:44.257625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:44.257776 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m01:04:44.257981 [info ] [MainThread]: 
[0m01:04:44.258167 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m01:04:44.258714 [debug] [MainThread]: Command end result
[0m01:04:44.273853 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:04:44.274976 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:04:44.278832 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m01:04:44.279020 [info ] [MainThread]: 
[0m01:04:44.279235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:04:44.279404 [info ] [MainThread]: 
[0m01:04:44.279588 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:04:44.280633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.402415, "process_in_blocks": "0", "process_kernel_time": 0.148579, "process_mem_max_rss": "133677056", "process_out_blocks": "0", "process_user_time": 1.892144}
[0m01:04:44.280846 [debug] [MainThread]: Command `dbt run` succeeded at 01:04:44.280801 after 1.40 seconds
[0m01:04:44.281048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149a74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149725b0>]}
[0m01:04:44.281247 [debug] [MainThread]: Flushing usage events
[0m01:04:44.819437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:05:28.753163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103997820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e45d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e45b50>]}


============================== 01:05:28.755644 | ee312bab-cd7f-4ca5-9de7-e002812a1b5a ==============================
[0m01:05:28.755644 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:05:28.755959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'empty': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'target_path': 'None'}
[0m01:05:28.784126 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "enpal_assessment_project", target "dev" invalid: None is not of type 'string'
[0m01:05:28.785199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.07372283, "process_in_blocks": "0", "process_kernel_time": 0.083824, "process_mem_max_rss": "98975744", "process_out_blocks": "0", "process_user_time": 0.766911}
[0m01:05:28.785454 [debug] [MainThread]: Command `dbt run` failed at 01:05:28.785392 after 0.07 seconds
[0m01:05:28.785654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103997820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dfd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df3e50>]}
[0m01:05:28.785866 [debug] [MainThread]: Flushing usage events
[0m01:05:29.296794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:09:27.696417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103975790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e5a60>]}


============================== 01:09:27.699464 | 43c8e667-bfa3-4995-a92f-237236805472 ==============================
[0m01:09:27.699464 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:09:27.699803 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'invocation_command': 'dbt run', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'debug': 'False'}
[0m01:09:27.810517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43c8e667-bfa3-4995-a92f-237236805472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ede760>]}
[0m01:09:27.845721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43c8e667-bfa3-4995-a92f-237236805472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c02b0>]}
[0m01:09:27.846705 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:09:27.918131 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:09:27.975621 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:09:27.975941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43c8e667-bfa3-4995-a92f-237236805472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042865e0>]}
[0m01:09:28.625404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43c8e667-bfa3-4995-a92f-237236805472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c99130>]}
[0m01:09:28.700038 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:09:28.701412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:09:28.711851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43c8e667-bfa3-4995-a92f-237236805472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7cd90>]}
[0m01:09:28.712184 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:09:28.712385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43c8e667-bfa3-4995-a92f-237236805472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7c7c0>]}
[0m01:09:28.713214 [info ] [MainThread]: 
[0m01:09:28.713406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:09:28.713564 [info ] [MainThread]: 
[0m01:09:28.713837 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:09:28.716382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:09:28.747555 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:09:28.747850 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:09:28.748014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:28.780410 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.032 seconds
[0m01:09:28.781241 [debug] [ThreadPool]: On list_postgres: Close
[0m01:09:28.783162 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:09:28.783370 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:09:28.783548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:28.792725 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:09:28.793458 [debug] [ThreadPool]: On list_postgres: Close
[0m01:09:28.794970 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:09:28.795192 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:09:28.795391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:28.803931 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:09:28.804737 [debug] [ThreadPool]: On list_postgres: Close
[0m01:09:28.805121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m01:09:28.805395 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m01:09:28.808771 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m01:09:28.808956 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m01:09:28.809106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:28.818580 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:09:28.818795 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m01:09:28.818965 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m01:09:28.819703 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m01:09:28.819974 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m01:09:28.820473 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m01:09:28.820687 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:09:28.820870 [debug] [ThreadPool]: On create_postgres_: Close
[0m01:09:28.821282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:28.821450 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m01:09:28.821616 [info ] [MainThread]: 
[0m01:09:28.821804 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m01:09:28.822096 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m01:09:28.823226 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1686956, "process_in_blocks": "0", "process_kernel_time": 0.161878, "process_mem_max_rss": "130678784", "process_out_blocks": "0", "process_user_time": 1.736869}
[0m01:09:28.823464 [debug] [MainThread]: Command `dbt run` failed at 01:09:28.823412 after 1.17 seconds
[0m01:09:28.823668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103975790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c70c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d35490>]}
[0m01:09:28.823885 [debug] [MainThread]: Flushing usage events
[0m01:09:29.372796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:53.191310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054697c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d9970>]}


============================== 01:10:53.194324 | 102d87a9-f415-41ea-9782-1ef1b688a852 ==============================
[0m01:10:53.194324 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:10:53.194644 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None'}
[0m01:10:53.308550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '102d87a9-f415-41ea-9782-1ef1b688a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c8df0>]}
[0m01:10:53.343868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '102d87a9-f415-41ea-9782-1ef1b688a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a3e80>]}
[0m01:10:53.344455 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:10:53.416446 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:10:53.473588 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:10:53.473912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '102d87a9-f415-41ea-9782-1ef1b688a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7a5e0>]}
[0m01:10:54.121822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.enpal_assessment_project.sources
[0m01:10:54.128467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '102d87a9-f415-41ea-9782-1ef1b688a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107781130>]}
[0m01:10:54.209348 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:10:54.210704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:10:54.221789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '102d87a9-f415-41ea-9782-1ef1b688a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e5d90>]}
[0m01:10:54.222130 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:10:54.222342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102d87a9-f415-41ea-9782-1ef1b688a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107797760>]}
[0m01:10:54.223231 [info ] [MainThread]: 
[0m01:10:54.223452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:10:54.223613 [info ] [MainThread]: 
[0m01:10:54.223908 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:10:54.226653 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:10:54.257554 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:10:54.257827 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:10:54.257996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:54.289716 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.032 seconds
[0m01:10:54.290550 [debug] [ThreadPool]: On list_postgres: Close
[0m01:10:54.292290 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:10:54.292473 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:10:54.292654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:54.301520 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:10:54.302218 [debug] [ThreadPool]: On list_postgres: Close
[0m01:10:54.303721 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:10:54.303937 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:10:54.304103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:54.313839 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m01:10:54.314610 [debug] [ThreadPool]: On list_postgres: Close
[0m01:10:54.314975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m01:10:54.315234 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m01:10:54.318551 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m01:10:54.318753 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m01:10:54.318905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:54.327006 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:10:54.327261 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m01:10:54.327436 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m01:10:54.327988 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m01:10:54.328263 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m01:10:54.328753 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m01:10:54.328974 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:10:54.329148 [debug] [ThreadPool]: On create_postgres_: Close
[0m01:10:54.329590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:54.329786 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m01:10:54.329973 [info ] [MainThread]: 
[0m01:10:54.330163 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m01:10:54.330460 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m01:10:54.331846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1839297, "process_in_blocks": "0", "process_kernel_time": 0.164436, "process_mem_max_rss": "129466368", "process_out_blocks": "0", "process_user_time": 1.742665}
[0m01:10:54.332113 [debug] [MainThread]: Command `dbt run` failed at 01:10:54.332060 after 1.18 seconds
[0m01:10:54.332331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054697c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107797b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107825400>]}
[0m01:10:54.332569 [debug] [MainThread]: Flushing usage events
[0m01:10:54.872110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:12:53.623304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f45d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f45b50>]}


============================== 01:12:53.625730 | 9e3d5a83-73ec-4052-8b95-f59e98b5212f ==============================
[0m01:12:53.625730 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:12:53.626088 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'empty': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80'}
[0m01:12:53.730976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472faf0>]}
[0m01:12:53.767371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204636d0>]}
[0m01:12:53.768001 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:12:53.836982 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:12:53.895079 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:12:53.895397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780c370>]}
[0m01:12:54.543876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e53130>]}
[0m01:12:54.619377 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:12:54.620444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:12:54.627639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e36820>]}
[0m01:12:54.627947 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:12:54.628148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e587f0>]}
[0m01:12:54.628944 [info ] [MainThread]: 
[0m01:12:54.629136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:12:54.629295 [info ] [MainThread]: 
[0m01:12:54.629577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:12:54.632264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:12:54.660579 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:12:54.660854 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:12:54.661012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:54.683911 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.023 seconds
[0m01:12:54.684785 [debug] [ThreadPool]: On list_postgres: Close
[0m01:12:54.686606 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:12:54.686795 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:12:54.686956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:54.694987 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m01:12:54.695756 [debug] [ThreadPool]: On list_postgres: Close
[0m01:12:54.697329 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:12:54.697579 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:12:54.697766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:54.707173 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:12:54.707997 [debug] [ThreadPool]: On list_postgres: Close
[0m01:12:54.708714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres__staging)
[0m01:12:54.712483 [debug] [ThreadPool]: Using postgres connection "list_postgres__staging"
[0m01:12:54.712686 [debug] [ThreadPool]: On list_postgres__staging: BEGIN
[0m01:12:54.712844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:54.722080 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:12:54.722310 [debug] [ThreadPool]: Using postgres connection "list_postgres__staging"
[0m01:12:54.722504 [debug] [ThreadPool]: On list_postgres__staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m01:12:54.724320 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:12:54.725107 [debug] [ThreadPool]: On list_postgres__staging: ROLLBACK
[0m01:12:54.725535 [debug] [ThreadPool]: On list_postgres__staging: Close
[0m01:12:54.725889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres__staging, now list_postgres__pipedrive_analytics)
[0m01:12:54.727511 [debug] [ThreadPool]: Using postgres connection "list_postgres__pipedrive_analytics"
[0m01:12:54.727715 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: BEGIN
[0m01:12:54.727872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:54.734681 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:12:54.734916 [debug] [ThreadPool]: Using postgres connection "list_postgres__pipedrive_analytics"
[0m01:12:54.735109 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_pipedrive_analytics'
  
[0m01:12:54.737005 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:12:54.737917 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: ROLLBACK
[0m01:12:54.738637 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: Close
[0m01:12:54.738975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres__pipedrive_analytics, now list_postgres__ods)
[0m01:12:54.740529 [debug] [ThreadPool]: Using postgres connection "list_postgres__ods"
[0m01:12:54.740716 [debug] [ThreadPool]: On list_postgres__ods: BEGIN
[0m01:12:54.740869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:54.747976 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:12:54.748195 [debug] [ThreadPool]: Using postgres connection "list_postgres__ods"
[0m01:12:54.748376 [debug] [ThreadPool]: On list_postgres__ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_ods'
  
[0m01:12:54.750160 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:12:54.750892 [debug] [ThreadPool]: On list_postgres__ods: ROLLBACK
[0m01:12:54.751344 [debug] [ThreadPool]: On list_postgres__ods: Close
[0m01:12:54.754475 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:54.754708 [debug] [MainThread]: On master: BEGIN
[0m01:12:54.754865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:12:54.763123 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:12:54.763366 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:54.763589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:12:54.768953 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:12:54.769750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e396d0>]}
[0m01:12:54.770034 [debug] [MainThread]: On master: ROLLBACK
[0m01:12:54.770588 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:54.770769 [debug] [MainThread]: On master: BEGIN
[0m01:12:54.771363 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:12:54.771533 [debug] [MainThread]: On master: COMMIT
[0m01:12:54.771694 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:54.771843 [debug] [MainThread]: On master: COMMIT
[0m01:12:54.772247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:12:54.772430 [debug] [MainThread]: On master: Close
[0m01:12:54.774090 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m01:12:54.774453 [info ] [Thread-1  ]: 1 of 3 START sql table model _staging.activity_types ........................... [RUN]
[0m01:12:54.774746 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres__ods, now model.enpal_assessment_project.activity_types)
[0m01:12:54.774949 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m01:12:54.781539 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m01:12:54.782371 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m01:12:54.806601 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m01:12:54.807318 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:12:54.807528 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m01:12:54.807716 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:12:54.819979 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m01:12:54.820231 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:12:54.820564 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."_staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m01:12:54.823389 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:12:54.829903 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:12:54.830151 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."_staging"."activity_types" rename to "activity_types__dbt_backup"
[0m01:12:54.831502 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:12:54.833347 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:12:54.833552 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."_staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m01:12:54.834675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:12:54.844108 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:12:54.844323 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:12:54.844507 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:12:54.853414 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m01:12:54.858415 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_staging"."activity_types__dbt_backup"
[0m01:12:54.860996 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:12:54.861209 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."_staging"."activity_types__dbt_backup" cascade
[0m01:12:54.865749 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m01:12:54.867243 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m01:12:54.868750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104939340>]}
[0m01:12:54.869154 [info ] [Thread-1  ]: 1 of 3 OK created sql table model _staging.activity_types ...................... [[32mSELECT 4579[0m in 0.09s]
[0m01:12:54.869489 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m01:12:54.869713 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m01:12:54.870017 [info ] [Thread-1  ]: 2 of 3 START sql table model _ods.ods_deal ..................................... [RUN]
[0m01:12:54.870258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.ods_deal)
[0m01:12:54.870455 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m01:12:54.872414 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m01:12:54.872814 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m01:12:54.875092 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m01:12:54.875507 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:12:54.875757 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m01:12:54.875951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:12:54.888447 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m01:12:54.888718 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:12:54.888920 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."_ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."deal_changes"
  );
  
[0m01:12:54.894183 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.005 seconds
[0m01:12:54.896528 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:12:54.896755 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."_ods"."ods_deal" rename to "ods_deal__dbt_backup"
[0m01:12:54.897413 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:12:54.899377 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:12:54.899583 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."_ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m01:12:54.900125 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:12:54.900994 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:12:54.901193 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:12:54.901376 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:12:54.903795 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:12:54.905440 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_ods"."ods_deal__dbt_backup"
[0m01:12:54.905854 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:12:54.906048 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."_ods"."ods_deal__dbt_backup" cascade
[0m01:12:54.907327 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:12:54.908086 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m01:12:54.908442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120eca970>]}
[0m01:12:54.908821 [info ] [Thread-1  ]: 2 of 3 OK created sql table model _ods.ods_deal ................................ [[32mSELECT 15406[0m in 0.04s]
[0m01:12:54.909145 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m01:12:54.909363 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m01:12:54.909780 [info ] [Thread-1  ]: 3 of 3 START sql table model _pipedrive_analytics.test_model ................... [RUN]
[0m01:12:54.910137 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal, now model.enpal_assessment_project.test_model)
[0m01:12:54.910354 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m01:12:54.912233 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m01:12:54.912707 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m01:12:54.915899 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m01:12:54.916268 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:12:54.916464 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m01:12:54.916640 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:12:54.925263 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m01:12:54.925547 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:12:54.925760 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m01:12:54.928270 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.002 seconds
[0m01:12:54.930608 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:12:54.930822 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m01:12:54.931431 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:12:54.933471 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:12:54.933685 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m01:12:54.934226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:12:54.935123 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:12:54.935328 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:12:54.935513 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:12:54.937204 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:12:54.938961 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_pipedrive_analytics"."test_model__dbt_backup"
[0m01:12:54.939393 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:12:54.939587 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m01:12:54.942759 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m01:12:54.943537 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m01:12:54.943906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3d5a83-73ec-4052-8b95-f59e98b5212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120eca970>]}
[0m01:12:54.944292 [info ] [Thread-1  ]: 3 of 3 OK created sql table model _pipedrive_analytics.test_model .............. [[32mSELECT 4579[0m in 0.03s]
[0m01:12:54.944612 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m01:12:54.945357 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:54.945544 [debug] [MainThread]: On master: BEGIN
[0m01:12:54.945699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:12:54.954881 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:12:54.955115 [debug] [MainThread]: On master: COMMIT
[0m01:12:54.955279 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:54.955427 [debug] [MainThread]: On master: COMMIT
[0m01:12:54.955853 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:12:54.956145 [debug] [MainThread]: On master: Close
[0m01:12:54.956407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:54.956577 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m01:12:54.956796 [info ] [MainThread]: 
[0m01:12:54.957000 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m01:12:54.957558 [debug] [MainThread]: Command end result
[0m01:12:54.972865 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:12:54.974094 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:12:54.978034 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m01:12:54.978215 [info ] [MainThread]: 
[0m01:12:54.978429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:12:54.978600 [info ] [MainThread]: 
[0m01:12:54.978785 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:12:54.979851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4003471, "process_in_blocks": "0", "process_kernel_time": 0.152463, "process_mem_max_rss": "132579328", "process_out_blocks": "0", "process_user_time": 1.901449}
[0m01:12:54.980074 [debug] [MainThread]: Command `dbt run` succeeded at 01:12:54.980029 after 1.40 seconds
[0m01:12:54.980281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10553e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121df3490>]}
[0m01:12:54.980481 [debug] [MainThread]: Flushing usage events
[0m01:12:55.511879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:13:35.716779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058257c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106895b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106895970>]}


============================== 01:13:35.720056 | 26b14b6e-1337-4236-82bc-d6d8b75ffe7f ==============================
[0m01:13:35.720056 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:13:35.720390 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'no_print': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'printer_width': '80'}
[0m01:13:35.834185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26b14b6e-1337-4236-82bc-d6d8b75ffe7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6fa30>]}
[0m01:13:35.871423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26b14b6e-1337-4236-82bc-d6d8b75ffe7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d66520>]}
[0m01:13:35.872190 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:13:35.944080 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:13:36.005296 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:13:36.005710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26b14b6e-1337-4236-82bc-d6d8b75ffe7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061365e0>]}
[0m01:13:36.652058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26b14b6e-1337-4236-82bc-d6d8b75ffe7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b49130>]}
[0m01:13:36.729011 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:13:36.730569 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:13:36.741759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26b14b6e-1337-4236-82bc-d6d8b75ffe7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b737f0>]}
[0m01:13:36.742082 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:13:36.742276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26b14b6e-1337-4236-82bc-d6d8b75ffe7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10431ceb0>]}
[0m01:13:36.743107 [info ] [MainThread]: 
[0m01:13:36.743306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:13:36.743468 [info ] [MainThread]: 
[0m01:13:36.743748 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:13:36.746292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:13:36.777383 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:13:36.777669 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:13:36.777833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:13:36.814335 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.036 seconds
[0m01:13:36.815195 [debug] [ThreadPool]: On list_postgres: Close
[0m01:13:36.817079 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:13:36.817308 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:13:36.817466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:36.826410 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:13:36.827143 [debug] [ThreadPool]: On list_postgres: Close
[0m01:13:36.828682 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:13:36.828916 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:13:36.829077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:36.838097 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:13:36.839049 [debug] [ThreadPool]: On list_postgres: Close
[0m01:13:36.839483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m01:13:36.839793 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m01:13:36.843323 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m01:13:36.843533 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m01:13:36.843701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:36.853449 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:13:36.853697 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m01:13:36.853866 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m01:13:36.854383 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m01:13:36.854592 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m01:13:36.855087 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m01:13:36.855337 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:13:36.855511 [debug] [ThreadPool]: On create_postgres_: Close
[0m01:13:36.855973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:13:36.856170 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m01:13:36.856345 [info ] [MainThread]: 
[0m01:13:36.856546 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m01:13:36.856839 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m01:13:36.857922 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1861085, "process_in_blocks": "0", "process_kernel_time": 0.156365, "process_mem_max_rss": "131956736", "process_out_blocks": "0", "process_user_time": 1.739646}
[0m01:13:36.858158 [debug] [MainThread]: Command `dbt run` failed at 01:13:36.858103 after 1.19 seconds
[0m01:13:36.858372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058257c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b29940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd6100>]}
[0m01:13:36.858596 [debug] [MainThread]: Flushing usage events
[0m01:13:37.318835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:15:06.024384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106805c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106805a90>]}


============================== 01:15:06.026844 | e01be06e-4b36-4cf2-8c24-3c98770b0ac5 ==============================
[0m01:15:06.026844 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:15:06.027181 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'use_colors': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'printer_width': '80', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'empty': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m01:15:06.126606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106805100>]}
[0m01:15:06.162353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f88af0>]}
[0m01:15:06.162894 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:15:06.231746 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:15:06.289385 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:15:06.289664 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:15:06.289874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcb370>]}
[0m01:15:06.937191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108997130>]}
[0m01:15:07.011743 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:15:07.012809 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:15:07.019381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c15130>]}
[0m01:15:07.019669 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:15:07.019856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107876e20>]}
[0m01:15:07.020622 [info ] [MainThread]: 
[0m01:15:07.020815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:15:07.020969 [info ] [MainThread]: 
[0m01:15:07.021227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:15:07.023863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:15:07.052477 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:15:07.052771 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:15:07.052938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:07.073143 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m01:15:07.073953 [debug] [ThreadPool]: On list_postgres: Close
[0m01:15:07.075734 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:15:07.075912 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:15:07.076067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:07.083342 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m01:15:07.084070 [debug] [ThreadPool]: On list_postgres: Close
[0m01:15:07.085609 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:15:07.085815 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:15:07.085971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:07.093129 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m01:15:07.093963 [debug] [ThreadPool]: On list_postgres: Close
[0m01:15:07.094479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_analytics_ods)
[0m01:15:07.094826 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "analytics_ods"
"
[0m01:15:07.098166 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_ods"
[0m01:15:07.098355 [debug] [ThreadPool]: On create_postgres_analytics_ods: BEGIN
[0m01:15:07.098505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:07.107411 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:15:07.107573 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_ods"
[0m01:15:07.107723 [debug] [ThreadPool]: On create_postgres_analytics_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_analytics_ods"} */
create schema if not exists "analytics_ods"
[0m01:15:07.108350 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:15:07.109010 [debug] [ThreadPool]: On create_postgres_analytics_ods: COMMIT
[0m01:15:07.109206 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_ods"
[0m01:15:07.109373 [debug] [ThreadPool]: On create_postgres_analytics_ods: COMMIT
[0m01:15:07.110510 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:15:07.110722 [debug] [ThreadPool]: On create_postgres_analytics_ods: Close
[0m01:15:07.111098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_analytics_ods, now create_postgres_analytics_staging)
[0m01:15:07.111372 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "analytics_staging"
"
[0m01:15:07.112936 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_staging"
[0m01:15:07.113140 [debug] [ThreadPool]: On create_postgres_analytics_staging: BEGIN
[0m01:15:07.113304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:07.121857 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:15:07.122076 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_staging"
[0m01:15:07.122248 [debug] [ThreadPool]: On create_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_analytics_staging"} */
create schema if not exists "analytics_staging"
[0m01:15:07.122768 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:15:07.123280 [debug] [ThreadPool]: On create_postgres_analytics_staging: COMMIT
[0m01:15:07.123450 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_staging"
[0m01:15:07.123599 [debug] [ThreadPool]: On create_postgres_analytics_staging: COMMIT
[0m01:15:07.124266 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:15:07.124430 [debug] [ThreadPool]: On create_postgres_analytics_staging: Close
[0m01:15:07.124776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_analytics_staging, now create_postgres_analytics_pipedrive_analytics)
[0m01:15:07.125020 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "analytics_pipedrive_analytics"
"
[0m01:15:07.126481 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_pipedrive_analytics"
[0m01:15:07.126667 [debug] [ThreadPool]: On create_postgres_analytics_pipedrive_analytics: BEGIN
[0m01:15:07.126816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:07.134941 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:15:07.135150 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_pipedrive_analytics"
[0m01:15:07.135318 [debug] [ThreadPool]: On create_postgres_analytics_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_analytics_pipedrive_analytics"} */
create schema if not exists "analytics_pipedrive_analytics"
[0m01:15:07.135815 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:15:07.136339 [debug] [ThreadPool]: On create_postgres_analytics_pipedrive_analytics: COMMIT
[0m01:15:07.136518 [debug] [ThreadPool]: Using postgres connection "create_postgres_analytics_pipedrive_analytics"
[0m01:15:07.136679 [debug] [ThreadPool]: On create_postgres_analytics_pipedrive_analytics: COMMIT
[0m01:15:07.137313 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m01:15:07.137487 [debug] [ThreadPool]: On create_postgres_analytics_pipedrive_analytics: Close
[0m01:15:07.138237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_analytics_pipedrive_analytics, now list_postgres_analytics_ods)
[0m01:15:07.142096 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_ods"
[0m01:15:07.142289 [debug] [ThreadPool]: On list_postgres_analytics_ods: BEGIN
[0m01:15:07.142439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:07.152210 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:15:07.152409 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_ods"
[0m01:15:07.152620 [debug] [ThreadPool]: On list_postgres_analytics_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_analytics_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_ods'
  
[0m01:15:07.154523 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:15:07.155223 [debug] [ThreadPool]: On list_postgres_analytics_ods: ROLLBACK
[0m01:15:07.155622 [debug] [ThreadPool]: On list_postgres_analytics_ods: Close
[0m01:15:07.155929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_analytics_ods, now list_postgres_analytics_staging)
[0m01:15:07.158636 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m01:15:07.158901 [debug] [ThreadPool]: On list_postgres_analytics_staging: BEGIN
[0m01:15:07.159154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:07.166817 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:15:07.167095 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_staging"
[0m01:15:07.167289 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m01:15:07.169184 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:15:07.169950 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m01:15:07.170385 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m01:15:07.170770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now list_postgres_analytics_pipedrive_analytics)
[0m01:15:07.172381 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_pipedrive_analytics"
[0m01:15:07.172604 [debug] [ThreadPool]: On list_postgres_analytics_pipedrive_analytics: BEGIN
[0m01:15:07.172767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:07.182096 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:15:07.182312 [debug] [ThreadPool]: Using postgres connection "list_postgres_analytics_pipedrive_analytics"
[0m01:15:07.182502 [debug] [ThreadPool]: On list_postgres_analytics_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_analytics_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_pipedrive_analytics'
  
[0m01:15:07.184227 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:15:07.184956 [debug] [ThreadPool]: On list_postgres_analytics_pipedrive_analytics: ROLLBACK
[0m01:15:07.185391 [debug] [ThreadPool]: On list_postgres_analytics_pipedrive_analytics: Close
[0m01:15:07.188443 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:07.188686 [debug] [MainThread]: On master: BEGIN
[0m01:15:07.188845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:15:07.198126 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:15:07.198337 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:07.198567 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:15:07.200747 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:15:07.201539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d20d0>]}
[0m01:15:07.201853 [debug] [MainThread]: On master: ROLLBACK
[0m01:15:07.202461 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:07.202671 [debug] [MainThread]: On master: BEGIN
[0m01:15:07.203405 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:15:07.203633 [debug] [MainThread]: On master: COMMIT
[0m01:15:07.203824 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:07.203990 [debug] [MainThread]: On master: COMMIT
[0m01:15:07.204487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:15:07.204740 [debug] [MainThread]: On master: Close
[0m01:15:07.206994 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m01:15:07.207335 [info ] [Thread-1  ]: 1 of 3 START sql table model analytics_staging.activity_types .................. [RUN]
[0m01:15:07.207600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_analytics_pipedrive_analytics, now model.enpal_assessment_project.activity_types)
[0m01:15:07.207802 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m01:15:07.213165 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m01:15:07.213609 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m01:15:07.237090 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m01:15:07.237727 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:15:07.237934 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m01:15:07.238146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:15:07.250221 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m01:15:07.250460 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:15:07.250667 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."analytics_staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m01:15:07.253368 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.002 seconds
[0m01:15:07.260435 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:15:07.260678 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."analytics_staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m01:15:07.261323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:15:07.269810 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:15:07.270029 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:15:07.270218 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:15:07.273326 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m01:15:07.276925 [debug] [Thread-1  ]: Applying DROP to: "postgres"."analytics_staging"."activity_types__dbt_backup"
[0m01:15:07.279385 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:15:07.279593 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."analytics_staging"."activity_types__dbt_backup" cascade
[0m01:15:07.285208 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m01:15:07.286748 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m01:15:07.288000 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa6370>]}
[0m01:15:07.288395 [info ] [Thread-1  ]: 1 of 3 OK created sql table model analytics_staging.activity_types ............. [[32mSELECT 4579[0m in 0.08s]
[0m01:15:07.288728 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m01:15:07.288939 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m01:15:07.289181 [info ] [Thread-1  ]: 2 of 3 START sql table model analytics_ods.ods_deal ............................ [RUN]
[0m01:15:07.289420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.ods_deal)
[0m01:15:07.289610 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m01:15:07.291506 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m01:15:07.291931 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m01:15:07.294110 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m01:15:07.294479 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:15:07.294681 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m01:15:07.294881 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:15:07.305172 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m01:15:07.305575 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:15:07.305889 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."analytics_ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."deal_changes"
  );
  
[0m01:15:07.311168 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.005 seconds
[0m01:15:07.313587 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:15:07.313817 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."analytics_ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m01:15:07.314426 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:15:07.315268 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:15:07.315477 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:15:07.315665 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:15:07.317302 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:15:07.318938 [debug] [Thread-1  ]: Applying DROP to: "postgres"."analytics_ods"."ods_deal__dbt_backup"
[0m01:15:07.319357 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:15:07.319566 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."analytics_ods"."ods_deal__dbt_backup" cascade
[0m01:15:07.320062 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m01:15:07.320849 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m01:15:07.321280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a25e0>]}
[0m01:15:07.321784 [info ] [Thread-1  ]: 2 of 3 OK created sql table model analytics_ods.ods_deal ....................... [[32mSELECT 15406[0m in 0.03s]
[0m01:15:07.322162 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m01:15:07.322393 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m01:15:07.322760 [info ] [Thread-1  ]: 3 of 3 START sql table model analytics_pipedrive_analytics.test_model .......... [RUN]
[0m01:15:07.323105 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal, now model.enpal_assessment_project.test_model)
[0m01:15:07.323316 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m01:15:07.326234 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m01:15:07.326744 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m01:15:07.329043 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m01:15:07.329492 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:15:07.329689 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m01:15:07.329867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:15:07.336654 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m01:15:07.336909 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:15:07.337114 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."analytics_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m01:15:07.340172 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:15:07.342469 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:15:07.342686 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."analytics_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m01:15:07.343869 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:15:07.344641 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:15:07.344835 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:15:07.345011 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:15:07.347824 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m01:15:07.349282 [debug] [Thread-1  ]: Applying DROP to: "postgres"."analytics_pipedrive_analytics"."test_model__dbt_backup"
[0m01:15:07.349711 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:15:07.349902 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."analytics_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m01:15:07.350930 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:15:07.351604 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m01:15:07.351934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e01be06e-4b36-4cf2-8c24-3c98770b0ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7b940>]}
[0m01:15:07.352299 [info ] [Thread-1  ]: 3 of 3 OK created sql table model analytics_pipedrive_analytics.test_model ..... [[32mSELECT 4579[0m in 0.03s]
[0m01:15:07.352613 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m01:15:07.353199 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:07.353383 [debug] [MainThread]: On master: BEGIN
[0m01:15:07.353535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:15:07.361276 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:15:07.361515 [debug] [MainThread]: On master: COMMIT
[0m01:15:07.361671 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:07.361814 [debug] [MainThread]: On master: COMMIT
[0m01:15:07.362299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:15:07.362579 [debug] [MainThread]: On master: Close
[0m01:15:07.362846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:07.363003 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m01:15:07.363217 [info ] [MainThread]: 
[0m01:15:07.363405 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m01:15:07.363951 [debug] [MainThread]: Command end result
[0m01:15:07.379337 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:15:07.380434 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:15:07.384636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m01:15:07.384834 [info ] [MainThread]: 
[0m01:15:07.385051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:15:07.385219 [info ] [MainThread]: 
[0m01:15:07.385406 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:15:07.386387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4020871, "process_in_blocks": "0", "process_kernel_time": 0.149874, "process_mem_max_rss": "131547136", "process_out_blocks": "0", "process_user_time": 1.904607}
[0m01:15:07.386605 [debug] [MainThread]: Command `dbt run` succeeded at 01:15:07.386560 after 1.40 seconds
[0m01:15:07.386802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c15280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774bf10>]}
[0m01:15:07.387008 [debug] [MainThread]: Flushing usage events
[0m01:15:07.876703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:57.833552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108135d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108135b50>]}


============================== 01:17:57.836482 | 2415db1a-56de-4a0a-9a59-6b0ce3c69dbd ==============================
[0m01:17:57.836482 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:17:57.836801 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager'}
[0m01:17:57.942516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105837af0>]}
[0m01:17:57.978777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086126d0>]}
[0m01:17:57.980350 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:17:58.052191 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:17:58.109584 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:17:58.109906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fb370>]}
[0m01:17:58.755919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e7130>]}
[0m01:17:58.830677 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:17:58.831718 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:17:58.838417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c2820>]}
[0m01:17:58.838702 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:17:58.838896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e8820>]}
[0m01:17:58.839714 [info ] [MainThread]: 
[0m01:17:58.839942 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:58.840108 [info ] [MainThread]: 
[0m01:17:58.840377 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:17:58.842957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:17:58.871029 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:17:58.871337 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:17:58.871518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:58.892539 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.021 seconds
[0m01:17:58.893401 [debug] [ThreadPool]: On list_postgres: Close
[0m01:17:58.895156 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:17:58.895376 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:17:58.895574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:58.904266 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.009 seconds
[0m01:17:58.905053 [debug] [ThreadPool]: On list_postgres: Close
[0m01:17:58.906697 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:17:58.906944 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:17:58.907132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:58.915098 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m01:17:58.915911 [debug] [ThreadPool]: On list_postgres: Close
[0m01:17:58.916602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres__pipedrive_analytics)
[0m01:17:58.920350 [debug] [ThreadPool]: Using postgres connection "list_postgres__pipedrive_analytics"
[0m01:17:58.920548 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: BEGIN
[0m01:17:58.920709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:58.930924 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:17:58.931099 [debug] [ThreadPool]: Using postgres connection "list_postgres__pipedrive_analytics"
[0m01:17:58.931281 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_pipedrive_analytics'
  
[0m01:17:58.933310 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:17:58.934059 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: ROLLBACK
[0m01:17:58.934488 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: Close
[0m01:17:58.934818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres__pipedrive_analytics, now list_postgres__ods)
[0m01:17:58.936386 [debug] [ThreadPool]: Using postgres connection "list_postgres__ods"
[0m01:17:58.936575 [debug] [ThreadPool]: On list_postgres__ods: BEGIN
[0m01:17:58.936727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:58.943299 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:17:58.943536 [debug] [ThreadPool]: Using postgres connection "list_postgres__ods"
[0m01:17:58.943726 [debug] [ThreadPool]: On list_postgres__ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_ods'
  
[0m01:17:58.945497 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:17:58.946355 [debug] [ThreadPool]: On list_postgres__ods: ROLLBACK
[0m01:17:58.946750 [debug] [ThreadPool]: On list_postgres__ods: Close
[0m01:17:58.947088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres__ods, now list_postgres__staging)
[0m01:17:58.948659 [debug] [ThreadPool]: Using postgres connection "list_postgres__staging"
[0m01:17:58.948856 [debug] [ThreadPool]: On list_postgres__staging: BEGIN
[0m01:17:58.949014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:58.957483 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:17:58.957761 [debug] [ThreadPool]: Using postgres connection "list_postgres__staging"
[0m01:17:58.957962 [debug] [ThreadPool]: On list_postgres__staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m01:17:58.959839 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:17:58.960661 [debug] [ThreadPool]: On list_postgres__staging: ROLLBACK
[0m01:17:58.961147 [debug] [ThreadPool]: On list_postgres__staging: Close
[0m01:17:58.964371 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:58.964622 [debug] [MainThread]: On master: BEGIN
[0m01:17:58.964799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:17:58.972993 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:17:58.973248 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:58.973498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:17:58.975559 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:17:58.976289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d1820>]}
[0m01:17:58.976593 [debug] [MainThread]: On master: ROLLBACK
[0m01:17:58.977600 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:58.977825 [debug] [MainThread]: On master: BEGIN
[0m01:17:58.978911 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:17:58.979120 [debug] [MainThread]: On master: COMMIT
[0m01:17:58.979303 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:58.979469 [debug] [MainThread]: On master: COMMIT
[0m01:17:58.980376 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:17:58.980551 [debug] [MainThread]: On master: Close
[0m01:17:58.982994 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m01:17:58.983385 [info ] [Thread-1  ]: 1 of 3 START sql table model _staging.activity_types ........................... [RUN]
[0m01:17:58.983708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres__staging, now model.enpal_assessment_project.activity_types)
[0m01:17:58.983925 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m01:17:58.990924 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m01:17:58.991476 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m01:17:59.015532 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m01:17:59.016168 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:17:59.016479 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m01:17:59.016673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:59.027697 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m01:17:59.027931 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:17:59.028136 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."_staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m01:17:59.031470 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:17:59.038093 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:17:59.038327 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."_staging"."activity_types" rename to "activity_types__dbt_backup"
[0m01:17:59.039087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:59.040995 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:17:59.041204 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."_staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m01:17:59.042608 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:59.052073 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:17:59.052290 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:17:59.052478 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:17:59.056616 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m01:17:59.061178 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_staging"."activity_types__dbt_backup"
[0m01:17:59.063671 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:17:59.063876 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."_staging"."activity_types__dbt_backup" cascade
[0m01:17:59.067345 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m01:17:59.068796 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m01:17:59.070091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a41340>]}
[0m01:17:59.070469 [info ] [Thread-1  ]: 1 of 3 OK created sql table model _staging.activity_types ...................... [[32mSELECT 4579[0m in 0.09s]
[0m01:17:59.070797 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m01:17:59.071008 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m01:17:59.071244 [info ] [Thread-1  ]: 2 of 3 START sql table model _ods.ods_deal ..................................... [RUN]
[0m01:17:59.071521 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.ods_deal)
[0m01:17:59.071720 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m01:17:59.073684 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m01:17:59.074130 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m01:17:59.076434 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m01:17:59.076786 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:17:59.076981 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m01:17:59.077168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:59.089348 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m01:17:59.089694 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:17:59.090036 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."_ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."deal_changes"
  );
  
[0m01:17:59.095224 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.005 seconds
[0m01:17:59.097711 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:17:59.097940 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."_ods"."ods_deal" rename to "ods_deal__dbt_backup"
[0m01:17:59.098546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:17:59.100531 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:17:59.100747 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."_ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m01:17:59.101229 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:17:59.102107 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:17:59.102312 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:17:59.102503 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:17:59.103899 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:17:59.105553 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_ods"."ods_deal__dbt_backup"
[0m01:17:59.105990 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:17:59.106197 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."_ods"."ods_deal__dbt_backup" cascade
[0m01:17:59.108900 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m01:17:59.109652 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m01:17:59.110024 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108101c40>]}
[0m01:17:59.110407 [info ] [Thread-1  ]: 2 of 3 OK created sql table model _ods.ods_deal ................................ [[32mSELECT 15406[0m in 0.04s]
[0m01:17:59.110722 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m01:17:59.110939 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m01:17:59.111240 [info ] [Thread-1  ]: 3 of 3 START sql table model _pipedrive_analytics.test_model ................... [RUN]
[0m01:17:59.111488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal, now model.enpal_assessment_project.test_model)
[0m01:17:59.111687 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m01:17:59.113537 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m01:17:59.113987 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m01:17:59.117182 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m01:17:59.117543 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:17:59.117735 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m01:17:59.117960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:59.128767 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m01:17:59.129047 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:17:59.129251 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m01:17:59.132933 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:17:59.135219 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:17:59.135436 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m01:17:59.136038 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:17:59.137991 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:17:59.138200 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m01:17:59.138733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:17:59.139615 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:17:59.139818 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:17:59.140007 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:17:59.140923 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:17:59.142629 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_pipedrive_analytics"."test_model__dbt_backup"
[0m01:17:59.143043 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:17:59.143245 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m01:17:59.149318 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m01:17:59.150132 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m01:17:59.150509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2415db1a-56de-4a0a-9a59-6b0ce3c69dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108101c40>]}
[0m01:17:59.150925 [info ] [Thread-1  ]: 3 of 3 OK created sql table model _pipedrive_analytics.test_model .............. [[32mSELECT 4579[0m in 0.04s]
[0m01:17:59.151266 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m01:17:59.151928 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:59.152130 [debug] [MainThread]: On master: BEGIN
[0m01:17:59.152296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:17:59.159924 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:17:59.160192 [debug] [MainThread]: On master: COMMIT
[0m01:17:59.160374 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:59.160530 [debug] [MainThread]: On master: COMMIT
[0m01:17:59.160988 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:17:59.161192 [debug] [MainThread]: On master: Close
[0m01:17:59.161458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:59.161622 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m01:17:59.161850 [info ] [MainThread]: 
[0m01:17:59.162040 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m01:17:59.162607 [debug] [MainThread]: Command end result
[0m01:17:59.177954 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:17:59.179190 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:17:59.183283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m01:17:59.183541 [info ] [MainThread]: 
[0m01:17:59.183766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:59.183943 [info ] [MainThread]: 
[0m01:17:59.184123 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:17:59.185197 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3934236, "process_in_blocks": "0", "process_kernel_time": 0.164469, "process_mem_max_rss": "132972544", "process_out_blocks": "0", "process_user_time": 1.893434}
[0m01:17:59.185422 [debug] [MainThread]: Command `dbt run` succeeded at 01:17:59.185377 after 1.39 seconds
[0m01:17:59.185629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066450d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937f490>]}
[0m01:17:59.185844 [debug] [MainThread]: Flushing usage events
[0m01:17:59.716977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:21:55.604273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fd970>]}


============================== 01:21:55.606784 | 6e38d208-e9ba-4b51-a6b9-d43376279260 ==============================
[0m01:21:55.606784 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:21:55.607112 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'empty': 'False', 'quiet': 'False', 'debug': 'False', 'no_print': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'version_check': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run'}
[0m01:21:55.707724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e38d208-e9ba-4b51-a6b9-d43376279260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108affbe0>]}
[0m01:21:55.743448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e38d208-e9ba-4b51-a6b9-d43376279260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d11220>]}
[0m01:21:55.743981 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:21:55.817197 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:21:55.875918 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:21:55.876262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e38d208-e9ba-4b51-a6b9-d43376279260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec3370>]}
[0m01:21:56.526869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e38d208-e9ba-4b51-a6b9-d43376279260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b0130>]}
[0m01:21:56.602427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:21:56.603832 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:21:56.614281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e38d208-e9ba-4b51-a6b9-d43376279260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10983c7f0>]}
[0m01:21:56.614598 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:21:56.614786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e38d208-e9ba-4b51-a6b9-d43376279260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b5370>]}
[0m01:21:56.615587 [info ] [MainThread]: 
[0m01:21:56.615785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:21:56.615944 [info ] [MainThread]: 
[0m01:21:56.616216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:21:56.618794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:21:56.649389 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:21:56.649810 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:21:56.650000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:56.670509 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m01:21:56.671380 [debug] [ThreadPool]: On list_postgres: Close
[0m01:21:56.673168 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:21:56.673360 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:21:56.673519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:56.681848 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m01:21:56.682608 [debug] [ThreadPool]: On list_postgres: Close
[0m01:21:56.684158 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:21:56.684399 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:21:56.684599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:56.693731 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.009 seconds
[0m01:21:56.694573 [debug] [ThreadPool]: On list_postgres: Close
[0m01:21:56.694967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m01:21:56.695235 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m01:21:56.698812 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m01:21:56.699024 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m01:21:56.699183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:56.707116 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:21:56.707355 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m01:21:56.707534 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m01:21:56.708078 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m01:21:56.708300 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m01:21:56.708789 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m01:21:56.708975 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:21:56.709145 [debug] [ThreadPool]: On create_postgres_: Close
[0m01:21:56.709560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:56.709725 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m01:21:56.709889 [info ] [MainThread]: 
[0m01:21:56.710070 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m01:21:56.710352 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m01:21:56.711452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1481396, "process_in_blocks": "0", "process_kernel_time": 0.144574, "process_mem_max_rss": "129859584", "process_out_blocks": "0", "process_user_time": 1.745715}
[0m01:21:56.711691 [debug] [MainThread]: Command `dbt run` failed at 01:21:56.711639 after 1.15 seconds
[0m01:21:56.711895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109949d60>]}
[0m01:21:56.712114 [debug] [MainThread]: Flushing usage events
[0m01:21:57.245599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:25:20.852555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119913850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b385c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b385a90>]}


============================== 01:25:20.855864 | b93deb43-fc02-4cf8-a280-e3f10c4fd5e7 ==============================
[0m01:25:20.855864 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:25:20.856254 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'invocation_command': 'dbt run', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'version_check': 'True', 'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True'}
[0m01:25:20.970214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b385100>]}
[0m01:25:21.005450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a308af0>]}
[0m01:25:21.006031 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:25:21.080358 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:25:21.138445 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:25:21.138755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a34b370>]}
[0m01:25:21.793677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d215130>]}
[0m01:25:21.868805 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:25:21.870148 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:25:21.881474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2020a0>]}
[0m01:25:21.881810 [info ] [MainThread]: Found 3 models, 7 sources, 447 macros
[0m01:25:21.882007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2260d0>]}
[0m01:25:21.882836 [info ] [MainThread]: 
[0m01:25:21.883031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:25:21.883189 [info ] [MainThread]: 
[0m01:25:21.883469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:25:21.886091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:25:21.916754 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:25:21.917023 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:25:21.917187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:21.954770 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.038 seconds
[0m01:25:21.955719 [debug] [ThreadPool]: On list_postgres: Close
[0m01:25:21.957743 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:25:21.957967 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:25:21.958146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:21.968088 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m01:25:21.968853 [debug] [ThreadPool]: On list_postgres: Close
[0m01:25:21.970429 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:25:21.970668 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:25:21.970855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:21.980390 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m01:25:21.981190 [debug] [ThreadPool]: On list_postgres: Close
[0m01:25:21.981922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres__staging)
[0m01:25:21.985852 [debug] [ThreadPool]: Using postgres connection "list_postgres__staging"
[0m01:25:21.986059 [debug] [ThreadPool]: On list_postgres__staging: BEGIN
[0m01:25:21.986219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:21.996232 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:25:21.996404 [debug] [ThreadPool]: Using postgres connection "list_postgres__staging"
[0m01:25:21.996580 [debug] [ThreadPool]: On list_postgres__staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m01:25:21.999006 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:25:21.999781 [debug] [ThreadPool]: On list_postgres__staging: ROLLBACK
[0m01:25:22.000227 [debug] [ThreadPool]: On list_postgres__staging: Close
[0m01:25:22.000535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres__staging, now list_postgres__ods)
[0m01:25:22.002100 [debug] [ThreadPool]: Using postgres connection "list_postgres__ods"
[0m01:25:22.002288 [debug] [ThreadPool]: On list_postgres__ods: BEGIN
[0m01:25:22.002436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:22.009245 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:25:22.009489 [debug] [ThreadPool]: Using postgres connection "list_postgres__ods"
[0m01:25:22.009675 [debug] [ThreadPool]: On list_postgres__ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_ods'
  
[0m01:25:22.011480 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:25:22.012281 [debug] [ThreadPool]: On list_postgres__ods: ROLLBACK
[0m01:25:22.012732 [debug] [ThreadPool]: On list_postgres__ods: Close
[0m01:25:22.013058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres__ods, now list_postgres__pipedrive_analytics)
[0m01:25:22.014674 [debug] [ThreadPool]: Using postgres connection "list_postgres__pipedrive_analytics"
[0m01:25:22.014890 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: BEGIN
[0m01:25:22.015050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:22.024277 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:25:22.024525 [debug] [ThreadPool]: Using postgres connection "list_postgres__pipedrive_analytics"
[0m01:25:22.024725 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres__pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_pipedrive_analytics'
  
[0m01:25:22.026721 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:25:22.027601 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: ROLLBACK
[0m01:25:22.028185 [debug] [ThreadPool]: On list_postgres__pipedrive_analytics: Close
[0m01:25:22.031441 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:22.031670 [debug] [MainThread]: On master: BEGIN
[0m01:25:22.031830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:25:22.039538 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:25:22.039761 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:22.040007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:25:22.042438 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:25:22.043152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1839d0>]}
[0m01:25:22.043446 [debug] [MainThread]: On master: ROLLBACK
[0m01:25:22.043870 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:22.044037 [debug] [MainThread]: On master: BEGIN
[0m01:25:22.044828 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:25:22.045034 [debug] [MainThread]: On master: COMMIT
[0m01:25:22.045236 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:22.045400 [debug] [MainThread]: On master: COMMIT
[0m01:25:22.045806 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:25:22.046016 [debug] [MainThread]: On master: Close
[0m01:25:22.048507 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m01:25:22.048866 [info ] [Thread-1  ]: 1 of 3 START sql table model _staging.activity_types ........................... [RUN]
[0m01:25:22.049152 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres__pipedrive_analytics, now model.enpal_assessment_project.activity_types)
[0m01:25:22.049359 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m01:25:22.056144 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m01:25:22.056799 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m01:25:22.081341 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m01:25:22.081995 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:25:22.082205 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m01:25:22.082383 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:25:22.094348 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m01:25:22.094592 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:25:22.094791 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."_staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m01:25:22.097946 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:25:22.104292 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:25:22.104532 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."_staging"."activity_types" rename to "activity_types__dbt_backup"
[0m01:25:22.105253 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:25:22.107175 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:25:22.107383 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."_staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m01:25:22.107981 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:25:22.117469 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:25:22.117693 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:25:22.117876 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:25:22.123640 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m01:25:22.128396 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_staging"."activity_types__dbt_backup"
[0m01:25:22.130909 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:25:22.131115 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."_staging"."activity_types__dbt_backup" cascade
[0m01:25:22.134799 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m01:25:22.136231 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m01:25:22.137577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118039370>]}
[0m01:25:22.137950 [info ] [Thread-1  ]: 1 of 3 OK created sql table model _staging.activity_types ...................... [[32mSELECT 4579[0m in 0.09s]
[0m01:25:22.138270 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m01:25:22.138485 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m01:25:22.138724 [info ] [Thread-1  ]: 2 of 3 START sql table model _ods.ods_deal ..................................... [RUN]
[0m01:25:22.138955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.ods_deal)
[0m01:25:22.139144 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m01:25:22.141076 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m01:25:22.141463 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m01:25:22.143767 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m01:25:22.144211 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:25:22.144452 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m01:25:22.144635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:25:22.155161 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m01:25:22.155413 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:25:22.155632 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."_ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."deal_changes"
  );
  
[0m01:25:22.161201 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.005 seconds
[0m01:25:22.163560 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:25:22.163774 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."_ods"."ods_deal" rename to "ods_deal__dbt_backup"
[0m01:25:22.164355 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:25:22.166248 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:25:22.166451 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."_ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m01:25:22.166964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:25:22.167835 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:25:22.168036 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:25:22.168210 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:25:22.169642 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:25:22.171295 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_ods"."ods_deal__dbt_backup"
[0m01:25:22.171704 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:25:22.171896 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."_ods"."ods_deal__dbt_backup" cascade
[0m01:25:22.173167 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:25:22.173910 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m01:25:22.174265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d61b1f0>]}
[0m01:25:22.174645 [info ] [Thread-1  ]: 2 of 3 OK created sql table model _ods.ods_deal ................................ [[32mSELECT 15406[0m in 0.04s]
[0m01:25:22.174963 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m01:25:22.175180 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m01:25:22.175438 [info ] [Thread-1  ]: 3 of 3 START sql table model _pipedrive_analytics.test_model ................... [RUN]
[0m01:25:22.175879 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal, now model.enpal_assessment_project.test_model)
[0m01:25:22.176162 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m01:25:22.178003 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m01:25:22.178523 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m01:25:22.181586 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m01:25:22.182002 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:25:22.182189 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m01:25:22.182359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:25:22.192046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m01:25:22.192281 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:25:22.192477 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m01:25:22.195226 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:25:22.197664 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:25:22.197887 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m01:25:22.199312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:25:22.201176 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:25:22.201377 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m01:25:22.202771 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:25:22.203607 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:25:22.203800 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:25:22.203981 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:25:22.207424 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m01:25:22.209107 [debug] [Thread-1  ]: Applying DROP to: "postgres"."_pipedrive_analytics"."test_model__dbt_backup"
[0m01:25:22.209669 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:25:22.209919 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m01:25:22.213006 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m01:25:22.213792 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m01:25:22.214160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b93deb43-fc02-4cf8-a280-e3f10c4fd5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2aa5b0>]}
[0m01:25:22.214548 [info ] [Thread-1  ]: 3 of 3 OK created sql table model _pipedrive_analytics.test_model .............. [[32mSELECT 4579[0m in 0.04s]
[0m01:25:22.214863 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m01:25:22.215449 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:22.215612 [debug] [MainThread]: On master: BEGIN
[0m01:25:22.215756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:25:22.225962 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:25:22.226325 [debug] [MainThread]: On master: COMMIT
[0m01:25:22.226625 [debug] [MainThread]: Using postgres connection "master"
[0m01:25:22.226791 [debug] [MainThread]: On master: COMMIT
[0m01:25:22.227328 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:25:22.227616 [debug] [MainThread]: On master: Close
[0m01:25:22.227903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:22.228073 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m01:25:22.228303 [info ] [MainThread]: 
[0m01:25:22.228497 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m01:25:22.229071 [debug] [MainThread]: Command end result
[0m01:25:22.244659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:25:22.245764 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:25:22.249647 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m01:25:22.249826 [info ] [MainThread]: 
[0m01:25:22.250034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:25:22.250196 [info ] [MainThread]: 
[0m01:25:22.250369 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:25:22.251419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4440914, "process_in_blocks": "0", "process_kernel_time": 0.173526, "process_mem_max_rss": "130121728", "process_out_blocks": "0", "process_user_time": 1.901937}
[0m01:25:22.251639 [debug] [MainThread]: Command `dbt run` succeeded at 01:25:22.251593 after 1.44 seconds
[0m01:25:22.251840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119913850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d70cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181a9eb0>]}
[0m01:25:22.252039 [debug] [MainThread]: Flushing usage events
[0m01:25:22.789064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:10.293503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080987f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c44cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c44af0>]}


============================== 01:31:10.296966 | 22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54 ==============================
[0m01:31:10.296966 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:31:10.297343 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'version_check': 'True', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m01:31:10.411723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfdbb0>]}
[0m01:31:10.447671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c08250>]}
[0m01:31:10.448429 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:31:10.521627 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:31:10.601169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:31:10.601509 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://macros/generate_schema_name.sql
[0m01:31:10.602893 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m01:31:11.226749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c36f130>]}
[0m01:31:11.272765 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:31:11.274121 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:31:11.285678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac94e50>]}
[0m01:31:11.286016 [info ] [MainThread]: Found 3 models, 7 sources, 448 macros
[0m01:31:11.286217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca6e20>]}
[0m01:31:11.287080 [info ] [MainThread]: 
[0m01:31:11.287285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:11.287444 [info ] [MainThread]: 
[0m01:31:11.287721 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:31:11.290277 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:31:11.321655 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:31:11.321943 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:31:11.322103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:11.355405 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.033 seconds
[0m01:31:11.356252 [debug] [ThreadPool]: On list_postgres: Close
[0m01:31:11.358004 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:31:11.358253 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:31:11.358493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:11.367001 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m01:31:11.367715 [debug] [ThreadPool]: On list_postgres: Close
[0m01:31:11.369174 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:31:11.369402 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:31:11.369597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:11.378714 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:31:11.379483 [debug] [ThreadPool]: On list_postgres: Close
[0m01:31:11.379887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_pipedrive_analytics)
[0m01:31:11.380174 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "pipedrive_analytics"
"
[0m01:31:11.383946 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m01:31:11.384159 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: BEGIN
[0m01:31:11.384312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:11.394512 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:31:11.394777 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m01:31:11.394958 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_pipedrive_analytics"} */
create schema if not exists "pipedrive_analytics"
[0m01:31:11.395578 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:31:11.396209 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: COMMIT
[0m01:31:11.396423 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m01:31:11.396589 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: COMMIT
[0m01:31:11.397541 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:31:11.397750 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: Close
[0m01:31:11.398125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_pipedrive_analytics, now create_postgres_ods)
[0m01:31:11.398419 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "ods"
"
[0m01:31:11.399939 [debug] [ThreadPool]: Using postgres connection "create_postgres_ods"
[0m01:31:11.400128 [debug] [ThreadPool]: On create_postgres_ods: BEGIN
[0m01:31:11.400282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:11.408494 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:31:11.408681 [debug] [ThreadPool]: Using postgres connection "create_postgres_ods"
[0m01:31:11.408838 [debug] [ThreadPool]: On create_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_ods"} */
create schema if not exists "ods"
[0m01:31:11.409350 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:31:11.409968 [debug] [ThreadPool]: On create_postgres_ods: COMMIT
[0m01:31:11.410149 [debug] [ThreadPool]: Using postgres connection "create_postgres_ods"
[0m01:31:11.410308 [debug] [ThreadPool]: On create_postgres_ods: COMMIT
[0m01:31:11.410969 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m01:31:11.411170 [debug] [ThreadPool]: On create_postgres_ods: Close
[0m01:31:11.411538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_ods, now create_postgres_staging)
[0m01:31:11.411829 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "staging"
"
[0m01:31:11.413289 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m01:31:11.413472 [debug] [ThreadPool]: On create_postgres_staging: BEGIN
[0m01:31:11.413622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:11.421868 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:31:11.422059 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m01:31:11.422216 [debug] [ThreadPool]: On create_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_staging"} */
create schema if not exists "staging"
[0m01:31:11.422703 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m01:31:11.423232 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m01:31:11.423415 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m01:31:11.423575 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m01:31:11.424286 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:31:11.424451 [debug] [ThreadPool]: On create_postgres_staging: Close
[0m01:31:11.425141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_staging, now list_postgres_pipedrive_analytics)
[0m01:31:11.428981 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:31:11.429187 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m01:31:11.429347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:11.439567 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:31:11.439789 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:31:11.439979 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m01:31:11.441855 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:31:11.442663 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m01:31:11.443115 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m01:31:11.443439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_ods)
[0m01:31:11.445013 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m01:31:11.445242 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m01:31:11.445421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:11.464272 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m01:31:11.464551 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m01:31:11.464748 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m01:31:11.466822 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:31:11.467969 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m01:31:11.468443 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m01:31:11.468925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m01:31:11.470797 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:31:11.471027 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m01:31:11.471210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:11.478592 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:31:11.478823 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:31:11.479017 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m01:31:11.480808 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m01:31:11.481514 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m01:31:11.481937 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m01:31:11.485111 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:11.485371 [debug] [MainThread]: On master: BEGIN
[0m01:31:11.485541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:31:11.494423 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:31:11.494644 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:11.494877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:31:11.496980 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:31:11.497723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af04a90>]}
[0m01:31:11.498046 [debug] [MainThread]: On master: ROLLBACK
[0m01:31:11.498981 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:11.499241 [debug] [MainThread]: On master: BEGIN
[0m01:31:11.500319 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:31:11.500497 [debug] [MainThread]: On master: COMMIT
[0m01:31:11.500660 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:11.500818 [debug] [MainThread]: On master: COMMIT
[0m01:31:11.501879 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:31:11.502070 [debug] [MainThread]: On master: Close
[0m01:31:11.504653 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m01:31:11.505040 [info ] [Thread-1  ]: 1 of 3 START sql table model staging.activity_types ............................ [RUN]
[0m01:31:11.505346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.activity_types)
[0m01:31:11.505578 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m01:31:11.512433 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m01:31:11.513294 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m01:31:11.536925 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m01:31:11.537413 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:31:11.537629 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m01:31:11.537810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:31:11.550447 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m01:31:11.550737 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:31:11.550944 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m01:31:11.553606 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.002 seconds
[0m01:31:11.560004 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:31:11.560233 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m01:31:11.561178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:31:11.569627 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:31:11.569868 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:31:11.570060 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:31:11.573160 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m01:31:11.576837 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."activity_types__dbt_backup"
[0m01:31:11.579370 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:31:11.579593 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."staging"."activity_types__dbt_backup" cascade
[0m01:31:11.580727 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:31:11.582179 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m01:31:11.583446 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9071c0>]}
[0m01:31:11.583834 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging.activity_types ....................... [[32mSELECT 4579[0m in 0.08s]
[0m01:31:11.584151 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m01:31:11.584362 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m01:31:11.584597 [info ] [Thread-1  ]: 2 of 3 START sql table model ods.ods_deal ...................................... [RUN]
[0m01:31:11.584923 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.ods_deal)
[0m01:31:11.585146 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m01:31:11.587040 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m01:31:11.587479 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m01:31:11.590168 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m01:31:11.590604 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:31:11.590807 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m01:31:11.591064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:31:11.601614 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m01:31:11.601895 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:31:11.602103 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."deal_changes"
  );
  
[0m01:31:11.607686 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.005 seconds
[0m01:31:11.609981 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:31:11.610204 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m01:31:11.610819 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:11.611597 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:31:11.611813 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:31:11.612005 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:31:11.613426 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:31:11.614978 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal__dbt_backup"
[0m01:31:11.615295 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:31:11.615490 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."ods"."ods_deal__dbt_backup" cascade
[0m01:31:11.615979 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m01:31:11.616717 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m01:31:11.617077 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d41f0>]}
[0m01:31:11.617468 [info ] [Thread-1  ]: 2 of 3 OK created sql table model ods.ods_deal ................................. [[32mSELECT 15406[0m in 0.03s]
[0m01:31:11.617793 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m01:31:11.618023 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m01:31:11.618316 [info ] [Thread-1  ]: 3 of 3 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m01:31:11.618573 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal, now model.enpal_assessment_project.test_model)
[0m01:31:11.618767 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m01:31:11.620694 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m01:31:11.621150 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m01:31:11.623142 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m01:31:11.623485 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:31:11.623689 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m01:31:11.623868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:31:11.631566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m01:31:11.631847 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:31:11.632047 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m01:31:11.634602 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.002 seconds
[0m01:31:11.636776 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:31:11.636980 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m01:31:11.637557 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:11.638281 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:31:11.638478 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:31:11.638654 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:31:11.640502 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:31:11.642719 [debug] [Thread-1  ]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m01:31:11.643032 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:31:11.643226 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m01:31:11.644003 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:31:11.676415 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m01:31:11.676838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22fbd1ee-9d3c-43de-82ff-3c88ef0f9b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c960a60>]}
[0m01:31:11.677217 [info ] [Thread-1  ]: 3 of 3 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 4579[0m in 0.06s]
[0m01:31:11.677625 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m01:31:11.678302 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:11.678535 [debug] [MainThread]: On master: BEGIN
[0m01:31:11.678687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:31:11.688614 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:31:11.688887 [debug] [MainThread]: On master: COMMIT
[0m01:31:11.689063 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:11.689224 [debug] [MainThread]: On master: COMMIT
[0m01:31:11.689632 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:31:11.689845 [debug] [MainThread]: On master: Close
[0m01:31:11.690112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:11.690271 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m01:31:11.690494 [info ] [MainThread]: 
[0m01:31:11.690684 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m01:31:11.691231 [debug] [MainThread]: Command end result
[0m01:31:11.706078 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:31:11.707214 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:31:11.711046 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m01:31:11.711243 [info ] [MainThread]: 
[0m01:31:11.711477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:11.711658 [info ] [MainThread]: 
[0m01:31:11.711836 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:31:11.713023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4622838, "process_in_blocks": "0", "process_kernel_time": 0.179551, "process_mem_max_rss": "132202496", "process_out_blocks": "0", "process_user_time": 1.902128}
[0m01:31:11.713298 [debug] [MainThread]: Command `dbt run` succeeded at 01:31:11.713244 after 1.46 seconds
[0m01:31:11.713519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080987f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac94520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c2b80>]}
[0m01:31:11.713739 [debug] [MainThread]: Flushing usage events
[0m01:31:12.223911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:34:33.245711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103943850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b5b20>]}


============================== 01:34:33.249334 | f57b1aed-0eec-4b8a-9fd8-4b0455ce468d ==============================
[0m01:34:33.249334 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:34:33.249691 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True'}
[0m01:34:33.365009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f57b1aed-0eec-4b8a-9fd8-4b0455ce468d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499e040>]}
[0m01:34:33.400194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f57b1aed-0eec-4b8a-9fd8-4b0455ce468d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e77fd0>]}
[0m01:34:33.400782 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:34:33.476525 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:34:33.557732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:34:33.558166 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/ods/ods_deal.sql
[0m01:34:33.664797 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.ods_deal' (models/ods/ods_deal.sql) depends on a source named 'staging.activity_types' which was not found
[0m01:34:33.665993 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4655035, "process_in_blocks": "0", "process_kernel_time": 0.147927, "process_mem_max_rss": "112459776", "process_out_blocks": "0", "process_user_time": 1.089883}
[0m01:34:33.666251 [debug] [MainThread]: Command `dbt run` failed at 01:34:33.666191 after 0.47 seconds
[0m01:34:33.666482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103943850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b64fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8c2e0>]}
[0m01:34:33.666700 [debug] [MainThread]: Flushing usage events
[0m01:34:34.311677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:36:55.657752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103983850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f5a90>]}


============================== 01:36:55.660777 | 3b5b0231-22c0-45e2-8345-4ebb1fa941d5 ==============================
[0m01:36:55.660777 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:36:55.661106 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_colors': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False'}
[0m01:36:55.774133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b5b0231-22c0-45e2-8345-4ebb1fa941d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f5100>]}
[0m01:36:55.809608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b5b0231-22c0-45e2-8345-4ebb1fa941d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104278af0>]}
[0m01:36:55.810577 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:36:55.883138 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:36:55.959685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:36:55.960064 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/ods/ods_deal.sql
[0m01:36:56.066074 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.ods_deal' (models/ods/ods_deal.sql) depends on a node named 'staging_activity_types' which was not found
[0m01:36:56.067300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.45164174, "process_in_blocks": "0", "process_kernel_time": 0.141175, "process_mem_max_rss": "111460352", "process_out_blocks": "0", "process_user_time": 1.085183}
[0m01:36:56.067556 [debug] [MainThread]: Command `dbt run` failed at 01:36:56.067503 after 0.45 seconds
[0m01:36:56.067779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103983850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af6970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d1610>]}
[0m01:36:56.068005 [debug] [MainThread]: Flushing usage events
[0m01:36:56.585763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:19.299533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aff850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b71c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b71a90>]}


============================== 01:37:19.302652 | f1a43306-0c10-48e6-86e8-81c6147e3b99 ==============================
[0m01:37:19.302652 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:37:19.302985 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False'}
[0m01:37:19.413156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1a43306-0c10-48e6-86e8-81c6147e3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b71100>]}
[0m01:37:19.448211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1a43306-0c10-48e6-86e8-81c6147e3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f4af0>]}
[0m01:37:19.449202 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:37:19.519898 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:37:19.597300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:37:19.597702 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/ods/ods_deal.sql
[0m01:37:19.748536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1a43306-0c10-48e6-86e8-81c6147e3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d42130>]}
[0m01:37:19.826715 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:37:19.828029 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:37:19.839452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1a43306-0c10-48e6-86e8-81c6147e3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4ffa0>]}
[0m01:37:19.839760 [info ] [MainThread]: Found 3 models, 7 sources, 448 macros
[0m01:37:19.839957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1a43306-0c10-48e6-86e8-81c6147e3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b09100>]}
[0m01:37:19.840778 [info ] [MainThread]: 
[0m01:37:19.840971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:19.841132 [info ] [MainThread]: 
[0m01:37:19.841406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:37:19.843936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:37:19.874705 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:37:19.874975 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:37:19.875132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:19.907843 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.033 seconds
[0m01:37:19.908682 [debug] [ThreadPool]: On list_postgres: Close
[0m01:37:19.910482 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:37:19.910724 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:37:19.910892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:19.919792 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:37:19.920510 [debug] [ThreadPool]: On list_postgres: Close
[0m01:37:19.922324 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:37:19.922547 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:37:19.922705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:19.931511 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:37:19.932244 [debug] [ThreadPool]: On list_postgres: Close
[0m01:37:19.932939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m01:37:19.936750 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:37:19.936960 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m01:37:19.937115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:19.946167 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:37:19.946402 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:37:19.946597 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m01:37:19.948510 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:37:19.949254 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m01:37:19.949662 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m01:37:19.949970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_ods)
[0m01:37:19.951475 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m01:37:19.951660 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m01:37:19.951814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:19.959161 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:37:19.959387 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m01:37:19.959573 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m01:37:19.961605 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:37:19.962316 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m01:37:19.962761 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m01:37:19.963086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m01:37:19.964586 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:37:19.964774 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m01:37:19.964924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:19.971674 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:37:19.971893 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:37:19.972074 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m01:37:19.973972 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:37:19.974719 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m01:37:19.975149 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m01:37:19.978095 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:19.978313 [debug] [MainThread]: On master: BEGIN
[0m01:37:19.978468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:19.985674 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m01:37:19.985930 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:19.986292 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:37:19.988603 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:37:19.989385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1a43306-0c10-48e6-86e8-81c6147e3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107041730>]}
[0m01:37:19.989686 [debug] [MainThread]: On master: ROLLBACK
[0m01:37:19.990187 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:19.990359 [debug] [MainThread]: On master: BEGIN
[0m01:37:19.991019 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:37:19.991220 [debug] [MainThread]: On master: COMMIT
[0m01:37:19.991398 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:19.991556 [debug] [MainThread]: On master: COMMIT
[0m01:37:19.991958 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:19.992130 [debug] [MainThread]: On master: Close
[0m01:37:19.994563 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m01:37:19.994917 [info ] [Thread-1  ]: 1 of 3 START sql table model staging.activity_types ............................ [RUN]
[0m01:37:19.995203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.activity_types)
[0m01:37:19.995413 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m01:37:20.000573 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m01:37:20.001205 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m01:37:20.026649 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m01:37:20.027297 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:37:20.027505 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m01:37:20.027689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:37:20.040823 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m01:37:20.041051 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:37:20.041255 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m01:37:20.044354 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:37:20.050693 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:37:20.050935 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types" rename to "activity_types__dbt_backup"
[0m01:37:20.051680 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:37:20.053737 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:37:20.053967 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m01:37:20.054577 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:20.064307 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:37:20.064535 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:37:20.064716 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:37:20.067682 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m01:37:20.071396 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."activity_types__dbt_backup"
[0m01:37:20.073770 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:37:20.073989 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."staging"."activity_types__dbt_backup" cascade
[0m01:37:20.077445 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m01:37:20.078873 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m01:37:20.080162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a43306-0c10-48e6-86e8-81c6147e3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108148970>]}
[0m01:37:20.080554 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging.activity_types ....................... [[32mSELECT 4579[0m in 0.08s]
[0m01:37:20.080873 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m01:37:20.081089 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m01:37:20.081329 [info ] [Thread-1  ]: 2 of 3 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m01:37:20.081631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.test_model)
[0m01:37:20.081909 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m01:37:20.083831 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m01:37:20.084287 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m01:37:20.087131 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m01:37:20.087572 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:37:20.087770 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m01:37:20.087949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:37:20.100356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m01:37:20.100647 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:37:20.100863 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m01:37:20.103845 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:37:20.106124 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:37:20.106351 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m01:37:20.106956 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:20.108894 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:37:20.109109 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m01:37:20.109660 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:20.110382 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:37:20.110583 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:37:20.110778 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:37:20.113233 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:37:20.114890 [debug] [Thread-1  ]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m01:37:20.115244 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:37:20.115449 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m01:37:20.116894 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:37:20.117803 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m01:37:20.118184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a43306-0c10-48e6-86e8-81c6147e3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559b2e0>]}
[0m01:37:20.118567 [info ] [Thread-1  ]: 2 of 3 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 4579[0m in 0.04s]
[0m01:37:20.118885 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m01:37:20.119104 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m01:37:20.119482 [info ] [Thread-1  ]: 3 of 3 START sql table model ods.ods_deal ...................................... [RUN]
[0m01:37:20.119851 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now model.enpal_assessment_project.ods_deal)
[0m01:37:20.120068 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m01:37:20.122133 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m01:37:20.122616 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m01:37:20.124771 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m01:37:20.125359 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:37:20.125552 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m01:37:20.125725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:37:20.136697 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m01:37:20.136984 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:37:20.137215 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."staging"."activity_types"
  );
  
[0m01:37:20.140359 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:37:20.142581 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:37:20.142798 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."ods"."ods_deal" rename to "ods_deal__dbt_backup"
[0m01:37:20.143346 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:20.146038 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:37:20.146253 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m01:37:20.146911 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:37:20.147747 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:37:20.147972 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:37:20.148165 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:37:20.149659 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:37:20.151400 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal__dbt_backup"
[0m01:37:20.151756 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:37:20.151951 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."ods"."ods_deal__dbt_backup" cascade
[0m01:37:20.153202 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:37:20.154048 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m01:37:20.154441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a43306-0c10-48e6-86e8-81c6147e3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559b2e0>]}
[0m01:37:20.154852 [info ] [Thread-1  ]: 3 of 3 OK created sql table model ods.ods_deal ................................. [[32mSELECT 4579[0m in 0.03s]
[0m01:37:20.155193 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m01:37:20.155871 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:20.156053 [debug] [MainThread]: On master: BEGIN
[0m01:37:20.156202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:20.166126 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:37:20.166326 [debug] [MainThread]: On master: COMMIT
[0m01:37:20.166485 [debug] [MainThread]: Using postgres connection "master"
[0m01:37:20.166634 [debug] [MainThread]: On master: COMMIT
[0m01:37:20.167026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:37:20.167306 [debug] [MainThread]: On master: Close
[0m01:37:20.167558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:20.167719 [debug] [MainThread]: Connection 'model.enpal_assessment_project.ods_deal' was properly closed.
[0m01:37:20.167936 [info ] [MainThread]: 
[0m01:37:20.168120 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m01:37:20.168662 [debug] [MainThread]: Command end result
[0m01:37:20.183720 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:37:20.184739 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:37:20.189283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m01:37:20.189524 [info ] [MainThread]: 
[0m01:37:20.189749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:20.189922 [info ] [MainThread]: 
[0m01:37:20.190108 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:37:20.191208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.93419677, "process_in_blocks": "0", "process_kernel_time": 0.144575, "process_mem_max_rss": "130416640", "process_out_blocks": "0", "process_user_time": 1.414939}
[0m01:37:20.191435 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:20.191389 after 0.93 seconds
[0m01:37:20.191650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aff850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5a0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4f4f0>]}
[0m01:37:20.191865 [debug] [MainThread]: Flushing usage events
[0m01:37:20.675665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:08.805385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106935c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106935a90>]}


============================== 01:41:08.808223 | cebcbd49-7a8c-4a5b-ad07-139e06d186cd ==============================
[0m01:41:08.808223 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:41:08.808545 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'empty': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt run'}
[0m01:41:08.910318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cebcbd49-7a8c-4a5b-ad07-139e06d186cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106935100>]}
[0m01:41:08.946198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cebcbd49-7a8c-4a5b-ad07-139e06d186cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b8af0>]}
[0m01:41:08.946864 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:41:09.019097 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:41:09.099797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:41:09.100285 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/sources.yml
[0m01:41:09.295800 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.activity_types' (models/staging/activity_types.sql) depends on a source named 'pipedrive_raw.activity' which was not found
[0m01:41:09.297421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5333255, "process_in_blocks": "0", "process_kernel_time": 0.149599, "process_mem_max_rss": "115408896", "process_out_blocks": "0", "process_user_time": 1.169313}
[0m01:41:09.297654 [debug] [MainThread]: Command `dbt run` failed at 01:41:09.297607 after 0.53 seconds
[0m01:41:09.297856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a83790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac37f0>]}
[0m01:41:09.298062 [debug] [MainThread]: Flushing usage events
[0m01:41:09.800599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:23.660335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e47880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d0340>]}


============================== 01:41:23.662751 | 3b73520a-8318-4065-87bc-778c1b3927bd ==============================
[0m01:41:23.662751 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:41:23.663084 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'empty': 'False', 'no_print': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m01:41:23.762295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b73520a-8318-4065-87bc-778c1b3927bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055aee50>]}
[0m01:41:23.797851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b73520a-8318-4065-87bc-778c1b3927bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100fea5b0>]}
[0m01:41:23.798376 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:41:23.866905 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m01:41:23.941159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:41:23.941670 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/sources.yml
[0m01:41:23.941871 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/activity_types.sql
[0m01:41:24.183297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b73520a-8318-4065-87bc-778c1b3927bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106486fa0>]}
[0m01:41:24.229494 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:41:24.230539 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:41:24.241179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b73520a-8318-4065-87bc-778c1b3927bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10291bb20>]}
[0m01:41:24.241475 [info ] [MainThread]: Found 3 models, 7 sources, 448 macros
[0m01:41:24.241673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b73520a-8318-4065-87bc-778c1b3927bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dac0d0>]}
[0m01:41:24.242495 [info ] [MainThread]: 
[0m01:41:24.242689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:41:24.242847 [info ] [MainThread]: 
[0m01:41:24.243140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:41:24.245634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:41:24.276290 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:41:24.276580 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:41:24.276740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:24.296679 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m01:41:24.297523 [debug] [ThreadPool]: On list_postgres: Close
[0m01:41:24.299264 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:41:24.299536 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:41:24.299760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:24.308688 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m01:41:24.309509 [debug] [ThreadPool]: On list_postgres: Close
[0m01:41:24.311061 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:41:24.311276 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:41:24.311481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:24.319704 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m01:41:24.320480 [debug] [ThreadPool]: On list_postgres: Close
[0m01:41:24.321221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m01:41:24.325082 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:41:24.325355 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m01:41:24.325533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:24.334532 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:41:24.334736 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:41:24.334913 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m01:41:24.336941 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:41:24.337764 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m01:41:24.338221 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m01:41:24.338549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m01:41:24.340063 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m01:41:24.340260 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m01:41:24.340434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:24.347038 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:41:24.347265 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m01:41:24.347451 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m01:41:24.349520 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:41:24.351054 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m01:41:24.351542 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m01:41:24.351871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m01:41:24.353394 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:41:24.353632 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m01:41:24.353796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:24.362825 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:41:24.363034 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:41:24.363336 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m01:41:24.365537 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:41:24.366371 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m01:41:24.366832 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m01:41:24.369944 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:24.370186 [debug] [MainThread]: On master: BEGIN
[0m01:41:24.370350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:41:24.379056 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:41:24.379304 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:24.379548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:41:24.381667 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:41:24.382375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b73520a-8318-4065-87bc-778c1b3927bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106525460>]}
[0m01:41:24.382674 [debug] [MainThread]: On master: ROLLBACK
[0m01:41:24.383636 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:24.383803 [debug] [MainThread]: On master: BEGIN
[0m01:41:24.384955 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:41:24.385168 [debug] [MainThread]: On master: COMMIT
[0m01:41:24.385349 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:24.385513 [debug] [MainThread]: On master: COMMIT
[0m01:41:24.386434 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:41:24.386608 [debug] [MainThread]: On master: Close
[0m01:41:24.389011 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m01:41:24.389406 [info ] [Thread-1  ]: 1 of 3 START sql table model staging.activity_types ............................ [RUN]
[0m01:41:24.389708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.activity_types)
[0m01:41:24.389922 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m01:41:24.396280 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m01:41:24.396928 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m01:41:24.421378 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m01:41:24.422037 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:41:24.422262 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m01:41:24.422454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:41:24.434045 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m01:41:24.434267 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:41:24.434467 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m01:41:24.437502 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m01:41:24.444487 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:41:24.444737 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types" rename to "activity_types__dbt_backup"
[0m01:41:24.445991 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:41:24.447753 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:41:24.447964 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m01:41:24.449066 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:41:24.458609 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:41:24.458844 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:41:24.459033 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m01:41:24.464298 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m01:41:24.468038 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."activity_types__dbt_backup"
[0m01:41:24.470515 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m01:41:24.470727 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."staging"."activity_types__dbt_backup" cascade
[0m01:41:24.475165 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m01:41:24.476662 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m01:41:24.477989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b73520a-8318-4065-87bc-778c1b3927bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764da00>]}
[0m01:41:24.478402 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging.activity_types ....................... [[32mSELECT 4579[0m in 0.09s]
[0m01:41:24.478733 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m01:41:24.478962 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m01:41:24.479270 [info ] [Thread-1  ]: 2 of 3 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m01:41:24.479563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.test_model)
[0m01:41:24.479761 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m01:41:24.481553 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m01:41:24.481950 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m01:41:24.483984 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m01:41:24.484336 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:41:24.484534 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m01:41:24.484724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:41:24.493675 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m01:41:24.493948 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:41:24.494188 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m01:41:24.496747 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.002 seconds
[0m01:41:24.498906 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:41:24.499121 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m01:41:24.499697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:41:24.502352 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:41:24.502572 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m01:41:24.503121 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:41:24.503825 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:41:24.504027 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:41:24.504208 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m01:41:24.505456 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:41:24.507107 [debug] [Thread-1  ]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m01:41:24.507442 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m01:41:24.507645 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m01:41:24.508866 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:41:24.509594 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m01:41:24.509940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b73520a-8318-4065-87bc-778c1b3927bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d5220>]}
[0m01:41:24.510302 [info ] [Thread-1  ]: 2 of 3 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 4579[0m in 0.03s]
[0m01:41:24.510616 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m01:41:24.510842 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m01:41:24.511117 [info ] [Thread-1  ]: 3 of 3 START sql table model ods.ods_deal ...................................... [RUN]
[0m01:41:24.511347 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now model.enpal_assessment_project.ods_deal)
[0m01:41:24.511540 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m01:41:24.513523 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m01:41:24.513984 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m01:41:24.516045 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m01:41:24.516410 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:41:24.516611 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m01:41:24.516794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:41:24.525830 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m01:41:24.526116 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:41:24.526330 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."staging"."activity_types"
  );
  
[0m01:41:24.528916 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.002 seconds
[0m01:41:24.531169 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:41:24.531396 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."ods"."ods_deal" rename to "ods_deal__dbt_backup"
[0m01:41:24.532164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:41:24.533954 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:41:24.534164 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m01:41:24.534681 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:41:24.535393 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:41:24.535595 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:41:24.535774 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m01:41:24.538494 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m01:41:24.539997 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal__dbt_backup"
[0m01:41:24.540303 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m01:41:24.540492 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."ods"."ods_deal__dbt_backup" cascade
[0m01:41:24.543277 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m01:41:24.544018 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m01:41:24.544385 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b73520a-8318-4065-87bc-778c1b3927bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d5220>]}
[0m01:41:24.544781 [info ] [Thread-1  ]: 3 of 3 OK created sql table model ods.ods_deal ................................. [[32mSELECT 4579[0m in 0.03s]
[0m01:41:24.545109 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m01:41:24.545809 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:24.545995 [debug] [MainThread]: On master: BEGIN
[0m01:41:24.546148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:41:24.555578 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:41:24.555819 [debug] [MainThread]: On master: COMMIT
[0m01:41:24.555995 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:24.556152 [debug] [MainThread]: On master: COMMIT
[0m01:41:24.556609 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:41:24.556900 [debug] [MainThread]: On master: Close
[0m01:41:24.557173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:24.557342 [debug] [MainThread]: Connection 'model.enpal_assessment_project.ods_deal' was properly closed.
[0m01:41:24.557578 [info ] [MainThread]: 
[0m01:41:24.557773 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m01:41:24.558330 [debug] [MainThread]: Command end result
[0m01:41:24.573745 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m01:41:24.574893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m01:41:24.578823 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m01:41:24.579006 [info ] [MainThread]: 
[0m01:41:24.579228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:41:24.579403 [info ] [MainThread]: 
[0m01:41:24.579599 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:41:24.580644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9606093, "process_in_blocks": "0", "process_kernel_time": 0.141695, "process_mem_max_rss": "130301952", "process_out_blocks": "0", "process_user_time": 1.481951}
[0m01:41:24.580866 [debug] [MainThread]: Command `dbt run` succeeded at 01:41:24.580819 after 0.96 seconds
[0m01:41:24.581067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e47880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055aee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc4c40>]}
[0m01:41:24.581266 [debug] [MainThread]: Flushing usage events
[0m01:41:25.095406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:55:43.631549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ed7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107485b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107485970>]}


============================== 02:55:43.634817 | 905f1f96-ec9e-486c-8281-887315f1234a ==============================
[0m02:55:43.634817 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:55:43.635161 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True'}
[0m02:55:43.807770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107974df0>]}
[0m02:55:43.842962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794fe80>]}
[0m02:55:43.843706 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:55:43.914421 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:55:43.999313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m02:55:43.999720 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/deal_changes.sql
[0m02:55:43.999916 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/fields.sql
[0m02:55:44.000096 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/users.sql
[0m02:55:44.000266 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/activity.sql
[0m02:55:44.000430 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stages.sql
[0m02:55:44.000626 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/activity_types.sql
[0m02:55:44.188182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b63d90>]}
[0m02:55:44.238309 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m02:55:44.239525 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:55:44.251187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108651850>]}
[0m02:55:44.251483 [info ] [MainThread]: Found 8 models, 7 sources, 448 macros
[0m02:55:44.251682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102876a30>]}
[0m02:55:44.252609 [info ] [MainThread]: 
[0m02:55:44.252798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:55:44.252962 [info ] [MainThread]: 
[0m02:55:44.253230 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:55:44.255943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:55:44.289961 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:55:44.290245 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:55:44.290403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:44.388464 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.098 seconds
[0m02:55:44.389509 [debug] [ThreadPool]: On list_postgres: Close
[0m02:55:44.391534 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:55:44.391825 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:55:44.392052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:44.402103 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m02:55:44.403050 [debug] [ThreadPool]: On list_postgres: Close
[0m02:55:44.404867 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:55:44.405151 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:55:44.405343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:44.416626 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m02:55:44.417785 [debug] [ThreadPool]: On list_postgres: Close
[0m02:55:44.418307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_pipedrive_analytics)
[0m02:55:44.418617 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "pipedrive_analytics"
"
[0m02:55:44.422402 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m02:55:44.422615 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: BEGIN
[0m02:55:44.422785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:44.439115 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m02:55:44.439368 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m02:55:44.439573 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_pipedrive_analytics"} */
create schema if not exists "pipedrive_analytics"
[0m02:55:44.441015 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m02:55:44.441836 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: COMMIT
[0m02:55:44.442188 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m02:55:44.442458 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: COMMIT
[0m02:55:44.445079 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m02:55:44.445453 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: Close
[0m02:55:44.446916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_pipedrive_analytics, now list_postgres_staging)
[0m02:55:44.451557 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m02:55:44.451822 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m02:55:44.452009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:44.462469 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m02:55:44.462793 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m02:55:44.463069 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m02:55:44.466400 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m02:55:44.467342 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m02:55:44.467962 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m02:55:44.468487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m02:55:44.470260 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m02:55:44.470514 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m02:55:44.470703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:44.479315 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m02:55:44.479543 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m02:55:44.479729 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m02:55:44.481765 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m02:55:44.482645 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m02:55:44.483123 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m02:55:44.483468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m02:55:44.485958 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:55:44.486199 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:55:44.486376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:44.493402 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:55:44.493607 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:55:44.493813 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:55:44.495724 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m02:55:44.496644 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:55:44.497159 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:55:44.500646 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:44.500912 [debug] [MainThread]: On master: BEGIN
[0m02:55:44.501162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:44.508949 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m02:55:44.509221 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:44.509480 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:55:44.512699 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m02:55:44.513514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107963ca0>]}
[0m02:55:44.513849 [debug] [MainThread]: On master: ROLLBACK
[0m02:55:44.514409 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:44.514596 [debug] [MainThread]: On master: BEGIN
[0m02:55:44.515272 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:55:44.515545 [debug] [MainThread]: On master: COMMIT
[0m02:55:44.515763 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:44.515975 [debug] [MainThread]: On master: COMMIT
[0m02:55:44.516445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:55:44.516660 [debug] [MainThread]: On master: Close
[0m02:55:44.519120 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity
[0m02:55:44.519514 [info ] [Thread-1  ]: 1 of 8 START sql table model staging.activity .................................. [RUN]
[0m02:55:44.519805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.activity)
[0m02:55:44.520017 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity
[0m02:55:44.525907 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity"
[0m02:55:44.526616 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity
[0m02:55:44.551646 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity"
[0m02:55:44.552345 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m02:55:44.552550 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: BEGIN
[0m02:55:44.552722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:55:44.564834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m02:55:44.565064 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m02:55:44.565267 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */

  
    

  create  table "postgres"."staging"."activity__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity"
  );
  
[0m02:55:44.569797 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.004 seconds
[0m02:55:44.576710 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m02:55:44.576968 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */
alter table "postgres"."staging"."activity__dbt_tmp" rename to "activity"
[0m02:55:44.577841 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:55:44.586196 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: COMMIT
[0m02:55:44.586454 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m02:55:44.586645 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: COMMIT
[0m02:55:44.589958 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m02:55:44.593526 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."activity__dbt_backup"
[0m02:55:44.595935 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m02:55:44.596143 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */
drop table if exists "postgres"."staging"."activity__dbt_backup" cascade
[0m02:55:44.597195 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m02:55:44.598605 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: Close
[0m02:55:44.599816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f14670>]}
[0m02:55:44.600186 [info ] [Thread-1  ]: 1 of 8 OK created sql table model staging.activity ............................. [[32mSELECT 4579[0m in 0.08s]
[0m02:55:44.600497 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity
[0m02:55:44.600705 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m02:55:44.600943 [info ] [Thread-1  ]: 2 of 8 START sql table model staging.activity_types ............................ [RUN]
[0m02:55:44.601222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity, now model.enpal_assessment_project.activity_types)
[0m02:55:44.601424 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m02:55:44.603235 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m02:55:44.603646 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m02:55:44.605631 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m02:55:44.605972 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m02:55:44.606167 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m02:55:44.606346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:55:44.617823 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m02:55:44.618130 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m02:55:44.618329 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."activity_types"
  );
  
[0m02:55:44.619801 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m02:55:44.621839 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m02:55:44.622049 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m02:55:44.623342 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:55:44.623999 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m02:55:44.624192 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m02:55:44.624368 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m02:55:44.626071 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m02:55:44.627466 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."activity_types__dbt_backup"
[0m02:55:44.627766 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m02:55:44.627953 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."staging"."activity_types__dbt_backup" cascade
[0m02:55:44.628942 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m02:55:44.629647 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m02:55:44.629988 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe8b0>]}
[0m02:55:44.630355 [info ] [Thread-1  ]: 2 of 8 OK created sql table model staging.activity_types ....................... [[32mSELECT 4[0m in 0.03s]
[0m02:55:44.630664 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m02:55:44.630876 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.deal_changes
[0m02:55:44.631175 [info ] [Thread-1  ]: 3 of 8 START sql table model staging.deal_changes .............................. [RUN]
[0m02:55:44.631414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.deal_changes)
[0m02:55:44.631597 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.deal_changes
[0m02:55:44.634225 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.deal_changes"
[0m02:55:44.634728 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.deal_changes
[0m02:55:44.636764 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.deal_changes"
[0m02:55:44.637135 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m02:55:44.637342 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: BEGIN
[0m02:55:44.637598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:55:44.648095 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m02:55:44.648385 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m02:55:44.648600 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */

  
    

  create  table "postgres"."staging"."deal_changes__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."deal_changes"
  );
  
[0m02:55:44.659334 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.010 seconds
[0m02:55:44.661715 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m02:55:44.661955 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
alter table "postgres"."staging"."deal_changes__dbt_tmp" rename to "deal_changes"
[0m02:55:44.662605 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:55:44.663395 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: COMMIT
[0m02:55:44.663626 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m02:55:44.663826 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: COMMIT
[0m02:55:44.666026 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m02:55:44.667590 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."deal_changes__dbt_backup"
[0m02:55:44.667986 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m02:55:44.668195 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
drop table if exists "postgres"."staging"."deal_changes__dbt_backup" cascade
[0m02:55:44.668750 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m02:55:44.669544 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: Close
[0m02:55:44.669908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe8b0>]}
[0m02:55:44.670299 [info ] [Thread-1  ]: 3 of 8 OK created sql table model staging.deal_changes ......................... [[32mSELECT 15406[0m in 0.04s]
[0m02:55:44.670635 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.deal_changes
[0m02:55:44.671382 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.fields
[0m02:55:44.671725 [info ] [Thread-1  ]: 4 of 8 START sql table model staging.fields .................................... [RUN]
[0m02:55:44.672004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.deal_changes, now model.enpal_assessment_project.fields)
[0m02:55:44.672214 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.fields
[0m02:55:44.674503 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.fields"
[0m02:55:44.675038 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.fields
[0m02:55:44.677284 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.fields"
[0m02:55:44.677742 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m02:55:44.677949 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: BEGIN
[0m02:55:44.678133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:55:44.685427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m02:55:44.685731 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m02:55:44.685952 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */

  
    

  create  table "postgres"."staging"."fields__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."fields"
  );
  
[0m02:55:44.688018 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m02:55:44.690261 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m02:55:44.690480 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */
alter table "postgres"."staging"."fields__dbt_tmp" rename to "fields"
[0m02:55:44.691078 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:55:44.691880 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: COMMIT
[0m02:55:44.692105 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m02:55:44.692294 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: COMMIT
[0m02:55:44.693377 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m02:55:44.695796 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."fields__dbt_backup"
[0m02:55:44.696146 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m02:55:44.696351 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */
drop table if exists "postgres"."staging"."fields__dbt_backup" cascade
[0m02:55:44.696901 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m02:55:44.697678 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: Close
[0m02:55:44.698043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe8b0>]}
[0m02:55:44.698442 [info ] [Thread-1  ]: 4 of 8 OK created sql table model staging.fields ............................... [[32mSELECT 4[0m in 0.03s]
[0m02:55:44.698766 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.fields
[0m02:55:44.698988 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stages
[0m02:55:44.699277 [info ] [Thread-1  ]: 5 of 8 START sql table model staging.stages .................................... [RUN]
[0m02:55:44.699525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.fields, now model.enpal_assessment_project.stages)
[0m02:55:44.699718 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stages
[0m02:55:44.701832 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stages"
[0m02:55:44.702373 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stages
[0m02:55:44.704492 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stages"
[0m02:55:44.704988 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m02:55:44.705209 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: BEGIN
[0m02:55:44.705393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:55:44.712746 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m02:55:44.713028 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m02:55:44.713229 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stages"} */

  
    

  create  table "postgres"."staging"."stages__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."stages"
  );
  
[0m02:55:44.714553 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.001 seconds
[0m02:55:44.716650 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m02:55:44.716856 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stages"} */
alter table "postgres"."staging"."stages__dbt_tmp" rename to "stages"
[0m02:55:44.717342 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:55:44.718061 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: COMMIT
[0m02:55:44.718267 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m02:55:44.718446 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: COMMIT
[0m02:55:44.719622 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m02:55:44.721041 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stages__dbt_backup"
[0m02:55:44.721387 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m02:55:44.721582 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stages"} */
drop table if exists "postgres"."staging"."stages__dbt_backup" cascade
[0m02:55:44.722104 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m02:55:44.722813 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: Close
[0m02:55:44.723150 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe8b0>]}
[0m02:55:44.723522 [info ] [Thread-1  ]: 5 of 8 OK created sql table model staging.stages ............................... [[32mSELECT 9[0m in 0.02s]
[0m02:55:44.723825 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stages
[0m02:55:44.724039 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m02:55:44.724339 [info ] [Thread-1  ]: 6 of 8 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m02:55:44.724589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stages, now model.enpal_assessment_project.test_model)
[0m02:55:44.724780 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m02:55:44.726592 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m02:55:44.727030 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m02:55:44.730169 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m02:55:44.730647 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m02:55:44.730836 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m02:55:44.731008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:55:44.738173 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m02:55:44.738488 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m02:55:44.738704 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m02:55:44.741915 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m02:55:44.744143 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m02:55:44.744359 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m02:55:44.744973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:55:44.745856 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m02:55:44.746095 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m02:55:44.746337 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m02:55:44.747777 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m02:55:44.749522 [debug] [Thread-1  ]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m02:55:44.749860 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m02:55:44.750062 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m02:55:44.750599 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m02:55:44.751486 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m02:55:44.751856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe8b0>]}
[0m02:55:44.752260 [info ] [Thread-1  ]: 6 of 8 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 4579[0m in 0.03s]
[0m02:55:44.752589 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m02:55:44.752813 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.users
[0m02:55:44.753125 [info ] [Thread-1  ]: 7 of 8 START sql table model staging.users ..................................... [RUN]
[0m02:55:44.753398 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now model.enpal_assessment_project.users)
[0m02:55:44.753598 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.users
[0m02:55:44.755625 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.users"
[0m02:55:44.756106 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.users
[0m02:55:44.758279 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.users"
[0m02:55:44.758729 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m02:55:44.758931 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: BEGIN
[0m02:55:44.759114 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:55:44.766198 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m02:55:44.766470 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m02:55:44.766674 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.users"} */

  
    

  create  table "postgres"."staging"."users__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."public"."users"
  );
  
[0m02:55:44.769469 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.003 seconds
[0m02:55:44.771567 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m02:55:44.771785 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.users"} */
alter table "postgres"."staging"."users__dbt_tmp" rename to "users"
[0m02:55:44.772350 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:55:44.773076 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: COMMIT
[0m02:55:44.773272 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m02:55:44.773440 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: COMMIT
[0m02:55:44.774045 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m02:55:44.775510 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."users__dbt_backup"
[0m02:55:44.775814 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m02:55:44.775999 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.users"} */
drop table if exists "postgres"."staging"."users__dbt_backup" cascade
[0m02:55:44.776428 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m02:55:44.777171 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: Close
[0m02:55:44.777519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe8b0>]}
[0m02:55:44.777899 [info ] [Thread-1  ]: 7 of 8 OK created sql table model staging.users ................................ [[32mSELECT 1787[0m in 0.02s]
[0m02:55:44.778367 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.users
[0m02:55:44.778599 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m02:55:44.778969 [info ] [Thread-1  ]: 8 of 8 START sql table model ods.ods_deal ...................................... [RUN]
[0m02:55:44.779313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.users, now model.enpal_assessment_project.ods_deal)
[0m02:55:44.779521 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m02:55:44.782445 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m02:55:44.782989 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m02:55:44.785069 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m02:55:44.785520 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m02:55:44.785730 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m02:55:44.785920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:55:44.794773 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m02:55:44.795027 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m02:55:44.795230 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."staging"."activity_types"
  );
  
[0m02:55:44.796796 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m02:55:44.798936 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m02:55:44.799147 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m02:55:44.799754 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:55:44.800425 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m02:55:44.800615 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m02:55:44.800787 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m02:55:44.801720 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m02:55:44.803156 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal__dbt_backup"
[0m02:55:44.803530 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m02:55:44.803721 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."ods"."ods_deal__dbt_backup" cascade
[0m02:55:44.804254 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m02:55:44.805025 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m02:55:44.805384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905f1f96-ec9e-486c-8281-887315f1234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a139ca0>]}
[0m02:55:44.805779 [info ] [Thread-1  ]: 8 of 8 OK created sql table model ods.ods_deal ................................. [[32mSELECT 4[0m in 0.03s]
[0m02:55:44.806101 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m02:55:44.806714 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:44.806888 [debug] [MainThread]: On master: BEGIN
[0m02:55:44.807036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:55:44.816076 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m02:55:44.816336 [debug] [MainThread]: On master: COMMIT
[0m02:55:44.816495 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:44.816642 [debug] [MainThread]: On master: COMMIT
[0m02:55:44.817100 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:55:44.817266 [debug] [MainThread]: On master: Close
[0m02:55:44.817511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:55:44.817652 [debug] [MainThread]: Connection 'model.enpal_assessment_project.ods_deal' was properly closed.
[0m02:55:44.817855 [info ] [MainThread]: 
[0m02:55:44.818030 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m02:55:44.818883 [debug] [MainThread]: Command end result
[0m02:55:44.833956 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m02:55:44.834945 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m02:55:44.839579 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m02:55:44.839839 [info ] [MainThread]: 
[0m02:55:44.840071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:55:44.840245 [info ] [MainThread]: 
[0m02:55:44.840427 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m02:55:44.841882 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2554657, "process_in_blocks": "0", "process_kernel_time": 0.223589, "process_mem_max_rss": "131301376", "process_out_blocks": "0", "process_user_time": 1.52942}
[0m02:55:44.842106 [debug] [MainThread]: Command `dbt run` succeeded at 02:55:44.842060 after 1.26 seconds
[0m02:55:44.842313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ed7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108638400>]}
[0m02:55:44.842526 [debug] [MainThread]: Flushing usage events
[0m02:55:45.502572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:18.628948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035a17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461f310>]}


============================== 11:38:18.632195 | 7338e924-6b40-4282-9f8e-7c47543fe345 ==============================
[0m11:38:18.632195 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:18.632540 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'invocation_command': 'dbt build -s deal_changes', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'empty': 'False', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'no_print': 'None', 'warn_error': 'None', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m11:38:18.800620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7338e924-6b40-4282-9f8e-7c47543fe345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cf1a30>]}
[0m11:38:18.835894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7338e924-6b40-4282-9f8e-7c47543fe345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2e940>]}
[0m11:38:18.836508 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:38:18.909263 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:18.993827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:38:18.994195 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/deal_changes.sql
[0m11:38:19.173762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7338e924-6b40-4282-9f8e-7c47543fe345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c4cd0>]}
[0m11:38:19.223573 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:38:19.224815 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:38:19.242450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7338e924-6b40-4282-9f8e-7c47543fe345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e96d0>]}
[0m11:38:19.242759 [info ] [MainThread]: Found 8 models, 7 sources, 448 macros
[0m11:38:19.243516 [info ] [MainThread]: 
[0m11:38:19.243717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:19.243879 [info ] [MainThread]: 
[0m11:38:19.244142 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:38:19.244590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:38:19.276389 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:38:19.276666 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:38:19.276833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:19.373057 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.096 seconds
[0m11:38:19.374044 [debug] [ThreadPool]: On list_postgres: Close
[0m11:38:19.377681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m11:38:19.381891 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:38:19.382112 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m11:38:19.382288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:19.394357 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:38:19.394725 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:38:19.394940 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m11:38:19.398750 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m11:38:19.399972 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m11:38:19.400665 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m11:38:19.401240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m11:38:19.403716 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:38:19.404215 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m11:38:19.404434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:19.413060 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:38:19.413331 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:38:19.413797 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:38:19.416099 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m11:38:19.417152 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m11:38:19.417706 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m11:38:19.418115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_pipedrive_analytics)
[0m11:38:19.420499 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:38:19.420742 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m11:38:19.420909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:19.428661 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:38:19.428922 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:38:19.429158 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m11:38:19.431131 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m11:38:19.431987 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m11:38:19.432430 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m11:38:19.435944 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:19.436178 [debug] [MainThread]: On master: BEGIN
[0m11:38:19.436351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:19.444281 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:38:19.444530 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:19.444771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:38:19.447928 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:38:19.448882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7338e924-6b40-4282-9f8e-7c47543fe345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d52e0>]}
[0m11:38:19.449262 [debug] [MainThread]: On master: ROLLBACK
[0m11:38:19.449935 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:19.450133 [debug] [MainThread]: On master: BEGIN
[0m11:38:19.450922 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:38:19.451221 [debug] [MainThread]: On master: COMMIT
[0m11:38:19.451419 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:19.451587 [debug] [MainThread]: On master: COMMIT
[0m11:38:19.452206 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:19.452477 [debug] [MainThread]: On master: Close
[0m11:38:19.454828 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.deal_changes
[0m11:38:19.455310 [info ] [Thread-1  ]: 1 of 1 START sql table model staging.deal_changes .............................. [RUN]
[0m11:38:19.455630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.deal_changes)
[0m11:38:19.455854 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.deal_changes
[0m11:38:19.461753 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.deal_changes"
[0m11:38:19.462674 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.deal_changes
[0m11:38:19.487027 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.deal_changes"
[0m11:38:19.487606 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m11:38:19.487810 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: BEGIN
[0m11:38:19.487995 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:38:19.509913 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m11:38:19.510274 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m11:38:19.510540 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */

  
    

  create  table "postgres"."staging"."deal_changes__dbt_tmp"
  
  
    as
  
  (
    

select
  deal_id,
  change_time::timestamp as change_time,
  changed_field_key,
  new_value
from "postgres"."public"."deal_changes"
  );
  
[0m11:38:19.526772 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.016 seconds
[0m11:38:19.534294 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m11:38:19.534593 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
alter table "postgres"."staging"."deal_changes" rename to "deal_changes__dbt_backup"
[0m11:38:19.535606 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:19.537638 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m11:38:19.537898 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
alter table "postgres"."staging"."deal_changes__dbt_tmp" rename to "deal_changes"
[0m11:38:19.538694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:19.548533 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: COMMIT
[0m11:38:19.548808 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m11:38:19.549002 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: COMMIT
[0m11:38:19.551624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:38:19.555492 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."deal_changes__dbt_backup"
[0m11:38:19.557916 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m11:38:19.558131 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
drop table if exists "postgres"."staging"."deal_changes__dbt_backup" cascade
[0m11:38:19.560514 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:38:19.562075 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: Close
[0m11:38:19.563474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7338e924-6b40-4282-9f8e-7c47543fe345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799dbb0>]}
[0m11:38:19.563940 [info ] [Thread-1  ]: 1 of 1 OK created sql table model staging.deal_changes ......................... [[32mSELECT 15406[0m in 0.11s]
[0m11:38:19.564346 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.deal_changes
[0m11:38:19.565052 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:19.565242 [debug] [MainThread]: On master: BEGIN
[0m11:38:19.565400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:19.572886 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:38:19.573188 [debug] [MainThread]: On master: COMMIT
[0m11:38:19.573361 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:19.573519 [debug] [MainThread]: On master: COMMIT
[0m11:38:19.574033 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:19.574238 [debug] [MainThread]: On master: Close
[0m11:38:19.574496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:19.574647 [debug] [MainThread]: Connection 'model.enpal_assessment_project.deal_changes' was properly closed.
[0m11:38:19.574819 [info ] [MainThread]: 
[0m11:38:19.574991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m11:38:19.575365 [debug] [MainThread]: Command end result
[0m11:38:19.590280 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:38:19.591318 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:38:19.595905 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m11:38:19.596167 [info ] [MainThread]: 
[0m11:38:19.596408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:19.596582 [info ] [MainThread]: 
[0m11:38:19.596771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:38:19.598428 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.0140951, "process_in_blocks": "0", "process_kernel_time": 0.21491, "process_mem_max_rss": "131301376", "process_out_blocks": "0", "process_user_time": 1.379019}
[0m11:38:19.598693 [debug] [MainThread]: Command `dbt build` succeeded at 11:38:19.598641 after 1.01 seconds
[0m11:38:19.598915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035a17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102af0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cf1a30>]}
[0m11:38:19.599152 [debug] [MainThread]: Flushing usage events
[0m11:38:20.047121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:44.548259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b134f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b13310>]}


============================== 11:41:44.551545 | a0dd51c7-7367-471b-a831-412eb081cae4 ==============================
[0m11:41:44.551545 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:41:44.551897 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'target_path': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'indirect_selection': 'eager', 'empty': 'False', 'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt build -s activity', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m11:41:44.666991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0dd51c7-7367-471b-a831-412eb081cae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf4a30>]}
[0m11:41:44.702495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0dd51c7-7367-471b-a831-412eb081cae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118022940>]}
[0m11:41:44.703101 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:41:44.775890 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:41:44.859109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:44.859455 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/activity.sql
[0m11:41:45.039532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0dd51c7-7367-471b-a831-412eb081cae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183da670>]}
[0m11:41:45.089639 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:41:45.090892 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:41:45.108387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0dd51c7-7367-471b-a831-412eb081cae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189eb5e0>]}
[0m11:41:45.108695 [info ] [MainThread]: Found 8 models, 7 sources, 448 macros
[0m11:41:45.109448 [info ] [MainThread]: 
[0m11:41:45.109647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:45.109808 [info ] [MainThread]: 
[0m11:41:45.110065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:41:45.110501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:41:45.141942 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:41:45.142223 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:41:45.142387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:45.181962 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.040 seconds
[0m11:41:45.182878 [debug] [ThreadPool]: On list_postgres: Close
[0m11:41:45.186163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m11:41:45.190097 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:41:45.190297 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m11:41:45.190451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:45.201821 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m11:41:45.202048 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:41:45.202233 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:41:45.204549 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m11:41:45.205371 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m11:41:45.205842 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m11:41:45.206159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_pipedrive_analytics)
[0m11:41:45.207986 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:41:45.208670 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m11:41:45.208828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:45.216529 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:41:45.216763 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:41:45.216947 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m11:41:45.218984 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m11:41:45.219756 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m11:41:45.220208 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m11:41:45.220590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_ods)
[0m11:41:45.222087 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:41:45.222274 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m11:41:45.222429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:45.232077 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:41:45.232295 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:41:45.232476 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m11:41:45.237189 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m11:41:45.237937 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m11:41:45.238454 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m11:41:45.241818 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:45.242057 [debug] [MainThread]: On master: BEGIN
[0m11:41:45.242223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:45.249578 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:41:45.249830 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:45.250067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:41:45.255041 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m11:41:45.255987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0dd51c7-7367-471b-a831-412eb081cae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad29a0>]}
[0m11:41:45.256418 [debug] [MainThread]: On master: ROLLBACK
[0m11:41:45.257036 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:45.257264 [debug] [MainThread]: On master: BEGIN
[0m11:41:45.258888 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:41:45.259127 [debug] [MainThread]: On master: COMMIT
[0m11:41:45.259318 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:45.259487 [debug] [MainThread]: On master: COMMIT
[0m11:41:45.261417 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m11:41:45.261601 [debug] [MainThread]: On master: Close
[0m11:41:45.264038 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity
[0m11:41:45.264577 [info ] [Thread-1  ]: 1 of 1 START sql table model staging.activity .................................. [RUN]
[0m11:41:45.264920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_ods, now model.enpal_assessment_project.activity)
[0m11:41:45.265153 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity
[0m11:41:45.271693 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity"
[0m11:41:45.272235 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity
[0m11:41:45.295773 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity"
[0m11:41:45.296359 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m11:41:45.296561 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: BEGIN
[0m11:41:45.296738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:45.307756 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m11:41:45.308005 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m11:41:45.308217 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */

  
    

  create  table "postgres"."staging"."activity__dbt_tmp"
  
  
    as
  
  (
    

 select 
 activity_id,
 type,
 assigned_to_user,
 deal_id,
 done,
 due_to::timestamp as due_to
 from "postgres"."public"."activity"
  );
  
[0m11:41:45.315589 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.007 seconds
[0m11:41:45.322542 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m11:41:45.322782 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */
alter table "postgres"."staging"."activity" rename to "activity__dbt_backup"
[0m11:41:45.323531 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:45.325590 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m11:41:45.325889 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */
alter table "postgres"."staging"."activity__dbt_tmp" rename to "activity"
[0m11:41:45.326535 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:41:45.336396 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: COMMIT
[0m11:41:45.336647 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m11:41:45.336840 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: COMMIT
[0m11:41:45.338289 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:41:45.342078 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."activity__dbt_backup"
[0m11:41:45.344485 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m11:41:45.344704 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */
drop table if exists "postgres"."staging"."activity__dbt_backup" cascade
[0m11:41:45.348511 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:41:45.349937 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: Close
[0m11:41:45.351282 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0dd51c7-7367-471b-a831-412eb081cae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11979dbb0>]}
[0m11:41:45.351753 [info ] [Thread-1  ]: 1 of 1 OK created sql table model staging.activity ............................. [[32mSELECT 4579[0m in 0.09s]
[0m11:41:45.352099 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity
[0m11:41:45.352720 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:45.352887 [debug] [MainThread]: On master: BEGIN
[0m11:41:45.353033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:45.361943 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:41:45.362238 [debug] [MainThread]: On master: COMMIT
[0m11:41:45.362425 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:45.362579 [debug] [MainThread]: On master: COMMIT
[0m11:41:45.363019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:41:45.363185 [debug] [MainThread]: On master: Close
[0m11:41:45.363445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:45.363601 [debug] [MainThread]: Connection 'model.enpal_assessment_project.activity' was properly closed.
[0m11:41:45.363782 [info ] [MainThread]: 
[0m11:41:45.363965 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m11:41:45.364353 [debug] [MainThread]: Command end result
[0m11:41:45.380672 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:41:45.381986 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:41:45.386215 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m11:41:45.386411 [info ] [MainThread]: 
[0m11:41:45.386640 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:45.386808 [info ] [MainThread]: 
[0m11:41:45.387010 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:41:45.388125 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8860923, "process_in_blocks": "0", "process_kernel_time": 0.17316, "process_mem_max_rss": "130760704", "process_out_blocks": "0", "process_user_time": 1.373555}
[0m11:41:45.388394 [debug] [MainThread]: Command `dbt build` succeeded at 11:41:45.388340 after 0.89 seconds
[0m11:41:45.388612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180224c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b9f1c0>]}
[0m11:41:45.388818 [debug] [MainThread]: Flushing usage events
[0m11:41:45.818731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:28.465589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082774f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108277310>]}


============================== 11:42:28.468605 | 2f64b535-11f0-40da-92de-7bab602a9ace ==============================
[0m11:42:28.468605 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:42:28.468938 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt build -s activity_types', 'quiet': 'False', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment'}
[0m11:42:28.579785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f64b535-11f0-40da-92de-7bab602a9ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105948a30>]}
[0m11:42:28.615807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f64b535-11f0-40da-92de-7bab602a9ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108786940>]}
[0m11:42:28.616854 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:42:28.691255 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:42:28.771971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:42:28.772346 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/activity_types.sql
[0m11:42:28.952388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f64b535-11f0-40da-92de-7bab602a9ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934f6d0>]}
[0m11:42:29.002204 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:42:29.003467 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:42:29.020210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f64b535-11f0-40da-92de-7bab602a9ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ff490>]}
[0m11:42:29.020524 [info ] [MainThread]: Found 8 models, 7 sources, 448 macros
[0m11:42:29.021285 [info ] [MainThread]: 
[0m11:42:29.021479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:29.021639 [info ] [MainThread]: 
[0m11:42:29.021902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:42:29.022357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:42:29.050939 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:42:29.051226 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:42:29.051393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:29.083526 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.032 seconds
[0m11:42:29.084335 [debug] [ThreadPool]: On list_postgres: Close
[0m11:42:29.087403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m11:42:29.091225 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:42:29.091428 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m11:42:29.091599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:29.102203 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m11:42:29.102443 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:42:29.102638 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m11:42:29.104649 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:29.105424 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m11:42:29.105866 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m11:42:29.106180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m11:42:29.107941 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:42:29.108288 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m11:42:29.108449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:29.115702 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:42:29.115928 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:42:29.116145 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:42:29.118296 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m11:42:29.119097 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m11:42:29.120082 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m11:42:29.120394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_pipedrive_analytics)
[0m11:42:29.122225 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:42:29.122407 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m11:42:29.122561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:29.136643 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m11:42:29.136977 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:42:29.137177 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m11:42:29.139747 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:29.140608 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m11:42:29.141045 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m11:42:29.144511 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:29.144755 [debug] [MainThread]: On master: BEGIN
[0m11:42:29.144926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:29.151849 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:42:29.152103 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:29.152338 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:42:29.154401 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:42:29.155130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f64b535-11f0-40da-92de-7bab602a9ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873feb0>]}
[0m11:42:29.155422 [debug] [MainThread]: On master: ROLLBACK
[0m11:42:29.155862 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:29.156044 [debug] [MainThread]: On master: BEGIN
[0m11:42:29.156736 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:42:29.156922 [debug] [MainThread]: On master: COMMIT
[0m11:42:29.157094 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:29.157254 [debug] [MainThread]: On master: COMMIT
[0m11:42:29.157675 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:42:29.157854 [debug] [MainThread]: On master: Close
[0m11:42:29.159620 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m11:42:29.159974 [info ] [Thread-1  ]: 1 of 1 START sql table model staging.activity_types ............................ [RUN]
[0m11:42:29.160270 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.activity_types)
[0m11:42:29.160483 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m11:42:29.166008 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m11:42:29.166826 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m11:42:29.190976 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m11:42:29.191630 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m11:42:29.191836 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m11:42:29.192017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:42:29.201040 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m11:42:29.201350 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m11:42:29.201565 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id,
 name,
 active,
 typee from "postgres"."public"."activity_types"
  );
  
[0m11:42:29.202383 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "typee" does not exist
LINE 18:  typee from "postgres"."public"."activity_types"
          ^
HINT:  Perhaps you meant to reference the column "activity_types.type".

[0m11:42:29.202639 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: ROLLBACK
[0m11:42:29.203286 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m11:42:29.219121 [debug] [Thread-1  ]: Database Error in model activity_types (models/staging/activity_types.sql)
  column "typee" does not exist
  LINE 18:  typee from "postgres"."public"."activity_types"
            ^
  HINT:  Perhaps you meant to reference the column "activity_types.type".
  compiled code at target/run/enpal_assessment_project/models/staging/activity_types.sql
[0m11:42:29.220412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f64b535-11f0-40da-92de-7bab602a9ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ca8b0>]}
[0m11:42:29.220827 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model staging.activity_types ................... [[31mERROR[0m in 0.06s]
[0m11:42:29.221158 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m11:42:29.221464 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.activity_types' to be skipped because of status 'error'.  Reason: Database Error in model activity_types (models/staging/activity_types.sql)
  column "typee" does not exist
  LINE 18:  typee from "postgres"."public"."activity_types"
            ^
  HINT:  Perhaps you meant to reference the column "activity_types.type".
  compiled code at target/run/enpal_assessment_project/models/staging/activity_types.sql.
[0m11:42:29.222069 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:29.222250 [debug] [MainThread]: On master: BEGIN
[0m11:42:29.222396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:29.235203 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:42:29.235536 [debug] [MainThread]: On master: COMMIT
[0m11:42:29.235744 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:29.235904 [debug] [MainThread]: On master: COMMIT
[0m11:42:29.236325 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:42:29.236492 [debug] [MainThread]: On master: Close
[0m11:42:29.236753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:29.236905 [debug] [MainThread]: Connection 'model.enpal_assessment_project.activity_types' was properly closed.
[0m11:42:29.237080 [info ] [MainThread]: 
[0m11:42:29.237261 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m11:42:29.237725 [debug] [MainThread]: Command end result
[0m11:42:29.254920 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:42:29.256184 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:42:29.260189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m11:42:29.260379 [info ] [MainThread]: 
[0m11:42:29.260600 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:42:29.260776 [info ] [MainThread]: 
[0m11:42:29.260984 [error] [MainThread]: [31mFailure in model activity_types (models/staging/activity_types.sql)[0m
[0m11:42:29.261187 [error] [MainThread]:   Database Error in model activity_types (models/staging/activity_types.sql)
  column "typee" does not exist
  LINE 18:  typee from "postgres"."public"."activity_types"
            ^
  HINT:  Perhaps you meant to reference the column "activity_types.type".
  compiled code at target/run/enpal_assessment_project/models/staging/activity_types.sql
[0m11:42:29.261346 [info ] [MainThread]: 
[0m11:42:29.261532 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/activity_types.sql
[0m11:42:29.261686 [info ] [MainThread]: 
[0m11:42:29.261857 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:42:29.262916 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8398729, "process_in_blocks": "0", "process_kernel_time": 0.159647, "process_mem_max_rss": "130596864", "process_out_blocks": "0", "process_user_time": 1.362098}
[0m11:42:29.263138 [debug] [MainThread]: Command `dbt build` failed at 11:42:29.263090 after 0.84 seconds
[0m11:42:29.263403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b47790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0a250>]}
[0m11:42:29.263667 [debug] [MainThread]: Flushing usage events
[0m11:42:29.708535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:38.080537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830b280>]}


============================== 11:42:38.083367 | 0794e780-dec6-4ae1-b6f8-d541606fded6 ==============================
[0m11:42:38.083367 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:42:38.083707 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'warn_error': 'None', 'invocation_command': 'dbt build -s activity_types', 'indirect_selection': 'eager', 'fail_fast': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False'}
[0m11:42:38.183127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0794e780-dec6-4ae1-b6f8-d541606fded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ea460>]}
[0m11:42:38.218631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0794e780-dec6-4ae1-b6f8-d541606fded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e71c0>]}
[0m11:42:38.219122 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:42:38.288007 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:42:38.362211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:42:38.362572 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/activity_types.sql
[0m11:42:38.539831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0794e780-dec6-4ae1-b6f8-d541606fded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b83580>]}
[0m11:42:38.589035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:42:38.590112 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:42:38.602336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0794e780-dec6-4ae1-b6f8-d541606fded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10933a490>]}
[0m11:42:38.602624 [info ] [MainThread]: Found 8 models, 7 sources, 448 macros
[0m11:42:38.603375 [info ] [MainThread]: 
[0m11:42:38.603571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:38.603731 [info ] [MainThread]: 
[0m11:42:38.603999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:42:38.604461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:42:38.630548 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:42:38.630825 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:42:38.630985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:38.650885 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m11:42:38.651625 [debug] [ThreadPool]: On list_postgres: Close
[0m11:42:38.654710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m11:42:38.658534 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:42:38.658736 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m11:42:38.658893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:38.669947 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m11:42:38.670187 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:42:38.670523 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:42:38.672941 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m11:42:38.673854 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m11:42:38.674427 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m11:42:38.674828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m11:42:38.677376 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:42:38.677637 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m11:42:38.677799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:38.686265 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:42:38.686557 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:42:38.686748 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m11:42:38.688832 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:38.689615 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m11:42:38.690099 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m11:42:38.690444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m11:42:38.691918 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:42:38.692113 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m11:42:38.692266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:38.700901 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:42:38.701152 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:42:38.701364 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m11:42:38.703843 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:38.704624 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m11:42:38.705056 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m11:42:38.708214 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:38.708443 [debug] [MainThread]: On master: BEGIN
[0m11:42:38.708608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:38.715578 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:42:38.715838 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:38.716070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:42:38.719269 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:42:38.719936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0794e780-dec6-4ae1-b6f8-d541606fded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf7310>]}
[0m11:42:38.720215 [debug] [MainThread]: On master: ROLLBACK
[0m11:42:38.720669 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:38.720827 [debug] [MainThread]: On master: BEGIN
[0m11:42:38.721496 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:42:38.721675 [debug] [MainThread]: On master: COMMIT
[0m11:42:38.721843 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:38.721999 [debug] [MainThread]: On master: COMMIT
[0m11:42:38.722424 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:42:38.722589 [debug] [MainThread]: On master: Close
[0m11:42:38.723879 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m11:42:38.724227 [info ] [Thread-1  ]: 1 of 1 START sql table model staging.activity_types ............................ [RUN]
[0m11:42:38.724504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.activity_types)
[0m11:42:38.724708 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m11:42:38.729917 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m11:42:38.730388 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m11:42:38.754521 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m11:42:38.755205 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m11:42:38.755419 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m11:42:38.755601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:42:38.767698 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m11:42:38.767921 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m11:42:38.768121 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id,
 name,
 active,
 type from "postgres"."public"."activity_types"
  );
  
[0m11:42:38.770110 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m11:42:38.776933 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m11:42:38.777176 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types" rename to "activity_types__dbt_backup"
[0m11:42:38.778495 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:42:38.780252 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m11:42:38.780511 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m11:42:38.781559 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:42:38.790919 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m11:42:38.791136 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m11:42:38.791318 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m11:42:38.794222 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m11:42:38.797940 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."activity_types__dbt_backup"
[0m11:42:38.800417 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m11:42:38.800653 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."staging"."activity_types__dbt_backup" cascade
[0m11:42:38.803276 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:42:38.804864 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m11:42:38.806295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0794e780-dec6-4ae1-b6f8-d541606fded6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996ebe0>]}
[0m11:42:38.806700 [info ] [Thread-1  ]: 1 of 1 OK created sql table model staging.activity_types ....................... [[32mSELECT 4[0m in 0.08s]
[0m11:42:38.807027 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m11:42:38.807644 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:38.807813 [debug] [MainThread]: On master: BEGIN
[0m11:42:38.807962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:38.816649 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:42:38.816999 [debug] [MainThread]: On master: COMMIT
[0m11:42:38.817223 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:38.817389 [debug] [MainThread]: On master: COMMIT
[0m11:42:38.817808 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:42:38.817998 [debug] [MainThread]: On master: Close
[0m11:42:38.818265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:38.818426 [debug] [MainThread]: Connection 'model.enpal_assessment_project.activity_types' was properly closed.
[0m11:42:38.818616 [info ] [MainThread]: 
[0m11:42:38.818796 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m11:42:38.819199 [debug] [MainThread]: Command end result
[0m11:42:38.834247 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:42:38.835409 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:42:38.839646 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m11:42:38.839882 [info ] [MainThread]: 
[0m11:42:38.840106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:38.840268 [info ] [MainThread]: 
[0m11:42:38.840440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:42:38.841467 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.80263036, "process_in_blocks": "0", "process_kernel_time": 0.141145, "process_mem_max_rss": "133578752", "process_out_blocks": "0", "process_user_time": 1.379993}
[0m11:42:38.841687 [debug] [MainThread]: Command `dbt build` succeeded at 11:42:38.841641 after 0.80 seconds
[0m11:42:38.841900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b827c0>]}
[0m11:42:38.842101 [debug] [MainThread]: Flushing usage events
[0m11:42:39.275394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:39.172618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10305b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040db610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040db430>]}


============================== 11:43:39.174991 | afbde23f-11ec-41d8-a44b-dee3f12e7d5f ==============================
[0m11:43:39.174991 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:43:39.175334 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'quiet': 'False', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt build -s fields', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:43:39.275869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afbde23f-11ec-41d8-a44b-dee3f12e7d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039943d0>]}
[0m11:43:39.312478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afbde23f-11ec-41d8-a44b-dee3f12e7d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103efff10>]}
[0m11:43:39.313071 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:43:39.382615 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:43:39.456327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:43:39.456698 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/fields.sql
[0m11:43:39.636900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afbde23f-11ec-41d8-a44b-dee3f12e7d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105148f40>]}
[0m11:43:39.686240 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:43:39.687273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:43:39.699434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afbde23f-11ec-41d8-a44b-dee3f12e7d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510d0a0>]}
[0m11:43:39.699729 [info ] [MainThread]: Found 8 models, 7 sources, 448 macros
[0m11:43:39.700477 [info ] [MainThread]: 
[0m11:43:39.700693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:39.700859 [info ] [MainThread]: 
[0m11:43:39.701116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:39.701552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:43:39.726938 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:43:39.727228 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:43:39.727393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:39.748793 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.021 seconds
[0m11:43:39.749596 [debug] [ThreadPool]: On list_postgres: Close
[0m11:43:39.752712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m11:43:39.756600 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:43:39.756804 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m11:43:39.756966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:39.767356 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:43:39.767555 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m11:43:39.767736 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m11:43:39.769611 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:39.770398 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m11:43:39.770875 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m11:43:39.771186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m11:43:39.773077 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:43:39.773280 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m11:43:39.773426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:39.780463 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:43:39.780695 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m11:43:39.780894 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m11:43:39.783355 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m11:43:39.784173 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m11:43:39.784616 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m11:43:39.785013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m11:43:39.786928 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:43:39.787126 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m11:43:39.787282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:39.794597 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:43:39.794839 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m11:43:39.795024 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m11:43:39.796898 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:39.797623 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m11:43:39.798067 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m11:43:39.801225 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:39.801448 [debug] [MainThread]: On master: BEGIN
[0m11:43:39.801606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:39.808850 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:43:39.809087 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:39.809311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:43:39.811524 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:43:39.812232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afbde23f-11ec-41d8-a44b-dee3f12e7d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dbfa0>]}
[0m11:43:39.812520 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:39.812956 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:39.813146 [debug] [MainThread]: On master: BEGIN
[0m11:43:39.813783 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:43:39.813958 [debug] [MainThread]: On master: COMMIT
[0m11:43:39.814120 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:39.814271 [debug] [MainThread]: On master: COMMIT
[0m11:43:39.814673 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:43:39.814852 [debug] [MainThread]: On master: Close
[0m11:43:39.816199 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.fields
[0m11:43:39.816567 [info ] [Thread-1  ]: 1 of 1 START sql table model staging.fields .................................... [RUN]
[0m11:43:39.816850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_ods, now model.enpal_assessment_project.fields)
[0m11:43:39.817053 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.fields
[0m11:43:39.822276 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.fields"
[0m11:43:39.823021 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.fields
[0m11:43:39.846906 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.fields"
[0m11:43:39.847584 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m11:43:39.847782 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: BEGIN
[0m11:43:39.847960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:39.859766 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m11:43:39.859990 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m11:43:39.860204 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */

  
    

  create  table "postgres"."staging"."fields__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as field_id,
 field_key as field_key,
 name as field_name,
 field_value_options
  from "postgres"."public"."fields"
  );
  
[0m11:43:39.862224 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m11:43:39.869085 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m11:43:39.869325 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */
alter table "postgres"."staging"."fields" rename to "fields__dbt_backup"
[0m11:43:39.869973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:43:39.871739 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m11:43:39.871940 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */
alter table "postgres"."staging"."fields__dbt_tmp" rename to "fields"
[0m11:43:39.873123 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:39.882458 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: COMMIT
[0m11:43:39.882669 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m11:43:39.882849 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: COMMIT
[0m11:43:39.885851 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m11:43:39.889493 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."fields__dbt_backup"
[0m11:43:39.891830 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m11:43:39.892032 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */
drop table if exists "postgres"."staging"."fields__dbt_backup" cascade
[0m11:43:39.896445 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:43:39.897844 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: Close
[0m11:43:39.898897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afbde23f-11ec-41d8-a44b-dee3f12e7d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105744c40>]}
[0m11:43:39.899274 [info ] [Thread-1  ]: 1 of 1 OK created sql table model staging.fields ............................... [[32mSELECT 4[0m in 0.08s]
[0m11:43:39.899593 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.fields
[0m11:43:39.900253 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:39.900436 [debug] [MainThread]: On master: BEGIN
[0m11:43:39.900592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:39.909941 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:43:39.910274 [debug] [MainThread]: On master: COMMIT
[0m11:43:39.910465 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:39.910622 [debug] [MainThread]: On master: COMMIT
[0m11:43:39.911183 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:43:39.911452 [debug] [MainThread]: On master: Close
[0m11:43:39.911738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:39.911911 [debug] [MainThread]: Connection 'model.enpal_assessment_project.fields' was properly closed.
[0m11:43:39.912103 [info ] [MainThread]: 
[0m11:43:39.912289 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m11:43:39.912696 [debug] [MainThread]: Command end result
[0m11:43:39.928972 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m11:43:39.930233 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:43:39.934181 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m11:43:39.934370 [info ] [MainThread]: 
[0m11:43:39.934604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:39.934771 [info ] [MainThread]: 
[0m11:43:39.935008 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:43:39.936016 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8052708, "process_in_blocks": "0", "process_kernel_time": 0.139876, "process_mem_max_rss": "131416064", "process_out_blocks": "0", "process_user_time": 1.370954}
[0m11:43:39.936242 [debug] [MainThread]: Command `dbt build` succeeded at 11:43:39.936192 after 0.81 seconds
[0m11:43:39.936447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10305b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1001b71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103305a90>]}
[0m11:43:39.936653 [debug] [MainThread]: Flushing usage events
[0m11:43:40.356513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:55.058968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f50490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f502b0>]}


============================== 12:10:55.062284 | a706a98b-9744-44b6-9656-0cb4ed90a436 ==============================
[0m12:10:55.062284 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:10:55.062626 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run'}
[0m12:10:55.178079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111407700>]}
[0m12:10:55.213945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162e1f0>]}
[0m12:10:55.214547 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:10:55.286051 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:10:55.372084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m12:10:55.372493 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stages.sql
[0m12:10:55.372716 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/users.sql
[0m12:10:55.372925 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/deal_changes.sql
[0m12:10:55.373127 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/activity.sql
[0m12:10:55.373327 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/activity_types.sql
[0m12:10:55.560659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164c250>]}
[0m12:10:55.610593 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:10:55.612122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:10:55.623778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ecaf40>]}
[0m12:10:55.624083 [info ] [MainThread]: Found 8 models, 7 sources, 448 macros
[0m12:10:55.624278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285ca90>]}
[0m12:10:55.625219 [info ] [MainThread]: 
[0m12:10:55.625415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:55.625574 [info ] [MainThread]: 
[0m12:10:55.625845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:10:55.628557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:10:55.660073 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:10:55.660335 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:10:55.660494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:55.774544 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.114 seconds
[0m12:10:55.775650 [debug] [ThreadPool]: On list_postgres: Close
[0m12:10:55.777741 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:10:55.778050 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:10:55.778288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:55.789854 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m12:10:55.790837 [debug] [ThreadPool]: On list_postgres: Close
[0m12:10:55.792655 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:10:55.792933 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:10:55.793167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:55.802279 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m12:10:55.803205 [debug] [ThreadPool]: On list_postgres: Close
[0m12:10:55.804359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m12:10:55.808635 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m12:10:55.808919 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m12:10:55.809117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:55.818721 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:10:55.819013 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m12:10:55.819230 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m12:10:55.824603 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m12:10:55.825476 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m12:10:55.826060 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m12:10:55.826433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m12:10:55.828272 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m12:10:55.828519 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m12:10:55.828703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:55.840539 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:10:55.840859 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m12:10:55.841085 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m12:10:55.843452 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:10:55.844579 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m12:10:55.845168 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m12:10:55.845588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m12:10:55.848340 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:10:55.848617 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m12:10:55.848806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:55.857636 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:10:55.857987 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:10:55.858382 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m12:10:55.860768 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m12:10:55.861894 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m12:10:55.862551 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m12:10:55.866983 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:55.867285 [debug] [MainThread]: On master: BEGIN
[0m12:10:55.867474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:55.876209 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:10:55.876504 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:55.876765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:10:55.879714 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:10:55.880551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d13430>]}
[0m12:10:55.880883 [debug] [MainThread]: On master: ROLLBACK
[0m12:10:55.881435 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:55.881631 [debug] [MainThread]: On master: BEGIN
[0m12:10:55.882560 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:10:55.882804 [debug] [MainThread]: On master: COMMIT
[0m12:10:55.882999 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:55.883176 [debug] [MainThread]: On master: COMMIT
[0m12:10:55.883669 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:10:55.883901 [debug] [MainThread]: On master: Close
[0m12:10:55.885936 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity
[0m12:10:55.886389 [info ] [Thread-1  ]: 1 of 8 START sql table model staging.activity .................................. [RUN]
[0m12:10:55.886747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.activity)
[0m12:10:55.887000 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity
[0m12:10:55.893027 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity"
[0m12:10:55.893997 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity
[0m12:10:55.918290 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity"
[0m12:10:55.919091 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m12:10:55.919316 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: BEGIN
[0m12:10:55.919504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:55.930983 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:10:55.931488 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m12:10:55.931705 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */

  
    

  create  table "postgres"."staging"."activity__dbt_tmp"
  
  
    as
  
  (
    

 select 
 activity_id,
 type as activity_type,
 assigned_to_user,
 deal_id,
 done,
 due_to::timestamp as due_to
 from "postgres"."public"."activity"
  );
  
[0m12:10:55.936695 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.005 seconds
[0m12:10:55.942929 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m12:10:55.943168 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */
alter table "postgres"."staging"."activity" rename to "activity__dbt_backup"
[0m12:10:55.944039 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:10:55.946593 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m12:10:55.946809 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */
alter table "postgres"."staging"."activity__dbt_tmp" rename to "activity"
[0m12:10:55.947424 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:55.957545 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: COMMIT
[0m12:10:55.957880 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m12:10:55.958078 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: COMMIT
[0m12:10:55.961574 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m12:10:55.966000 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."activity__dbt_backup"
[0m12:10:55.968640 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity"
[0m12:10:55.968886 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity"} */
drop table if exists "postgres"."staging"."activity__dbt_backup" cascade
[0m12:10:55.973795 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m12:10:55.976182 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity: Close
[0m12:10:55.977658 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a34220>]}
[0m12:10:55.978280 [info ] [Thread-1  ]: 1 of 8 OK created sql table model staging.activity ............................. [[32mSELECT 4579[0m in 0.09s]
[0m12:10:55.978729 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity
[0m12:10:55.979002 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.activity_types
[0m12:10:55.979375 [info ] [Thread-1  ]: 2 of 8 START sql table model staging.activity_types ............................ [RUN]
[0m12:10:55.979708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity, now model.enpal_assessment_project.activity_types)
[0m12:10:55.979925 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.activity_types
[0m12:10:55.982213 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.activity_types"
[0m12:10:55.983767 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.activity_types
[0m12:10:55.986206 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.activity_types"
[0m12:10:55.987038 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m12:10:55.987299 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: BEGIN
[0m12:10:55.987482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:55.999441 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m12:10:55.999817 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m12:10:56.000083 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */

  
    

  create  table "postgres"."staging"."activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as activity_type_id,
 name as activity_name,
 active,
 type as activity_type from "postgres"."public"."activity_types"
  );
  
[0m12:10:56.001603 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m12:10:56.004245 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m12:10:56.004495 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types" rename to "activity_types__dbt_backup"
[0m12:10:56.005262 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:10:56.007662 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m12:10:56.008030 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
alter table "postgres"."staging"."activity_types__dbt_tmp" rename to "activity_types"
[0m12:10:56.008862 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:56.009824 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m12:10:56.010087 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m12:10:56.010302 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: COMMIT
[0m12:10:56.011545 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m12:10:56.014058 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."activity_types__dbt_backup"
[0m12:10:56.014445 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.activity_types"
[0m12:10:56.014650 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.activity_types"} */
drop table if exists "postgres"."staging"."activity_types__dbt_backup" cascade
[0m12:10:56.017419 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m12:10:56.018364 [debug] [Thread-1  ]: On model.enpal_assessment_project.activity_types: Close
[0m12:10:56.018807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a7be0>]}
[0m12:10:56.019265 [info ] [Thread-1  ]: 2 of 8 OK created sql table model staging.activity_types ....................... [[32mSELECT 4[0m in 0.04s]
[0m12:10:56.019602 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.activity_types
[0m12:10:56.019829 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.deal_changes
[0m12:10:56.020221 [info ] [Thread-1  ]: 3 of 8 START sql table model staging.deal_changes .............................. [RUN]
[0m12:10:56.020653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.activity_types, now model.enpal_assessment_project.deal_changes)
[0m12:10:56.020883 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.deal_changes
[0m12:10:56.022968 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.deal_changes"
[0m12:10:56.024023 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.deal_changes
[0m12:10:56.026415 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.deal_changes"
[0m12:10:56.027210 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m12:10:56.027482 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: BEGIN
[0m12:10:56.027677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:56.039537 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m12:10:56.039846 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m12:10:56.040070 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */

  
    

  create  table "postgres"."staging"."deal_changes__dbt_tmp"
  
  
    as
  
  (
    

select
  deal_id,
  change_time::timestamp as change_time_at,
  changed_field_key,
  new_value
from "postgres"."public"."deal_changes"
  );
  
[0m12:10:56.049685 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.009 seconds
[0m12:10:56.052284 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m12:10:56.052542 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
alter table "postgres"."staging"."deal_changes" rename to "deal_changes__dbt_backup"
[0m12:10:56.053329 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:10:56.055253 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m12:10:56.055477 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
alter table "postgres"."staging"."deal_changes__dbt_tmp" rename to "deal_changes"
[0m12:10:56.056023 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:56.056819 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: COMMIT
[0m12:10:56.057041 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m12:10:56.057239 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: COMMIT
[0m12:10:56.059621 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:10:56.061255 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."deal_changes__dbt_backup"
[0m12:10:56.061592 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deal_changes"
[0m12:10:56.061798 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deal_changes"} */
drop table if exists "postgres"."staging"."deal_changes__dbt_backup" cascade
[0m12:10:56.063308 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m12:10:56.064108 [debug] [Thread-1  ]: On model.enpal_assessment_project.deal_changes: Close
[0m12:10:56.064490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b7be20>]}
[0m12:10:56.064945 [info ] [Thread-1  ]: 3 of 8 OK created sql table model staging.deal_changes ......................... [[32mSELECT 15406[0m in 0.04s]
[0m12:10:56.065343 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.deal_changes
[0m12:10:56.065583 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.fields
[0m12:10:56.065888 [info ] [Thread-1  ]: 4 of 8 START sql table model staging.fields .................................... [RUN]
[0m12:10:56.066168 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.deal_changes, now model.enpal_assessment_project.fields)
[0m12:10:56.066391 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.fields
[0m12:10:56.068524 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.fields"
[0m12:10:56.069149 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.fields
[0m12:10:56.072476 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.fields"
[0m12:10:56.072920 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m12:10:56.073116 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: BEGIN
[0m12:10:56.073297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:56.080677 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m12:10:56.080983 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m12:10:56.081202 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */

  
    

  create  table "postgres"."staging"."fields__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as field_id,
 field_key as field_key,
 name as field_name,
 field_value_options
  from "postgres"."public"."fields"
  );
  
[0m12:10:56.083202 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m12:10:56.085501 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m12:10:56.085727 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */
alter table "postgres"."staging"."fields" rename to "fields__dbt_backup"
[0m12:10:56.086378 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:56.088292 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m12:10:56.088507 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */
alter table "postgres"."staging"."fields__dbt_tmp" rename to "fields"
[0m12:10:56.089077 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:56.089814 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: COMMIT
[0m12:10:56.090023 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m12:10:56.090211 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: COMMIT
[0m12:10:56.091030 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m12:10:56.092630 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."fields__dbt_backup"
[0m12:10:56.092964 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.fields"
[0m12:10:56.093167 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.fields"} */
drop table if exists "postgres"."staging"."fields__dbt_backup" cascade
[0m12:10:56.094621 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m12:10:56.095393 [debug] [Thread-1  ]: On model.enpal_assessment_project.fields: Close
[0m12:10:56.095770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b60820>]}
[0m12:10:56.096158 [info ] [Thread-1  ]: 4 of 8 OK created sql table model staging.fields ............................... [[32mSELECT 4[0m in 0.03s]
[0m12:10:56.096478 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.fields
[0m12:10:56.096699 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stages
[0m12:10:56.097021 [info ] [Thread-1  ]: 5 of 8 START sql table model staging.stages .................................... [RUN]
[0m12:10:56.097283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.fields, now model.enpal_assessment_project.stages)
[0m12:10:56.097487 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stages
[0m12:10:56.099512 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stages"
[0m12:10:56.100326 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stages
[0m12:10:56.102498 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stages"
[0m12:10:56.102865 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m12:10:56.103062 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: BEGIN
[0m12:10:56.103246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:56.116983 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m12:10:56.117399 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m12:10:56.117684 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stages"} */

  
    

  create  table "postgres"."staging"."stages__dbt_tmp"
  
  
    as
  
  (
    

 select 
 stage_id,
 stage_name
  from "postgres"."public"."stages"
  );
  
[0m12:10:56.119383 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.001 seconds
[0m12:10:56.122846 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m12:10:56.123154 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stages"} */
alter table "postgres"."staging"."stages" rename to "stages__dbt_backup"
[0m12:10:56.124256 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:10:56.126221 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m12:10:56.126436 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stages"} */
alter table "postgres"."staging"."stages__dbt_tmp" rename to "stages"
[0m12:10:56.127117 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:56.128187 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: COMMIT
[0m12:10:56.128459 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m12:10:56.128676 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: COMMIT
[0m12:10:56.131355 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:10:56.133158 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stages__dbt_backup"
[0m12:10:56.133533 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stages"
[0m12:10:56.133730 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stages"} */
drop table if exists "postgres"."staging"."stages__dbt_backup" cascade
[0m12:10:56.139403 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m12:10:56.140220 [debug] [Thread-1  ]: On model.enpal_assessment_project.stages: Close
[0m12:10:56.140608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b60820>]}
[0m12:10:56.140998 [info ] [Thread-1  ]: 5 of 8 OK created sql table model staging.stages ............................... [[32mSELECT 9[0m in 0.04s]
[0m12:10:56.141323 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stages
[0m12:10:56.141549 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m12:10:56.141857 [info ] [Thread-1  ]: 6 of 8 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m12:10:56.142128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stages, now model.enpal_assessment_project.test_model)
[0m12:10:56.142331 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m12:10:56.144265 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m12:10:56.145125 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m12:10:56.147246 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m12:10:56.147748 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:10:56.147944 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m12:10:56.148119 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:56.158368 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m12:10:56.158696 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:10:56.158906 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m12:10:56.162440 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m12:10:56.164635 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:10:56.164860 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m12:10:56.165442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:56.167308 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:10:56.167536 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m12:10:56.168081 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:56.168824 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m12:10:56.169032 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:10:56.169216 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m12:10:56.170318 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m12:10:56.172670 [debug] [Thread-1  ]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m12:10:56.172995 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:10:56.173195 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m12:10:56.174489 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m12:10:56.175243 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m12:10:56.175604 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c05a90>]}
[0m12:10:56.175996 [info ] [Thread-1  ]: 6 of 8 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 4579[0m in 0.03s]
[0m12:10:56.176318 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m12:10:56.176537 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.users
[0m12:10:56.176827 [info ] [Thread-1  ]: 7 of 8 START sql table model staging.users ..................................... [RUN]
[0m12:10:56.177072 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now model.enpal_assessment_project.users)
[0m12:10:56.177263 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.users
[0m12:10:56.179255 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.users"
[0m12:10:56.179721 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.users
[0m12:10:56.181897 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.users"
[0m12:10:56.182307 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m12:10:56.182546 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: BEGIN
[0m12:10:56.182773 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:56.194653 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m12:10:56.194962 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m12:10:56.195203 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.users"} */

  
    

  create  table "postgres"."staging"."users__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as user_id,
 name as user_name,
 email as user_email,
 modified as modified_at
 from "postgres"."public"."users"
  );
  
[0m12:10:56.197944 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.003 seconds
[0m12:10:56.200161 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m12:10:56.200394 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.users"} */
alter table "postgres"."staging"."users" rename to "users__dbt_backup"
[0m12:10:56.201065 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:56.203032 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m12:10:56.203253 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.users"} */
alter table "postgres"."staging"."users__dbt_tmp" rename to "users"
[0m12:10:56.203798 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:10:56.204515 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: COMMIT
[0m12:10:56.204713 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m12:10:56.204895 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: COMMIT
[0m12:10:56.205918 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m12:10:56.207432 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."users__dbt_backup"
[0m12:10:56.207742 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.users"
[0m12:10:56.207934 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.users"} */
drop table if exists "postgres"."staging"."users__dbt_backup" cascade
[0m12:10:56.212240 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m12:10:56.213033 [debug] [Thread-1  ]: On model.enpal_assessment_project.users: Close
[0m12:10:56.213403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b63220>]}
[0m12:10:56.213805 [info ] [Thread-1  ]: 7 of 8 OK created sql table model staging.users ................................ [[32mSELECT 1787[0m in 0.04s]
[0m12:10:56.214140 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.users
[0m12:10:56.214371 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal
[0m12:10:56.214711 [info ] [Thread-1  ]: 8 of 8 START sql table model ods.ods_deal ...................................... [RUN]
[0m12:10:56.215026 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.users, now model.enpal_assessment_project.ods_deal)
[0m12:10:56.215251 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal
[0m12:10:56.217329 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal"
[0m12:10:56.218061 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal
[0m12:10:56.221233 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal"
[0m12:10:56.221739 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m12:10:56.221941 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: BEGIN
[0m12:10:56.222122 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:56.231703 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m12:10:56.232013 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m12:10:56.232279 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */

  
    

  create  table "postgres"."ods"."ods_deal__dbt_tmp"
  
  
    as
  
  (
    

 select * from "postgres"."staging"."activity_types"
  );
  
[0m12:10:56.233605 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m12:10:56.235877 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m12:10:56.236119 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."ods"."ods_deal" rename to "ods_deal__dbt_backup"
[0m12:10:56.239239 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:10:56.241020 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m12:10:56.241218 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
alter table "postgres"."ods"."ods_deal__dbt_tmp" rename to "ods_deal"
[0m12:10:56.241946 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:10:56.242658 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m12:10:56.242861 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m12:10:56.243039 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: COMMIT
[0m12:10:56.243732 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m12:10:56.245289 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal__dbt_backup"
[0m12:10:56.245634 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal"
[0m12:10:56.245838 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal"} */
drop table if exists "postgres"."ods"."ods_deal__dbt_backup" cascade
[0m12:10:56.248455 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m12:10:56.249274 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal: Close
[0m12:10:56.249652 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a706a98b-9744-44b6-9656-0cb4ed90a436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b65340>]}
[0m12:10:56.250036 [info ] [Thread-1  ]: 8 of 8 OK created sql table model ods.ods_deal ................................. [[32mSELECT 4[0m in 0.03s]
[0m12:10:56.250354 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal
[0m12:10:56.251087 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:56.251262 [debug] [MainThread]: On master: BEGIN
[0m12:10:56.251408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:56.263496 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:10:56.263830 [debug] [MainThread]: On master: COMMIT
[0m12:10:56.264021 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:56.264179 [debug] [MainThread]: On master: COMMIT
[0m12:10:56.264610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:10:56.264814 [debug] [MainThread]: On master: Close
[0m12:10:56.265080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:56.265240 [debug] [MainThread]: Connection 'model.enpal_assessment_project.ods_deal' was properly closed.
[0m12:10:56.265472 [info ] [MainThread]: 
[0m12:10:56.265658 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m12:10:56.266637 [debug] [MainThread]: Command end result
[0m12:10:56.282441 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:10:56.284031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:10:56.288421 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m12:10:56.288629 [info ] [MainThread]: 
[0m12:10:56.288878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:56.289078 [info ] [MainThread]: 
[0m12:10:56.289278 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m12:10:56.290582 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2769518, "process_in_blocks": "0", "process_kernel_time": 0.159809, "process_mem_max_rss": "131432448", "process_out_blocks": "0", "process_user_time": 1.549809}
[0m12:10:56.290845 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:56.290796 after 1.28 seconds
[0m12:10:56.291078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111407610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec3a90>]}
[0m12:10:56.291304 [debug] [MainThread]: Flushing usage events
[0m12:10:56.810934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:17.691640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106085cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106085af0>]}


============================== 12:21:17.694867 | 1e1d0ac4-9adf-4888-a807-eec06aef38c7 ==============================
[0m12:21:17.694867 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:21:17.695209 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m12:21:17.810992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e1d0ac4-9adf-4888-a807-eec06aef38c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020b7bb0>]}
[0m12:21:17.846386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e1d0ac4-9adf-4888-a807-eec06aef38c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106048250>]}
[0m12:21:17.846953 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:21:17.919817 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:21:18.004866 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m12:21:18.005197 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m12:21:18.005391 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_users.sql
[0m12:21:18.005570 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m12:21:18.005743 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m12:21:18.005912 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m12:21:18.006058 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/users.sql
[0m12:21:18.006200 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/activity.sql
[0m12:21:18.006337 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/fields.sql
[0m12:21:18.006477 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/stages.sql
[0m12:21:18.006660 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/activity_types.sql
[0m12:21:18.123023 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.ods_deal' (models/ods/ods_deal.sql) depends on a node named 'activity_types' which was not found
[0m12:21:18.124776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4787358, "process_in_blocks": "0", "process_kernel_time": 0.170579, "process_mem_max_rss": "113311744", "process_out_blocks": "0", "process_user_time": 1.094758}
[0m12:21:18.125068 [debug] [MainThread]: Command `dbt run` failed at 12:21:18.125001 after 0.48 seconds
[0m12:21:18.125309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107158c10>]}
[0m12:21:18.125554 [debug] [MainThread]: Flushing usage events
[0m12:21:18.614195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:22:03.209549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d14820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a784b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a784970>]}


============================== 12:22:03.212545 | 6a14c4d7-70a4-4112-89ff-566a4df3b060 ==============================
[0m12:22:03.212545 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:22:03.212875 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'log_format': 'default', 'version_check': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'use_experimental_parser': 'False'}
[0m12:22:03.337869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107178af0>]}
[0m12:22:03.377190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae3d340>]}
[0m12:22:03.377958 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:22:03.451113 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:22:03.532268 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 6 files added, 1 files changed.
[0m12:22:03.532600 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.sql
[0m12:22:03.532791 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m12:22:03.532963 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_users.sql
[0m12:22:03.533138 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m12:22:03.533305 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m12:22:03.533465 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m12:22:03.533607 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/fields.sql
[0m12:22:03.533744 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/users.sql
[0m12:22:03.533920 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/activity_types.sql
[0m12:22:03.534061 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/stages.sql
[0m12:22:03.534202 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/activity.sql
[0m12:22:03.534334 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/deal_changes.sql
[0m12:22:03.534491 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/ods/ods_deal.sql
[0m12:22:03.723473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac4afa0>]}
[0m12:22:03.774118 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:22:03.775717 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:22:03.787958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5cfa00>]}
[0m12:22:03.788257 [info ] [MainThread]: Found 8 models, 7 sources, 448 macros
[0m12:22:03.788451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4b4af0>]}
[0m12:22:03.789387 [info ] [MainThread]: 
[0m12:22:03.789585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:03.789748 [info ] [MainThread]: 
[0m12:22:03.790010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:22:03.792647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:22:03.824920 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:22:03.825220 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:22:03.825385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:03.864639 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.039 seconds
[0m12:22:03.865507 [debug] [ThreadPool]: On list_postgres: Close
[0m12:22:03.867385 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:22:03.867640 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:22:03.867802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:03.877597 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m12:22:03.878346 [debug] [ThreadPool]: On list_postgres: Close
[0m12:22:03.879337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m12:22:03.883136 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m12:22:03.883398 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m12:22:03.883565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:03.894548 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:22:03.894746 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m12:22:03.894929 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m12:22:03.897943 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:22:03.898725 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m12:22:03.899165 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m12:22:03.899487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m12:22:03.901025 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m12:22:03.901233 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m12:22:03.901390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:03.908503 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:22:03.908746 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m12:22:03.908935 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m12:22:03.910707 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:22:03.911524 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m12:22:03.911953 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m12:22:03.912260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m12:22:03.913741 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:22:03.913950 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m12:22:03.914106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:03.922554 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:22:03.922772 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:22:03.922948 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m12:22:03.924818 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m12:22:03.925662 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m12:22:03.926225 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m12:22:03.930522 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:03.930748 [debug] [MainThread]: On master: BEGIN
[0m12:22:03.930907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:03.938294 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:22:03.938541 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:03.938759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:22:03.941923 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:22:03.942651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f9df0>]}
[0m12:22:03.942941 [debug] [MainThread]: On master: ROLLBACK
[0m12:22:03.943389 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:03.943549 [debug] [MainThread]: On master: BEGIN
[0m12:22:03.944221 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:22:03.944425 [debug] [MainThread]: On master: COMMIT
[0m12:22:03.944604 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:03.944759 [debug] [MainThread]: On master: COMMIT
[0m12:22:03.945167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:22:03.945330 [debug] [MainThread]: On master: Close
[0m12:22:03.947965 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity
[0m12:22:03.948300 [info ] [Thread-1  ]: 1 of 7 START sql table model staging.stg_activity .............................. [RUN]
[0m12:22:03.948565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.stg_activity)
[0m12:22:03.948762 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity
[0m12:22:03.954217 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m12:22:03.954902 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity
[0m12:22:03.980653 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m12:22:03.981466 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m12:22:03.981712 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m12:22:03.981922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:22:04.011329 [debug] [Thread-1  ]: SQL status: BEGIN in 0.029 seconds
[0m12:22:04.011594 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m12:22:04.011806 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  
    

  create  table "postgres"."staging"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

 select 
 activity_id,
 type as activity_type,
 assigned_to_user,
 deal_id,
 done,
 due_to::timestamp as due_to
 from "postgres"."public"."activity"
  );
  
[0m12:22:04.017023 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.005 seconds
[0m12:22:04.023627 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m12:22:04.023878 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."staging"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m12:22:04.024564 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:04.033371 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m12:22:04.033597 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m12:22:04.033789 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m12:22:04.036165 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:22:04.040099 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_activity__dbt_backup"
[0m12:22:04.043504 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m12:22:04.043738 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."staging"."stg_activity__dbt_backup" cascade
[0m12:22:04.044911 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m12:22:04.046537 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: Close
[0m12:22:04.047862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107466340>]}
[0m12:22:04.048267 [info ] [Thread-1  ]: 1 of 7 OK created sql table model staging.stg_activity ......................... [[32mSELECT 4579[0m in 0.10s]
[0m12:22:04.048609 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity
[0m12:22:04.048837 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m12:22:04.049089 [info ] [Thread-1  ]: 2 of 7 START sql table model staging.stg_activity_types ........................ [RUN]
[0m12:22:04.049337 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m12:22:04.049532 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m12:22:04.051676 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m12:22:04.052243 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m12:22:04.054517 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m12:22:04.055288 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m12:22:04.055588 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m12:22:04.055790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:22:04.068230 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m12:22:04.068525 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m12:22:04.068737 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as activity_type_id,
 name as activity_name,
 active,
 type as activity_type from "postgres"."public"."activity_types"
  );
  
[0m12:22:04.070572 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m12:22:04.072868 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m12:22:04.073088 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m12:22:04.076938 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:22:04.077703 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m12:22:04.077918 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m12:22:04.078104 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m12:22:04.088776 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m12:22:04.090824 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_activity_types__dbt_backup"
[0m12:22:04.091372 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m12:22:04.091622 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."staging"."stg_activity_types__dbt_backup" cascade
[0m12:22:04.093103 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m12:22:04.094288 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m12:22:04.094797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebe48b0>]}
[0m12:22:04.095322 [info ] [Thread-1  ]: 2 of 7 OK created sql table model staging.stg_activity_types ................... [[32mSELECT 4[0m in 0.05s]
[0m12:22:04.095766 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m12:22:04.096019 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m12:22:04.096351 [info ] [Thread-1  ]: 3 of 7 START sql table model staging.stg_deal_changes .......................... [RUN]
[0m12:22:04.096644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m12:22:04.096865 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m12:22:04.099163 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m12:22:04.099846 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m12:22:04.102168 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m12:22:04.102726 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m12:22:04.102949 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m12:22:04.103132 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:22:04.114378 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:22:04.114689 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m12:22:04.114913 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

select
  deal_id,
  change_time::timestamp as change_time_at,
  changed_field_key,
  new_value
from "postgres"."public"."deal_changes"
  );
  
[0m12:22:04.122784 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.008 seconds
[0m12:22:04.126045 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m12:22:04.126286 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m12:22:04.126934 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:04.127719 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m12:22:04.127942 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m12:22:04.128141 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m12:22:04.130280 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:22:04.131882 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_deal_changes__dbt_backup"
[0m12:22:04.132282 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m12:22:04.132497 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."staging"."stg_deal_changes__dbt_backup" cascade
[0m12:22:04.133022 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m12:22:04.133829 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m12:22:04.134213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec6ac40>]}
[0m12:22:04.134630 [info ] [Thread-1  ]: 3 of 7 OK created sql table model staging.stg_deal_changes ..................... [[32mSELECT 15406[0m in 0.04s]
[0m12:22:04.134970 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m12:22:04.135203 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m12:22:04.135511 [info ] [Thread-1  ]: 4 of 7 START sql table model staging.stg_fields ................................ [RUN]
[0m12:22:04.135768 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m12:22:04.135969 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m12:22:04.138038 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m12:22:04.138523 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m12:22:04.140862 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m12:22:04.141291 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m12:22:04.141484 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m12:22:04.141660 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:22:04.150427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m12:22:04.150616 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m12:22:04.150807 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as field_id,
 field_key as field_key,
 name as field_name,
 field_value_options
  from "postgres"."public"."fields"
  );
  
[0m12:22:04.152774 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m12:22:04.155092 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m12:22:04.155328 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m12:22:04.157026 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:22:04.157715 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m12:22:04.157913 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m12:22:04.158095 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m12:22:04.159913 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:22:04.161423 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_fields__dbt_backup"
[0m12:22:04.161750 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m12:22:04.161960 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."staging"."stg_fields__dbt_backup" cascade
[0m12:22:04.162853 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m12:22:04.163587 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m12:22:04.163966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec6ac40>]}
[0m12:22:04.164357 [info ] [Thread-1  ]: 4 of 7 OK created sql table model staging.stg_fields ........................... [[32mSELECT 4[0m in 0.03s]
[0m12:22:04.164841 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m12:22:04.165103 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m12:22:04.165388 [info ] [Thread-1  ]: 5 of 7 START sql table model staging.stg_stages ................................ [RUN]
[0m12:22:04.165666 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m12:22:04.165862 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m12:22:04.168853 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m12:22:04.169428 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m12:22:04.171845 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m12:22:04.172305 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m12:22:04.172510 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m12:22:04.172683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:22:04.183202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m12:22:04.183484 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m12:22:04.183678 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

 select 
 stage_id,
 stage_name
  from "postgres"."public"."stages"
  );
  
[0m12:22:04.185300 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.001 seconds
[0m12:22:04.187592 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m12:22:04.187846 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m12:22:04.188525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:04.189384 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m12:22:04.189609 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m12:22:04.189801 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m12:22:04.190781 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m12:22:04.192312 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_stages__dbt_backup"
[0m12:22:04.192631 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m12:22:04.192831 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."staging"."stg_stages__dbt_backup" cascade
[0m12:22:04.193896 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m12:22:04.194631 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m12:22:04.194995 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edb98b0>]}
[0m12:22:04.195392 [info ] [Thread-1  ]: 5 of 7 OK created sql table model staging.stg_stages ........................... [[32mSELECT 9[0m in 0.03s]
[0m12:22:04.195717 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m12:22:04.195944 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m12:22:04.196235 [info ] [Thread-1  ]: 6 of 7 START sql table model staging.stg_users ................................. [RUN]
[0m12:22:04.196476 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m12:22:04.196672 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m12:22:04.198719 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m12:22:04.199160 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m12:22:04.201366 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m12:22:04.201811 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m12:22:04.202013 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m12:22:04.202197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:22:04.213713 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:22:04.214006 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m12:22:04.214203 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  
    

  create  table "postgres"."staging"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as user_id,
 name as user_name,
 email as user_email,
 modified as modified_at
 from "postgres"."public"."users"
  );
  
[0m12:22:04.217032 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.003 seconds
[0m12:22:04.219248 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m12:22:04.219470 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:22:04.219974 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:04.220668 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m12:22:04.220868 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m12:22:04.221047 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m12:22:04.221709 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m12:22:04.224064 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_users__dbt_backup"
[0m12:22:04.224393 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m12:22:04.224594 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."staging"."stg_users__dbt_backup" cascade
[0m12:22:04.225185 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m12:22:04.225937 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m12:22:04.226312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede0670>]}
[0m12:22:04.226702 [info ] [Thread-1  ]: 6 of 7 OK created sql table model staging.stg_users ............................ [[32mSELECT 1787[0m in 0.03s]
[0m12:22:04.227028 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m12:22:04.227252 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m12:22:04.227508 [info ] [Thread-1  ]: 7 of 7 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m12:22:04.227829 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now model.enpal_assessment_project.test_model)
[0m12:22:04.228041 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m12:22:04.229972 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m12:22:04.230776 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m12:22:04.233179 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m12:22:04.233642 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:22:04.233840 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m12:22:04.234018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:22:04.242850 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m12:22:04.243131 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:22:04.243313 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m12:22:04.246703 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m12:22:04.249072 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:22:04.249305 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m12:22:04.249975 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:04.251824 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:22:04.252033 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m12:22:04.252589 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:04.254496 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m12:22:04.254707 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:22:04.254888 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m12:22:04.257675 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m12:22:04.259176 [debug] [Thread-1  ]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m12:22:04.259486 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:22:04.259673 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m12:22:04.264379 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m12:22:04.265158 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m12:22:04.265517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a14c4d7-70a4-4112-89ff-566a4df3b060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee5c7f0>]}
[0m12:22:04.265899 [info ] [Thread-1  ]: 7 of 7 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 4579[0m in 0.04s]
[0m12:22:04.266241 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m12:22:04.266988 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:04.267228 [debug] [MainThread]: On master: BEGIN
[0m12:22:04.267391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:04.276054 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:22:04.276363 [debug] [MainThread]: On master: COMMIT
[0m12:22:04.276644 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:04.276814 [debug] [MainThread]: On master: COMMIT
[0m12:22:04.277258 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:22:04.277497 [debug] [MainThread]: On master: Close
[0m12:22:04.277767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:04.277929 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m12:22:04.278199 [info ] [MainThread]: 
[0m12:22:04.278498 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m12:22:04.279368 [debug] [MainThread]: Command end result
[0m12:22:04.295723 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:22:04.296886 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:22:04.301260 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m12:22:04.301462 [info ] [MainThread]: 
[0m12:22:04.301690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:04.301865 [info ] [MainThread]: 
[0m12:22:04.302044 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m12:22:04.303125 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1349721, "process_in_blocks": "0", "process_kernel_time": 0.181701, "process_mem_max_rss": "129794048", "process_out_blocks": "0", "process_user_time": 1.503686}
[0m12:22:04.303352 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:04.303304 after 1.14 seconds
[0m12:22:04.303551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d14820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a76dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f0ac0>]}
[0m12:22:04.303754 [debug] [MainThread]: Flushing usage events
[0m12:22:04.884482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:30:38.234236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034287f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a22b0>]}


============================== 12:30:38.238723 | 2f3c537a-f8eb-4215-9cd0-ada9bf97649e ==============================
[0m12:30:38.238723 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:30:38.239146 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'use_colors': 'True', 'empty': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:38.356941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f3c537a-f8eb-4215-9cd0-ada9bf97649e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104481550>]}
[0m12:30:38.391820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f3c537a-f8eb-4215-9cd0-ada9bf97649e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b65b0>]}
[0m12:30:38.392413 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:30:38.464762 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:30:38.529573 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: staging/stg_users.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |   - name: stg_users
    4  |     description: "User details with clean naming"
    5  |     columns:
    6  |       - name: user_id
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 9
[0m12:30:38.530855 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.342423, "process_in_blocks": "0", "process_kernel_time": 0.139125, "process_mem_max_rss": "106987520", "process_out_blocks": "0", "process_user_time": 0.973634}
[0m12:30:38.531120 [debug] [MainThread]: Command `dbt test` failed at 12:30:38.531061 after 0.34 seconds
[0m12:30:38.531338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034287f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105457fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054690d0>]}
[0m12:30:38.531567 [debug] [MainThread]: Flushing usage events
[0m12:30:39.055764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:11.925030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106257820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0f340>]}


============================== 12:33:11.928341 | 6e3b5990-bd2c-4d18-81c5-5c522b3ded25 ==============================
[0m12:33:11.928341 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:33:11.928689 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'empty': 'None', 'version_check': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m12:33:12.044664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e3b5990-bd2c-4d18-81c5-5c522b3ded25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c99940>]}
[0m12:33:12.079687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e3b5990-bd2c-4d18-81c5-5c522b3ded25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b5670>]}
[0m12:33:12.080293 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:33:12.152656 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:33:12.216826 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: staging/stg_users.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | version: 2
    2  |     models:
    3  |     - name: stg_users
    4  |     description: "User details with clean naming"
    5  |     columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 11
[0m12:33:12.218256 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3379211, "process_in_blocks": "0", "process_kernel_time": 0.165576, "process_mem_max_rss": "108183552", "process_out_blocks": "0", "process_user_time": 0.975609}
[0m12:33:12.218501 [debug] [MainThread]: Command `dbt test` failed at 12:33:12.218449 after 0.34 seconds
[0m12:33:12.218718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106257820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca91c0>]}
[0m12:33:12.218938 [debug] [MainThread]: Flushing usage events
[0m12:33:12.662864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:09.414320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da6370>]}


============================== 12:34:09.417297 | 102bab8d-aa4d-4623-97e6-82475625254b ==============================
[0m12:34:09.417297 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:34:09.417629 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'empty': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt test', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None'}
[0m12:34:09.529919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '102bab8d-aa4d-4623-97e6-82475625254b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728dcd0>]}
[0m12:34:09.564868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '102bab8d-aa4d-4623-97e6-82475625254b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcedf0>]}
[0m12:34:09.565955 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:34:09.637665 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:34:09.700548 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: staging/stg_users.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | version: 2
    2  |     models:
    3  |     - name: stg_users
    4  |       description: "User details with clean naming"
    5  |       columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 11
[0m12:34:09.701699 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3288816, "process_in_blocks": "0", "process_kernel_time": 0.121427, "process_mem_max_rss": "107970560", "process_out_blocks": "0", "process_user_time": 0.971682}
[0m12:34:09.701952 [debug] [MainThread]: Command `dbt test` failed at 12:34:09.701898 after 0.33 seconds
[0m12:34:09.702172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d56880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d56820>]}
[0m12:34:09.702401 [debug] [MainThread]: Flushing usage events
[0m12:34:10.173297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:24.943708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103965790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049de550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049de370>]}


============================== 12:35:24.947197 | 12de79dd-a6ae-4f09-831d-a10565cb8e19 ==============================
[0m12:35:24.947197 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:35:24.947558 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'use_colors': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'target_path': 'None', 'empty': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m12:35:25.063498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12de79dd-a6ae-4f09-831d-a10565cb8e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec5cd0>]}
[0m12:35:25.098796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12de79dd-a6ae-4f09-831d-a10565cb8e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104808df0>]}
[0m12:35:25.099398 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:35:25.169761 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:35:25.234203 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: staging/stg_stages.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | version: 2
    2  |  models:
    3  |   - name: stg_stages
    4  |     description: "Pipeline stages configuration"
    5  |     columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 8
[0m12:35:25.235388 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.33374053, "process_in_blocks": "0", "process_kernel_time": 0.123386, "process_mem_max_rss": "108478464", "process_out_blocks": "0", "process_user_time": 0.973358}
[0m12:35:25.235638 [debug] [MainThread]: Command `dbt test` failed at 12:35:25.235586 after 0.33 seconds
[0m12:35:25.235854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103965790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598e400>]}
[0m12:35:25.236080 [debug] [MainThread]: Flushing usage events
[0m12:35:25.676956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:42.223187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032817f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042fb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042fb2b0>]}


============================== 12:35:42.225657 | 5b0eec79-3faa-4195-84ec-9f94a4d15538 ==============================
[0m12:35:42.225657 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:35:42.226028 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'static_parser': 'True'}
[0m12:35:42.327776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b0eec79-3faa-4195-84ec-9f94a4d15538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d9550>]}
[0m12:35:42.363533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b0eec79-3faa-4195-84ec-9f94a4d15538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480e5b0>]}
[0m12:35:42.364333 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:35:42.437973 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:35:42.502767 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: staging/stg_stages.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | version: 2
    2  |  models:
    3  |   - name: stg_stages
    4  |     description: "Pipeline stages configuration"
    5  |     columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 8
[0m12:35:42.503910 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3210565, "process_in_blocks": "0", "process_kernel_time": 0.111023, "process_mem_max_rss": "109789184", "process_out_blocks": "0", "process_user_time": 0.983687}
[0m12:35:42.504157 [debug] [MainThread]: Command `dbt test` failed at 12:35:42.504097 after 0.32 seconds
[0m12:35:42.504380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032817f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a613d0>]}
[0m12:35:42.504610 [debug] [MainThread]: Flushing usage events
[0m12:35:42.909644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:37.061316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055757f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ee490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ee2b0>]}


============================== 12:36:37.064662 | ec1f0838-1cce-492b-adee-f0d8a1f94407 ==============================
[0m12:36:37.064662 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:36:37.065001 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'quiet': 'False', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'empty': 'None', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m12:36:37.183581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec1f0838-1cce-492b-adee-f0d8a1f94407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cd550>]}
[0m12:36:37.218567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec1f0838-1cce-492b-adee-f0d8a1f94407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b025b0>]}
[0m12:36:37.219248 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:36:37.290817 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:36:37.356440 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: staging/stg_stages.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |  models:
    4  |   - name: stg_stages
    5  |     description: "Pipeline stages configuration"
    6  |     columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:36:37.357599 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3382423, "process_in_blocks": "0", "process_kernel_time": 0.124429, "process_mem_max_rss": "109608960", "process_out_blocks": "0", "process_user_time": 0.98655}
[0m12:36:37.357858 [debug] [MainThread]: Command `dbt test` failed at 12:36:37.357793 after 0.34 seconds
[0m12:36:37.358075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055757f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d553d0>]}
[0m12:36:37.358305 [debug] [MainThread]: Flushing usage events
[0m12:36:37.794057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:36.640242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441e310>]}


============================== 12:37:36.642580 | 4cb667da-161e-4ee2-9fbd-4274043a29b0 ==============================
[0m12:37:36.642580 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:37:36.642915 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True'}
[0m12:37:36.745178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cb667da-161e-4ee2-9fbd-4274043a29b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101af5a30>]}
[0m12:37:36.780512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cb667da-161e-4ee2-9fbd-4274043a29b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104247eb0>]}
[0m12:37:36.780997 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:37:36.849689 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:37:36.911869 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: staging/stg_stages.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | version: 2
    2  |  models:
    3  |   - name: stg_stages
    4  |     description: "Pipeline stages configuration"
    5  |     columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 8
[0m12:37:36.912958 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.31347418, "process_in_blocks": "0", "process_kernel_time": 0.116646, "process_mem_max_rss": "108904448", "process_out_blocks": "0", "process_user_time": 0.974936}
[0m12:37:36.913218 [debug] [MainThread]: Command `dbt test` failed at 12:37:36.913160 after 0.31 seconds
[0m12:37:36.913462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae2c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae2130>]}
[0m12:37:36.913723 [debug] [MainThread]: Flushing usage events
[0m12:37:37.347167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:08.832499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062557c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ce4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ce310>]}


============================== 12:38:08.835317 | 9d976399-b011-4d38-8501-12012e50865b ==============================
[0m12:38:08.835317 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:38:08.835711 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'introspect': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'partial_parse': 'True'}
[0m12:38:08.936295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d976399-b011-4d38-8501-12012e50865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5ca30>]}
[0m12:38:08.971532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d976399-b011-4d38-8501-12012e50865b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f8eb0>]}
[0m12:38:08.972043 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:38:09.041143 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:38:09.102278 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: staging/stg_stages.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  |  
    3  |  models:
    4  |   - name: stg_stages
    5  |     description: "Pipeline stages configuration"
    6  |     columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:38:09.103491 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.31253338, "process_in_blocks": "0", "process_kernel_time": 0.119343, "process_mem_max_rss": "109248512", "process_out_blocks": "0", "process_user_time": 0.969999}
[0m12:38:09.103743 [debug] [MainThread]: Command `dbt test` failed at 12:38:09.103685 after 0.31 seconds
[0m12:38:09.103957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062557c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11076bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11076b130>]}
[0m12:38:09.104187 [debug] [MainThread]: Flushing usage events
[0m12:38:09.509314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:22.735908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030dc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438f2b0>]}


============================== 12:38:22.739819 | bfbfff8e-d7a5-4210-9d72-24207c01b1f5 ==============================
[0m12:38:22.739819 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:38:22.740213 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt test', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment'}
[0m12:38:22.886480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfbfff8e-d7a5-4210-9d72-24207c01b1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436d550>]}
[0m12:38:22.922863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfbfff8e-d7a5-4210-9d72-24207c01b1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a25b0>]}
[0m12:38:22.923685 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:38:22.993960 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:38:23.058660 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: staging/stg_activity.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2  
    2  | models:
    3  |      - name: stg_activity
    4  |     description: "Raw activity logs with clean column names"
    5  |     columns:
    6  |       - name: activity_id
    7  |         description: "Unique activity ID"
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 4, column 5
[0m12:38:23.059801 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3712888, "process_in_blocks": "0", "process_kernel_time": 0.146721, "process_mem_max_rss": "108789760", "process_out_blocks": "0", "process_user_time": 1.053502}
[0m12:38:23.060058 [debug] [MainThread]: Command `dbt test` failed at 12:38:23.060001 after 0.37 seconds
[0m12:38:23.060289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030dc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a792e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b679d0>]}
[0m12:38:23.060534 [debug] [MainThread]: Flushing usage events
[0m12:38:23.547428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:30.148848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a22550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a22370>]}


============================== 12:39:30.152347 | 8e6d3fa3-91b6-4516-91bf-bcd8a81eddd0 ==============================
[0m12:39:30.152347 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:39:30.152704 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'empty': 'None', 'no_print': 'None', 'target_path': 'None'}
[0m12:39:30.268030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e6d3fa3-91b6-4516-91bf-bcd8a81eddd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09cd0>]}
[0m12:39:30.303035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e6d3fa3-91b6-4516-91bf-bcd8a81eddd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10884bdf0>]}
[0m12:39:30.303620 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:39:30.375190 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:39:30.458329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m12:39:30.458692 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.yml
[0m12:39:30.458912 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_users.yml
[0m12:39:30.459114 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_fields.yml
[0m12:39:30.459313 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.yml
[0m12:39:30.459507 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.yml
[0m12:39:30.459712 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.yml
[0m12:39:30.675812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e6d3fa3-91b6-4516-91bf-bcd8a81eddd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c60130>]}
[0m12:39:30.741801 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:39:30.743494 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:39:30.760785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e6d3fa3-91b6-4516-91bf-bcd8a81eddd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d37dc0>]}
[0m12:39:30.761101 [info ] [MainThread]: Found 8 models, 13 data tests, 7 sources, 448 macros
[0m12:39:30.761297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e6d3fa3-91b6-4516-91bf-bcd8a81eddd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cd880>]}
[0m12:39:30.762443 [info ] [MainThread]: 
[0m12:39:30.762644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:30.762808 [info ] [MainThread]: 
[0m12:39:30.763079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:30.765810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m12:39:30.797912 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:39:30.798176 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m12:39:30.798335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:30.900999 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m12:39:30.901349 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:39:30.901571 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m12:39:30.909343 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m12:39:30.910631 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m12:39:30.911351 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m12:39:30.911841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m12:39:30.914448 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m12:39:30.914752 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m12:39:30.914986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:30.925261 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:39:30.925667 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m12:39:30.925915 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m12:39:30.929490 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:39:30.930597 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m12:39:30.931889 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m12:39:30.932452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m12:39:30.934737 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m12:39:30.934965 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m12:39:30.935150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:30.945040 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:39:30.945291 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m12:39:30.945495 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m12:39:30.947812 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:30.948801 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m12:39:30.949269 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m12:39:30.953068 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:30.953337 [debug] [MainThread]: On master: BEGIN
[0m12:39:30.953535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:30.964044 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:39:30.964361 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:30.964610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:39:30.968626 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:39:30.969581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e6d3fa3-91b6-4516-91bf-bcd8a81eddd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3a5e0>]}
[0m12:39:30.969950 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:30.970518 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:30.970722 [debug] [MainThread]: On master: BEGIN
[0m12:39:30.971450 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:39:30.971737 [debug] [MainThread]: On master: COMMIT
[0m12:39:30.971941 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:30.972120 [debug] [MainThread]: On master: COMMIT
[0m12:39:30.972582 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:30.972843 [debug] [MainThread]: On master: Close
[0m12:39:30.975080 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m12:39:30.975451 [info ] [Thread-1  ]: 1 of 13 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m12:39:30.975785 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m12:39:30.976062 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m12:39:30.987645 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m12:39:30.988292 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m12:39:30.999484 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m12:39:31.000162 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m12:39:31.000378 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m12:39:31.000566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.009938 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m12:39:31.010220 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m12:39:31.010439 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."staging"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:31.012306 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:31.014970 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m12:39:31.015597 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m12:39:31.016097 [info ] [Thread-1  ]: 1 of 13 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.04s]
[0m12:39:31.016463 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m12:39:31.016701 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m12:39:31.016995 [info ] [Thread-1  ]: 2 of 13 START test not_null_stg_activity_deal_id ............................... [RUN]
[0m12:39:31.017335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252)
[0m12:39:31.017564 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m12:39:31.020225 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m12:39:31.020712 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m12:39:31.022986 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m12:39:31.023374 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m12:39:31.023573 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: BEGIN
[0m12:39:31.023755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.035666 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m12:39:31.035934 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m12:39:31.036138 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."staging"."stg_activity"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:31.037371 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.038433 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: ROLLBACK
[0m12:39:31.038973 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: Close
[0m12:39:31.039405 [info ] [Thread-1  ]: 2 of 13 PASS not_null_stg_activity_deal_id ..................................... [[32mPASS[0m in 0.02s]
[0m12:39:31.039841 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m12:39:31.040069 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m12:39:31.040352 [info ] [Thread-1  ]: 3 of 13 START test not_null_stg_activity_types_activity_type_id ................ [RUN]
[0m12:39:31.040716 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m12:39:31.040943 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m12:39:31.043690 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m12:39:31.044237 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m12:39:31.045785 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m12:39:31.046278 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m12:39:31.046482 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m12:39:31.046670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.054175 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m12:39:31.054523 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m12:39:31.054747 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."staging"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:31.055844 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.056770 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m12:39:31.057465 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m12:39:31.057907 [info ] [Thread-1  ]: 3 of 13 PASS not_null_stg_activity_types_activity_type_id ...................... [[32mPASS[0m in 0.02s]
[0m12:39:31.058233 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m12:39:31.058452 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m12:39:31.058655 [info ] [Thread-1  ]: 4 of 13 START test not_null_stg_deal_changes_change_time_at .................... [RUN]
[0m12:39:31.058939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30)
[0m12:39:31.059142 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m12:39:31.061877 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m12:39:31.062445 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m12:39:31.064134 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m12:39:31.064848 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m12:39:31.065074 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: BEGIN
[0m12:39:31.065258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.075168 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m12:39:31.075468 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m12:39:31.075690 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_time_at
from "postgres"."staging"."stg_deal_changes"
where change_time_at is null



  
  
      
    ) dbt_internal_test
[0m12:39:31.080099 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:39:31.081058 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: ROLLBACK
[0m12:39:31.081574 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: Close
[0m12:39:31.081981 [info ] [Thread-1  ]: 4 of 13 PASS not_null_stg_deal_changes_change_time_at .......................... [[32mPASS[0m in 0.02s]
[0m12:39:31.082324 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m12:39:31.082549 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m12:39:31.082754 [info ] [Thread-1  ]: 5 of 13 START test not_null_stg_deal_changes_deal_id ........................... [RUN]
[0m12:39:31.083000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m12:39:31.083263 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m12:39:31.085970 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m12:39:31.086479 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m12:39:31.088077 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m12:39:31.089183 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m12:39:31.089394 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m12:39:31.089580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.108283 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m12:39:31.108613 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m12:39:31.108827 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."staging"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:31.110436 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.111519 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m12:39:31.112027 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m12:39:31.112457 [info ] [Thread-1  ]: 5 of 13 PASS not_null_stg_deal_changes_deal_id ................................. [[32mPASS[0m in 0.03s]
[0m12:39:31.112807 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m12:39:31.113047 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m12:39:31.113311 [info ] [Thread-1  ]: 6 of 13 START test not_null_stg_fields_field_id ................................ [RUN]
[0m12:39:31.113609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5)
[0m12:39:31.113829 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m12:39:31.117635 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m12:39:31.118334 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m12:39:31.120166 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m12:39:31.120859 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m12:39:31.121167 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: BEGIN
[0m12:39:31.121370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.132790 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:39:31.133113 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m12:39:31.133342 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_id
from "postgres"."staging"."stg_fields"
where field_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:31.134483 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.135438 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: ROLLBACK
[0m12:39:31.135940 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: Close
[0m12:39:31.136317 [info ] [Thread-1  ]: 6 of 13 PASS not_null_stg_fields_field_id ...................................... [[32mPASS[0m in 0.02s]
[0m12:39:31.136660 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m12:39:31.136886 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m12:39:31.137139 [info ] [Thread-1  ]: 7 of 13 START test not_null_stg_stages_stage_id ................................ [RUN]
[0m12:39:31.137384 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m12:39:31.137588 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m12:39:31.140448 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m12:39:31.140998 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m12:39:31.142603 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m12:39:31.143224 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m12:39:31.143504 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m12:39:31.143689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.153999 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m12:39:31.154327 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m12:39:31.154552 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."staging"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:31.155533 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.156596 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m12:39:31.157133 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m12:39:31.157505 [info ] [Thread-1  ]: 7 of 13 PASS not_null_stg_stages_stage_id ...................................... [[32mPASS[0m in 0.02s]
[0m12:39:31.157833 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m12:39:31.158045 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m12:39:31.158239 [info ] [Thread-1  ]: 8 of 13 START test not_null_stg_users_user_id .................................. [RUN]
[0m12:39:31.158508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m12:39:31.158695 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m12:39:31.161300 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m12:39:31.161836 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m12:39:31.163346 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m12:39:31.163758 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m12:39:31.163963 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m12:39:31.164147 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.173348 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m12:39:31.173662 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m12:39:31.173875 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."staging"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m12:39:31.175048 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.175959 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m12:39:31.176466 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m12:39:31.176835 [info ] [Thread-1  ]: 8 of 13 PASS not_null_stg_users_user_id ........................................ [[32mPASS[0m in 0.02s]
[0m12:39:31.177155 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m12:39:31.177376 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m12:39:31.177574 [info ] [Thread-1  ]: 9 of 13 START test unique_stg_activity_activity_id ............................. [RUN]
[0m12:39:31.177910 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m12:39:31.178136 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m12:39:31.182038 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m12:39:31.182545 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m12:39:31.185518 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m12:39:31.186056 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m12:39:31.186256 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m12:39:31.186431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.197987 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:39:31.198293 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m12:39:31.198506 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:31.200433 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:31.201395 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m12:39:31.202140 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m12:39:31.202504 [error] [Thread-1  ]: 9 of 13 FAIL 11 unique_stg_activity_activity_id ................................ [[31mFAIL 11[0m in 0.02s]
[0m12:39:31.202907 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m12:39:31.203143 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m12:39:31.203388 [info ] [Thread-1  ]: 10 of 13 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m12:39:31.203637 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m12:39:31.203842 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m12:39:31.206538 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m12:39:31.207051 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m12:39:31.208651 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m12:39:31.209148 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m12:39:31.209370 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m12:39:31.209613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.220577 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:39:31.220896 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m12:39:31.221125 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:31.222141 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.223090 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m12:39:31.223571 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m12:39:31.223933 [info ] [Thread-1  ]: 10 of 13 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.02s]
[0m12:39:31.224260 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m12:39:31.224478 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m12:39:31.224678 [info ] [Thread-1  ]: 11 of 13 START test unique_stg_fields_field_id ................................. [RUN]
[0m12:39:31.225084 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199)
[0m12:39:31.225357 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m12:39:31.228014 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m12:39:31.228460 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m12:39:31.230000 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m12:39:31.230354 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m12:39:31.230544 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: BEGIN
[0m12:39:31.230718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.241906 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:39:31.242222 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m12:39:31.242451 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_fields"
where field_id is not null
group by field_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:31.243474 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.244365 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: ROLLBACK
[0m12:39:31.244861 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: Close
[0m12:39:31.245265 [info ] [Thread-1  ]: 11 of 13 PASS unique_stg_fields_field_id ....................................... [[32mPASS[0m in 0.02s]
[0m12:39:31.245608 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m12:39:31.245833 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m12:39:31.246034 [info ] [Thread-1  ]: 12 of 13 START test unique_stg_stages_stage_id ................................. [RUN]
[0m12:39:31.246406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m12:39:31.246675 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m12:39:31.249105 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m12:39:31.249538 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m12:39:31.251002 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m12:39:31.251353 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m12:39:31.251535 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m12:39:31.251704 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.263913 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m12:39:31.264146 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m12:39:31.264340 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:31.265429 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.266466 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m12:39:31.266969 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m12:39:31.267357 [info ] [Thread-1  ]: 12 of 13 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.02s]
[0m12:39:31.267687 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m12:39:31.267906 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m12:39:31.268104 [info ] [Thread-1  ]: 13 of 13 START test unique_stg_users_user_id ................................... [RUN]
[0m12:39:31.268348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m12:39:31.268548 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m12:39:31.272254 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m12:39:31.272804 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m12:39:31.274352 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m12:39:31.274784 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m12:39:31.275016 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m12:39:31.275215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:31.292035 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m12:39:31.292368 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m12:39:31.292589 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:39:31.294039 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:31.295045 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m12:39:31.295663 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m12:39:31.296055 [info ] [Thread-1  ]: 13 of 13 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m12:39:31.296383 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m12:39:31.297035 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:31.297212 [debug] [MainThread]: On master: BEGIN
[0m12:39:31.297363 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:31.305203 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:39:31.305485 [debug] [MainThread]: On master: COMMIT
[0m12:39:31.305697 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:31.305857 [debug] [MainThread]: On master: COMMIT
[0m12:39:31.306466 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:31.306755 [debug] [MainThread]: On master: Close
[0m12:39:31.307045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:31.307209 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m12:39:31.307407 [info ] [MainThread]: 
[0m12:39:31.307596 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m12:39:31.308842 [debug] [MainThread]: Command end result
[0m12:39:31.329281 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:39:31.330713 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:39:31.335858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m12:39:31.336115 [info ] [MainThread]: 
[0m12:39:31.336328 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:39:31.336515 [info ] [MainThread]: 
[0m12:39:31.336738 [error] [MainThread]: [31mFailure in test unique_stg_activity_activity_id (models/staging/stg_activity.yml)[0m
[0m12:39:31.336938 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m12:39:31.337089 [info ] [MainThread]: 
[0m12:39:31.337270 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_activity.yml/unique_stg_activity_activity_id.sql
[0m12:39:31.337445 [info ] [MainThread]: 
[0m12:39:31.337619 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=13
[0m12:39:31.338712 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.2333196, "process_in_blocks": "0", "process_kernel_time": 0.189492, "process_mem_max_rss": "130613248", "process_out_blocks": "0", "process_user_time": 1.54017}
[0m12:39:31.338963 [debug] [MainThread]: Command `dbt test` failed at 12:39:31.338910 after 1.23 seconds
[0m12:39:31.339196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d37a00>]}
[0m12:39:31.339417 [debug] [MainThread]: Flushing usage events
[0m12:39:31.771993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:45.972362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ef8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a6a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a6a2e0>]}


============================== 12:57:45.975655 | 5c8f03d4-3b39-4855-a44f-b5e559350719 ==============================
[0m12:57:45.975655 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:57:45.975989 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'empty': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'send_anonymous_usage_stats': 'True'}
[0m12:57:46.091622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c8f03d4-3b39-4855-a44f-b5e559350719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104894a30>]}
[0m12:57:46.126574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c8f03d4-3b39-4855-a44f-b5e559350719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f249a0>]}
[0m12:57:46.127163 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:57:46.199177 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:57:46.297837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:46.298295 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_activity.yml
[0m12:57:46.570884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c8f03d4-3b39-4855-a44f-b5e559350719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d35f70>]}
[0m12:57:46.633064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:57:46.634305 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:57:46.650882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c8f03d4-3b39-4855-a44f-b5e559350719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea6a30>]}
[0m12:57:46.651198 [info ] [MainThread]: Found 8 models, 12 data tests, 7 sources, 448 macros
[0m12:57:46.651395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c8f03d4-3b39-4855-a44f-b5e559350719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aab790>]}
[0m12:57:46.652537 [info ] [MainThread]: 
[0m12:57:46.652737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:46.652898 [info ] [MainThread]: 
[0m12:57:46.653167 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:46.656068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m12:57:46.688533 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m12:57:46.688827 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m12:57:46.688998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:46.729073 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m12:57:46.729400 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m12:57:46.729599 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m12:57:46.737091 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m12:57:46.738143 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m12:57:46.738816 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m12:57:46.739256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m12:57:46.741627 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:57:46.741873 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m12:57:46.742052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:46.750215 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:57:46.750451 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:57:46.750637 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m12:57:46.753042 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m12:57:46.754016 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m12:57:46.754457 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m12:57:46.754830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m12:57:46.756969 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m12:57:46.757171 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m12:57:46.757332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:46.768036 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:57:46.768321 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m12:57:46.768534 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m12:57:46.770802 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:57:46.771558 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m12:57:46.771974 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m12:57:46.775348 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:46.775567 [debug] [MainThread]: On master: BEGIN
[0m12:57:46.775724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:46.783849 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:57:46.784105 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:46.784339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:57:46.786936 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m12:57:46.787707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c8f03d4-3b39-4855-a44f-b5e559350719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b020a0>]}
[0m12:57:46.788004 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:46.788501 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:46.788706 [debug] [MainThread]: On master: BEGIN
[0m12:57:46.789441 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:57:46.789620 [debug] [MainThread]: On master: COMMIT
[0m12:57:46.789785 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:46.789940 [debug] [MainThread]: On master: COMMIT
[0m12:57:46.790369 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:57:46.790553 [debug] [MainThread]: On master: Close
[0m12:57:46.793072 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m12:57:46.793351 [info ] [Thread-1  ]: 1 of 12 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m12:57:46.793651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_ods, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m12:57:46.793892 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m12:57:46.804970 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m12:57:46.806045 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m12:57:46.816828 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m12:57:46.818913 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m12:57:46.819235 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m12:57:46.819439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:46.829153 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m12:57:46.829477 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m12:57:46.829748 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."staging"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:46.831246 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:46.834043 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m12:57:46.834890 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m12:57:46.835363 [info ] [Thread-1  ]: 1 of 12 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.04s]
[0m12:57:46.835696 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m12:57:46.835916 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m12:57:46.836257 [info ] [Thread-1  ]: 2 of 12 START test not_null_stg_activity_deal_id ............................... [RUN]
[0m12:57:46.836651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252)
[0m12:57:46.836900 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m12:57:46.839653 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m12:57:46.840144 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m12:57:46.842576 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m12:57:46.843302 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m12:57:46.843617 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: BEGIN
[0m12:57:46.843805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:46.851220 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m12:57:46.851499 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m12:57:46.851749 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."staging"."stg_activity"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:46.852797 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:46.853767 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: ROLLBACK
[0m12:57:46.854225 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: Close
[0m12:57:46.854632 [info ] [Thread-1  ]: 2 of 12 PASS not_null_stg_activity_deal_id ..................................... [[32mPASS[0m in 0.02s]
[0m12:57:46.854969 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m12:57:46.855225 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m12:57:46.855485 [info ] [Thread-1  ]: 3 of 12 START test not_null_stg_activity_types_activity_type_id ................ [RUN]
[0m12:57:46.855747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m12:57:46.855954 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m12:57:46.858678 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m12:57:46.859203 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m12:57:46.860711 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m12:57:46.861410 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m12:57:46.861623 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m12:57:46.861900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:46.869577 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m12:57:46.869785 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m12:57:46.869975 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."staging"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:46.870819 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:46.871689 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m12:57:46.872195 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m12:57:46.872703 [info ] [Thread-1  ]: 3 of 12 PASS not_null_stg_activity_types_activity_type_id ...................... [[32mPASS[0m in 0.02s]
[0m12:57:46.873072 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m12:57:46.873302 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m12:57:46.873514 [info ] [Thread-1  ]: 4 of 12 START test not_null_stg_deal_changes_change_time_at .................... [RUN]
[0m12:57:46.873770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30)
[0m12:57:46.873968 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m12:57:46.876670 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m12:57:46.877607 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m12:57:46.879191 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m12:57:46.880022 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m12:57:46.880243 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: BEGIN
[0m12:57:46.880412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:46.888439 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m12:57:46.888747 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m12:57:46.888965 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_time_at
from "postgres"."staging"."stg_deal_changes"
where change_time_at is null



  
  
      
    ) dbt_internal_test
[0m12:57:46.890524 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:46.891497 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: ROLLBACK
[0m12:57:46.891965 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: Close
[0m12:57:46.892345 [info ] [Thread-1  ]: 4 of 12 PASS not_null_stg_deal_changes_change_time_at .......................... [[32mPASS[0m in 0.02s]
[0m12:57:46.892684 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m12:57:46.892912 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m12:57:46.893160 [info ] [Thread-1  ]: 5 of 12 START test not_null_stg_deal_changes_deal_id ........................... [RUN]
[0m12:57:46.893436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m12:57:46.893640 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m12:57:46.896283 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m12:57:46.897092 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m12:57:46.899630 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m12:57:46.900554 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m12:57:46.900827 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m12:57:46.901023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:46.918107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m12:57:46.918368 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m12:57:46.918591 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."staging"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:46.921629 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m12:57:46.922627 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m12:57:46.923177 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m12:57:46.923582 [info ] [Thread-1  ]: 5 of 12 PASS not_null_stg_deal_changes_deal_id ................................. [[32mPASS[0m in 0.03s]
[0m12:57:46.923933 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m12:57:46.924151 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m12:57:46.924353 [info ] [Thread-1  ]: 6 of 12 START test not_null_stg_fields_field_id ................................ [RUN]
[0m12:57:46.924596 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5)
[0m12:57:46.924837 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m12:57:46.927688 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m12:57:46.928189 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m12:57:46.929926 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m12:57:46.930360 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m12:57:46.930554 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: BEGIN
[0m12:57:46.930730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:46.940036 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m12:57:46.940404 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m12:57:46.940658 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_id
from "postgres"."staging"."stg_fields"
where field_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:46.941836 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:46.942854 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: ROLLBACK
[0m12:57:46.943389 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: Close
[0m12:57:46.943772 [info ] [Thread-1  ]: 6 of 12 PASS not_null_stg_fields_field_id ...................................... [[32mPASS[0m in 0.02s]
[0m12:57:46.944109 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m12:57:46.944337 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m12:57:46.944581 [info ] [Thread-1  ]: 7 of 12 START test not_null_stg_stages_stage_id ................................ [RUN]
[0m12:57:46.944866 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m12:57:46.945117 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m12:57:46.948061 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m12:57:46.948587 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m12:57:46.950193 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m12:57:46.950563 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m12:57:46.950757 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m12:57:46.950930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:46.963193 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m12:57:46.963477 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m12:57:46.963673 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."staging"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:46.964656 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:46.965665 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m12:57:46.966167 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m12:57:46.966613 [info ] [Thread-1  ]: 7 of 12 PASS not_null_stg_stages_stage_id ...................................... [[32mPASS[0m in 0.02s]
[0m12:57:46.966943 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m12:57:46.967156 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m12:57:46.967356 [info ] [Thread-1  ]: 8 of 12 START test not_null_stg_users_user_id .................................. [RUN]
[0m12:57:46.967598 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m12:57:46.967792 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m12:57:46.970429 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m12:57:46.971013 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m12:57:46.972897 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m12:57:46.973308 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m12:57:46.973549 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m12:57:46.973786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:46.984916 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:57:46.985221 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m12:57:46.985494 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."staging"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:46.987193 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:46.988134 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m12:57:46.988830 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m12:57:46.989216 [info ] [Thread-1  ]: 8 of 12 PASS not_null_stg_users_user_id ........................................ [[32mPASS[0m in 0.02s]
[0m12:57:46.989534 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m12:57:46.989748 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m12:57:46.989982 [info ] [Thread-1  ]: 9 of 12 START test unique_stg_activity_types_activity_type_id .................. [RUN]
[0m12:57:46.990237 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m12:57:46.990438 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m12:57:46.995587 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m12:57:46.996366 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m12:57:46.998164 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m12:57:46.998621 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m12:57:46.998820 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m12:57:46.999002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:47.016293 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m12:57:47.016589 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m12:57:47.016810 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:47.017943 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:47.018923 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m12:57:47.019417 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m12:57:47.019791 [info ] [Thread-1  ]: 9 of 12 PASS unique_stg_activity_types_activity_type_id ........................ [[32mPASS[0m in 0.03s]
[0m12:57:47.020119 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m12:57:47.020335 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m12:57:47.020581 [info ] [Thread-1  ]: 10 of 12 START test unique_stg_fields_field_id ................................. [RUN]
[0m12:57:47.020967 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199)
[0m12:57:47.021250 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m12:57:47.023915 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m12:57:47.024354 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m12:57:47.025881 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m12:57:47.026243 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m12:57:47.026430 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: BEGIN
[0m12:57:47.026611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:47.042564 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m12:57:47.042849 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m12:57:47.043174 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_fields"
where field_id is not null
group by field_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:47.044198 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:47.045219 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: ROLLBACK
[0m12:57:47.045750 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: Close
[0m12:57:47.046117 [info ] [Thread-1  ]: 10 of 12 PASS unique_stg_fields_field_id ....................................... [[32mPASS[0m in 0.03s]
[0m12:57:47.046427 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m12:57:47.046638 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m12:57:47.046888 [info ] [Thread-1  ]: 11 of 12 START test unique_stg_stages_stage_id ................................. [RUN]
[0m12:57:47.047183 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m12:57:47.047392 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m12:57:47.050150 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m12:57:47.050627 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m12:57:47.052280 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m12:57:47.052815 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m12:57:47.053070 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m12:57:47.053247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:47.065191 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m12:57:47.065489 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m12:57:47.065705 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:47.066861 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:57:47.067853 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m12:57:47.068382 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m12:57:47.068881 [info ] [Thread-1  ]: 11 of 12 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.02s]
[0m12:57:47.069241 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m12:57:47.069474 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m12:57:47.069688 [info ] [Thread-1  ]: 12 of 12 START test unique_stg_users_user_id ................................... [RUN]
[0m12:57:47.069935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m12:57:47.070205 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m12:57:47.073049 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m12:57:47.073537 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m12:57:47.076169 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m12:57:47.076638 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m12:57:47.076847 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m12:57:47.077022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:47.087202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m12:57:47.087500 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m12:57:47.087869 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:47.091652 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:57:47.092630 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m12:57:47.093268 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m12:57:47.093710 [info ] [Thread-1  ]: 12 of 12 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m12:57:47.094028 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m12:57:47.094642 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:47.094825 [debug] [MainThread]: On master: BEGIN
[0m12:57:47.094973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:47.104010 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:57:47.104309 [debug] [MainThread]: On master: COMMIT
[0m12:57:47.104499 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:47.104663 [debug] [MainThread]: On master: COMMIT
[0m12:57:47.105110 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:57:47.105306 [debug] [MainThread]: On master: Close
[0m12:57:47.105570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:47.105725 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m12:57:47.105932 [info ] [MainThread]: 
[0m12:57:47.106115 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m12:57:47.107354 [debug] [MainThread]: Command end result
[0m12:57:47.124370 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m12:57:47.125744 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:57:47.130807 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m12:57:47.131000 [info ] [MainThread]: 
[0m12:57:47.131207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:47.131378 [info ] [MainThread]: 
[0m12:57:47.131561 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m12:57:47.132983 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2051982, "process_in_blocks": "0", "process_kernel_time": 0.207133, "process_mem_max_rss": "135348224", "process_out_blocks": "0", "process_user_time": 1.583539}
[0m12:57:47.133256 [debug] [MainThread]: Command `dbt test` succeeded at 12:57:47.133187 after 1.21 seconds
[0m12:57:47.133489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ef8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103496be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636da60>]}
[0m12:57:47.133709 [debug] [MainThread]: Flushing usage events
[0m12:57:47.655131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:32.967963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eeb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109185b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109185970>]}


============================== 13:53:32.971527 | 90690d14-e3a2-4539-be0d-e4383e314098 ==============================
[0m13:53:32.971527 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:53:32.971870 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'version_check': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None'}
[0m13:53:33.118251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106379af0>]}
[0m13:53:33.155168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993a340>]}
[0m13:53:33.156150 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:53:33.229738 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:53:33.329618 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m13:53:33.329965 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/ods/ods_deal_stage_journey.sql
[0m13:53:33.330267 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_activity.yml
[0m13:53:33.330428 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/ods/ods_deal.sql
[0m13:53:33.607578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b886130>]}
[0m13:53:33.671207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m13:53:33.672518 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:53:33.685148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8a32b0>]}
[0m13:53:33.685466 [info ] [MainThread]: Found 8 models, 13 data tests, 7 sources, 448 macros
[0m13:53:33.685662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8875e0>]}
[0m13:53:33.686720 [info ] [MainThread]: 
[0m13:53:33.686916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:33.687078 [info ] [MainThread]: 
[0m13:53:33.687338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:53:33.690048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:53:33.728466 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:53:33.728747 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:53:33.728904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:33.829048 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.100 seconds
[0m13:53:33.830101 [debug] [ThreadPool]: On list_postgres: Close
[0m13:53:33.832148 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:53:33.832461 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:53:33.832649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:33.842550 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m13:53:33.843505 [debug] [ThreadPool]: On list_postgres: Close
[0m13:53:33.845309 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:53:33.845647 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:53:33.845898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:33.854492 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m13:53:33.855447 [debug] [ThreadPool]: On list_postgres: Close
[0m13:53:33.856684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m13:53:33.860947 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m13:53:33.861186 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m13:53:33.861362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:33.885762 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m13:53:33.886080 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m13:53:33.886311 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m13:53:33.893733 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m13:53:33.894775 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m13:53:33.895455 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m13:53:33.895879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m13:53:33.898631 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m13:53:33.898904 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m13:53:33.899089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:33.907823 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:53:33.908219 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m13:53:33.908506 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m13:53:33.910737 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:53:33.911606 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m13:53:33.912288 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m13:53:33.912677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m13:53:33.914518 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:53:33.914753 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m13:53:33.914998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:33.923142 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:53:33.923344 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:53:33.923530 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:53:33.925611 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m13:53:33.926643 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m13:53:33.927139 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m13:53:33.931142 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:33.931368 [debug] [MainThread]: On master: BEGIN
[0m13:53:33.931539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:33.941111 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:53:33.941393 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:33.941683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:53:33.944792 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:53:33.945617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109982670>]}
[0m13:53:33.945956 [debug] [MainThread]: On master: ROLLBACK
[0m13:53:33.947236 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:33.947482 [debug] [MainThread]: On master: BEGIN
[0m13:53:33.948316 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:53:33.948532 [debug] [MainThread]: On master: COMMIT
[0m13:53:33.948740 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:33.949001 [debug] [MainThread]: On master: COMMIT
[0m13:53:33.950394 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:53:33.950654 [debug] [MainThread]: On master: Close
[0m13:53:33.953264 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity
[0m13:53:33.953747 [info ] [Thread-1  ]: 1 of 8 START sql table model staging.stg_activity .............................. [RUN]
[0m13:53:33.954109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.stg_activity)
[0m13:53:33.954341 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity
[0m13:53:33.961297 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m13:53:33.962751 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity
[0m13:53:33.988484 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m13:53:33.989551 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:53:33.989774 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m13:53:33.989974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:34.004066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m13:53:34.004310 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:53:34.004518 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  
    

  create  table "postgres"."staging"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

 select 
 activity_id,
 type as activity_type,
 assigned_to_user,
 deal_id,
 done,
 due_to::timestamp as due_to
 from "postgres"."public"."activity"
  );
  
[0m13:53:34.009679 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.005 seconds
[0m13:53:34.016941 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:53:34.017194 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."staging"."stg_activity" rename to "stg_activity__dbt_backup"
[0m13:53:34.018042 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:34.019846 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:53:34.020053 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."staging"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m13:53:34.020663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:34.030330 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:53:34.030546 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:53:34.030731 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:53:34.032016 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:53:34.035701 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_activity__dbt_backup"
[0m13:53:34.038101 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:53:34.038314 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."staging"."stg_activity__dbt_backup" cascade
[0m13:53:34.043251 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:53:34.044733 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: Close
[0m13:53:34.046027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bce5a30>]}
[0m13:53:34.046421 [info ] [Thread-1  ]: 1 of 8 OK created sql table model staging.stg_activity ......................... [[32mSELECT 4579[0m in 0.09s]
[0m13:53:34.046744 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity
[0m13:53:34.046956 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m13:53:34.047202 [info ] [Thread-1  ]: 2 of 8 START sql table model staging.stg_activity_types ........................ [RUN]
[0m13:53:34.047449 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m13:53:34.047646 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m13:53:34.049864 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m13:53:34.050664 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m13:53:34.053349 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m13:53:34.054314 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:53:34.054615 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m13:53:34.054825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:34.066965 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m13:53:34.067213 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:53:34.067412 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as activity_type_id,
 name as activity_name,
 active,
 type as activity_type from "postgres"."public"."activity_types"
  );
  
[0m13:53:34.068969 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m13:53:34.071330 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:53:34.071564 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m13:53:34.072230 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:34.074875 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:53:34.075088 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m13:53:34.076565 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:34.077275 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:53:34.077475 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:53:34.077655 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:53:34.079528 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:53:34.080994 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_activity_types__dbt_backup"
[0m13:53:34.081306 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:53:34.081499 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."staging"."stg_activity_types__dbt_backup" cascade
[0m13:53:34.085466 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:53:34.086357 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m13:53:34.086761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd4250>]}
[0m13:53:34.087227 [info ] [Thread-1  ]: 2 of 8 OK created sql table model staging.stg_activity_types ................... [[32mSELECT 4[0m in 0.04s]
[0m13:53:34.087594 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m13:53:34.087825 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m13:53:34.088164 [info ] [Thread-1  ]: 3 of 8 START sql table model staging.stg_deal_changes .......................... [RUN]
[0m13:53:34.088474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m13:53:34.088691 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m13:53:34.091118 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:53:34.092163 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m13:53:34.094655 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:53:34.095566 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:53:34.095837 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m13:53:34.096025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:34.104202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:53:34.104529 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:53:34.104748 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

select
  deal_id,
  change_time::timestamp as change_time_at,
  changed_field_key,
  new_value
from "postgres"."public"."deal_changes"
  );
  
[0m13:53:34.112814 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.008 seconds
[0m13:53:34.115194 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:53:34.115419 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m13:53:34.116053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:34.117957 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:53:34.118172 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m13:53:34.118702 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:34.119476 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:53:34.119685 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:53:34.119870 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:53:34.123135 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:53:34.124766 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_deal_changes__dbt_backup"
[0m13:53:34.125103 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:53:34.125306 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."staging"."stg_deal_changes__dbt_backup" cascade
[0m13:53:34.126744 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:53:34.127533 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m13:53:34.127899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bebe760>]}
[0m13:53:34.128301 [info ] [Thread-1  ]: 3 of 8 OK created sql table model staging.stg_deal_changes ..................... [[32mSELECT 15406[0m in 0.04s]
[0m13:53:34.128636 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m13:53:34.128865 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m13:53:34.129164 [info ] [Thread-1  ]: 4 of 8 START sql table model staging.stg_fields ................................ [RUN]
[0m13:53:34.129418 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m13:53:34.129613 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m13:53:34.132562 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m13:53:34.133288 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m13:53:34.135777 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m13:53:34.136288 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:53:34.136496 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m13:53:34.136677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:34.144805 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:53:34.145086 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:53:34.145306 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as field_id,
 field_key as field_key,
 name as field_name,
 field_value_options
  from "postgres"."public"."fields"
  );
  
[0m13:53:34.148729 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m13:53:34.151311 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:53:34.151539 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."staging"."stg_fields" rename to "stg_fields__dbt_backup"
[0m13:53:34.152382 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:34.154920 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:53:34.155197 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m13:53:34.155993 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:34.156824 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m13:53:34.157029 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:53:34.157210 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m13:53:34.158446 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:53:34.160166 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_fields__dbt_backup"
[0m13:53:34.160505 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:53:34.160707 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."staging"."stg_fields__dbt_backup" cascade
[0m13:53:34.162087 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:53:34.162888 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m13:53:34.163265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bea4dc0>]}
[0m13:53:34.163667 [info ] [Thread-1  ]: 4 of 8 OK created sql table model staging.stg_fields ........................... [[32mSELECT 4[0m in 0.03s]
[0m13:53:34.163999 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m13:53:34.164225 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m13:53:34.164609 [info ] [Thread-1  ]: 5 of 8 START sql table model staging.stg_stages ................................ [RUN]
[0m13:53:34.164888 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m13:53:34.165074 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m13:53:34.166991 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m13:53:34.167831 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m13:53:34.171389 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m13:53:34.171930 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:53:34.172145 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m13:53:34.172331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:34.181508 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m13:53:34.181810 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:53:34.182014 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

 select 
 stage_id,
 stage_name
  from "postgres"."public"."stages"
  );
  
[0m13:53:34.183345 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.001 seconds
[0m13:53:34.185672 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:53:34.185902 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m13:53:34.186677 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:34.188766 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:53:34.188981 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m13:53:34.189606 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:34.190354 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:53:34.190557 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:53:34.190732 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:53:34.192343 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:53:34.193878 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_stages__dbt_backup"
[0m13:53:34.194189 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:53:34.194377 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."staging"."stg_stages__dbt_backup" cascade
[0m13:53:34.197072 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:53:34.197777 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m13:53:34.198120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bea4dc0>]}
[0m13:53:34.198504 [info ] [Thread-1  ]: 5 of 8 OK created sql table model staging.stg_stages ........................... [[32mSELECT 9[0m in 0.03s]
[0m13:53:34.198815 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m13:53:34.199025 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m13:53:34.199273 [info ] [Thread-1  ]: 6 of 8 START sql table model staging.stg_users ................................. [RUN]
[0m13:53:34.199510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m13:53:34.199700 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m13:53:34.201685 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m13:53:34.202257 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m13:53:34.204414 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m13:53:34.205065 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:53:34.205255 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m13:53:34.205426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:34.217752 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m13:53:34.217991 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:53:34.218184 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  
    

  create  table "postgres"."staging"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as user_id,
 name as user_name,
 email as user_email,
 modified as modified_at
 from "postgres"."public"."users"
  );
  
[0m13:53:34.221083 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.003 seconds
[0m13:53:34.223579 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:53:34.223837 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."staging"."stg_users" rename to "stg_users__dbt_backup"
[0m13:53:34.225321 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:34.228040 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:53:34.228249 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:53:34.229218 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:34.229902 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:53:34.230137 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:53:34.230323 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:53:34.232474 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:53:34.267371 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_users__dbt_backup"
[0m13:53:34.267775 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:53:34.267967 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."staging"."stg_users__dbt_backup" cascade
[0m13:53:34.273041 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:53:34.273882 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m13:53:34.274248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bed6580>]}
[0m13:53:34.274636 [info ] [Thread-1  ]: 6 of 8 OK created sql table model staging.stg_users ............................ [[32mSELECT 1787[0m in 0.07s]
[0m13:53:34.274963 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m13:53:34.275183 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m13:53:34.275430 [info ] [Thread-1  ]: 7 of 8 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m13:53:34.275757 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now model.enpal_assessment_project.test_model)
[0m13:53:34.275957 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m13:53:34.277820 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m13:53:34.278533 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m13:53:34.280521 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m13:53:34.280926 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:53:34.281134 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m13:53:34.281322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:34.292554 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m13:53:34.292873 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:53:34.293080 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m13:53:34.296257 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m13:53:34.298596 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:53:34.298845 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m13:53:34.299494 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:34.301623 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:53:34.301879 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m13:53:34.302480 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:34.303358 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:53:34.303585 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:53:34.303775 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:53:34.305934 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:53:34.307666 [debug] [Thread-1  ]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m13:53:34.308004 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:53:34.308197 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m13:53:34.309377 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:53:34.310163 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m13:53:34.310517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf567c0>]}
[0m13:53:34.310920 [info ] [Thread-1  ]: 7 of 8 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 4579[0m in 0.03s]
[0m13:53:34.311257 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m13:53:34.311481 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal_stage_journey
[0m13:53:34.311797 [info ] [Thread-1  ]: 8 of 8 START sql table model ods.ods_deal_stage_journey ........................ [RUN]
[0m13:53:34.312060 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now model.enpal_assessment_project.ods_deal_stage_journey)
[0m13:53:34.312255 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal_stage_journey
[0m13:53:34.315605 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:53:34.316139 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal_stage_journey
[0m13:53:34.318188 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:53:34.318699 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:53:34.318914 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: BEGIN
[0m13:53:34.319086 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:34.330646 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m13:53:34.330974 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:53:34.331245 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */

  
    

  create  table "postgres"."ods"."ods_deal_stage_journey__dbt_tmp"
  
  
    as
  
  (
    

with stage_changes as (
    -- Filter only stage changes from deal_changes
    select
        deal_id,
        change_time_at,
        changed_field_key,
        new_value as stage_id_str
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'stage_id'
        and new_value is not null
        and deal_id is not null
),
stage_details as (
    select
        stage_id,
        stage_name
    from "postgres"."staging"."stg_stages"
),
enriched_journey as (
    select
        sc.deal_id,
        sc.change_time_at,
        cast(sc.stage_id_str as integer) as stage_id,
        sd.stage_name,
        -- Map to funnel steps (9 steps as per assessment)
        case
            when cast(sc.stage_id_str as integer) = 1 then 'Step 1: Lead Generation'
            when cast(sc.stage_id_str as integer) = 2 then 'Step 2: Qualified Lead'
            when cast(sc.stage_id_str as integer) = 3 then 'Step 3: Needs Assessment'
            when cast(sc.stage_id_str as integer) = 4 then 'Step 4: Proposal/Quote Preparation'
            when cast(sc.stage_id_str as integer) = 5 then 'Step 5: Negotiation'
            when cast(sc.stage_id_str as integer) = 6 then 'Step 6: Closing'
            when cast(sc.stage_id_str as integer) = 7 then 'Step 7: Implementation/Onboarding'
            when cast(sc.stage_id_str as integer) = 8 then 'Step 8: Follow-up/Customer Success'
            when cast(sc.stage_id_str as integer) = 9 then 'Step 9: Renewal/Expansion'
            else 'Unknown Stage'
        end as funnel_step,
        date_trunc('month', sc.change_time_at)::date as month,
        row_number() over (partition by sc.deal_id order by sc.change_time_at) as stage_sequence
    from stage_changes sc
    left join stage_details sd on cast(sc.stage_id_str as integer) = sd.stage_id
)
select
    deal_id,
    change_time_at,
    stage_id,
    stage_name,
    funnel_step,
    month,
    stage_sequence
from enriched_journey
where stage_id is not null
order by deal_id, change_time_at
  );
  
[0m13:53:34.347362 [debug] [Thread-1  ]: SQL status: SELECT 8906 in 0.016 seconds
[0m13:53:34.349577 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:53:34.349805 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */
alter table "postgres"."ods"."ods_deal_stage_journey__dbt_tmp" rename to "ods_deal_stage_journey"
[0m13:53:34.350576 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:34.351621 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: COMMIT
[0m13:53:34.351903 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:53:34.352114 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: COMMIT
[0m13:53:34.354753 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:53:34.356591 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal_stage_journey__dbt_backup"
[0m13:53:34.356953 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:53:34.357167 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */
drop table if exists "postgres"."ods"."ods_deal_stage_journey__dbt_backup" cascade
[0m13:53:34.357702 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:53:34.358502 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: Close
[0m13:53:34.358889 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90690d14-e3a2-4539-be0d-e4383e314098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109999910>]}
[0m13:53:34.359315 [info ] [Thread-1  ]: 8 of 8 OK created sql table model ods.ods_deal_stage_journey ................... [[32mSELECT 8906[0m in 0.05s]
[0m13:53:34.359660 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal_stage_journey
[0m13:53:34.360401 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:34.360603 [debug] [MainThread]: On master: BEGIN
[0m13:53:34.360772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:34.368759 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:53:34.369038 [debug] [MainThread]: On master: COMMIT
[0m13:53:34.369213 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:34.369364 [debug] [MainThread]: On master: COMMIT
[0m13:53:34.369794 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:53:34.370000 [debug] [MainThread]: On master: Close
[0m13:53:34.370261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:34.370422 [debug] [MainThread]: Connection 'model.enpal_assessment_project.ods_deal_stage_journey' was properly closed.
[0m13:53:34.370651 [info ] [MainThread]: 
[0m13:53:34.370839 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m13:53:34.371772 [debug] [MainThread]: Command end result
[0m13:53:34.390528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m13:53:34.391759 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:53:34.396137 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m13:53:34.396339 [info ] [MainThread]: 
[0m13:53:34.396553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:34.396722 [info ] [MainThread]: 
[0m13:53:34.396905 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m13:53:34.398141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4771901, "process_in_blocks": "0", "process_kernel_time": 0.169843, "process_mem_max_rss": "135479296", "process_out_blocks": "0", "process_user_time": 1.697961}
[0m13:53:34.398357 [debug] [MainThread]: Command `dbt run` succeeded at 13:53:34.398313 after 1.48 seconds
[0m13:53:34.398552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eeb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108301490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109152ca0>]}
[0m13:53:34.398754 [debug] [MainThread]: Flushing usage events
[0m13:53:35.031390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:19.622469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107277850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e9a90>]}


============================== 13:57:19.625748 | 5499b9d6-6b59-4029-993b-1d9eff443325 ==============================
[0m13:57:19.625748 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:57:19.626086 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'empty': 'False'}
[0m13:57:19.742235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e9100>]}
[0m13:57:19.777785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6caf0>]}
[0m13:57:19.778402 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:57:19.849295 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:57:19.948686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m13:57:19.949059 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/ods/ods_deal_stage_journey.yml
[0m13:57:19.949256 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/ods/ods_deal_activity_funnel.sql
[0m13:57:20.145306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108992be0>]}
[0m13:57:20.208105 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m13:57:20.209321 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:57:20.221086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e1ee0>]}
[0m13:57:20.221386 [info ] [MainThread]: Found 9 models, 13 data tests, 7 sources, 448 macros
[0m13:57:20.221584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930e400>]}
[0m13:57:20.222621 [info ] [MainThread]: 
[0m13:57:20.222817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:20.222976 [info ] [MainThread]: 
[0m13:57:20.223238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:20.226012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:57:20.258130 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:57:20.258408 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:57:20.258569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:20.307110 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.048 seconds
[0m13:57:20.308017 [debug] [ThreadPool]: On list_postgres: Close
[0m13:57:20.309829 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:57:20.310076 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:57:20.310235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:20.320346 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m13:57:20.321106 [debug] [ThreadPool]: On list_postgres: Close
[0m13:57:20.322610 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:57:20.322844 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:57:20.323032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:20.330014 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m13:57:20.330771 [debug] [ThreadPool]: On list_postgres: Close
[0m13:57:20.331872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m13:57:20.335728 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:57:20.335925 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m13:57:20.336079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:20.346288 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:57:20.346515 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:57:20.346694 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:57:20.349074 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m13:57:20.349921 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m13:57:20.350405 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m13:57:20.350881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m13:57:20.353731 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m13:57:20.353969 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m13:57:20.354123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:20.362140 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:57:20.362380 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m13:57:20.362556 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m13:57:20.364772 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:57:20.365564 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m13:57:20.366020 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m13:57:20.366354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m13:57:20.367855 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m13:57:20.368212 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m13:57:20.368375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:20.375887 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:57:20.376135 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m13:57:20.376325 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m13:57:20.378310 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:57:20.379059 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m13:57:20.379838 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m13:57:20.383370 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:20.383632 [debug] [MainThread]: On master: BEGIN
[0m13:57:20.383793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:20.391165 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:57:20.391500 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:20.391727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:57:20.394073 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:57:20.394792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd3fd0>]}
[0m13:57:20.395073 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:20.395548 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:20.395709 [debug] [MainThread]: On master: BEGIN
[0m13:57:20.396329 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:57:20.396534 [debug] [MainThread]: On master: COMMIT
[0m13:57:20.396705 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:20.396869 [debug] [MainThread]: On master: COMMIT
[0m13:57:20.397298 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:57:20.397474 [debug] [MainThread]: On master: Close
[0m13:57:20.399856 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity
[0m13:57:20.400202 [info ] [Thread-1  ]: 1 of 9 START sql table model staging.stg_activity .............................. [RUN]
[0m13:57:20.400481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m13:57:20.400691 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity
[0m13:57:20.405958 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m13:57:20.413840 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity
[0m13:57:20.439621 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m13:57:20.440736 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:57:20.440997 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m13:57:20.441208 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:20.454464 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m13:57:20.454697 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:57:20.454905 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  
    

  create  table "postgres"."staging"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

 select 
 activity_id,
 type as activity_type,
 assigned_to_user,
 deal_id,
 done,
 due_to::timestamp as due_to
 from "postgres"."public"."activity"
  );
  
[0m13:57:20.458495 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m13:57:20.464938 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:57:20.465175 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."staging"."stg_activity" rename to "stg_activity__dbt_backup"
[0m13:57:20.465807 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:20.467707 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:57:20.467925 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."staging"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m13:57:20.469120 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:20.478619 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:57:20.478835 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:57:20.479013 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:57:20.481540 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:57:20.485195 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_activity__dbt_backup"
[0m13:57:20.487583 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:57:20.487782 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."staging"."stg_activity__dbt_backup" cascade
[0m13:57:20.492172 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:57:20.493561 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: Close
[0m13:57:20.494842 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109939430>]}
[0m13:57:20.495209 [info ] [Thread-1  ]: 1 of 9 OK created sql table model staging.stg_activity ......................... [[32mSELECT 4579[0m in 0.09s]
[0m13:57:20.495530 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity
[0m13:57:20.495743 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m13:57:20.496024 [info ] [Thread-1  ]: 2 of 9 START sql table model staging.stg_activity_types ........................ [RUN]
[0m13:57:20.496266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m13:57:20.496461 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m13:57:20.498333 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m13:57:20.498714 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m13:57:20.500827 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m13:57:20.501175 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:57:20.501405 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m13:57:20.501623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:20.513366 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m13:57:20.513698 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:57:20.513904 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as activity_type_id,
 name as activity_name,
 active,
 type as activity_type from "postgres"."public"."activity_types"
  );
  
[0m13:57:20.518405 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.004 seconds
[0m13:57:20.522069 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:57:20.522320 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m13:57:20.523340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:20.525658 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:57:20.525901 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m13:57:20.526839 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:20.527629 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:57:20.527852 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:57:20.528045 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:57:20.529761 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:57:20.531367 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_activity_types__dbt_backup"
[0m13:57:20.531700 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:57:20.531902 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."staging"."stg_activity_types__dbt_backup" cascade
[0m13:57:20.534124 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:57:20.534865 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m13:57:20.535224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d132e0>]}
[0m13:57:20.535604 [info ] [Thread-1  ]: 2 of 9 OK created sql table model staging.stg_activity_types ................... [[32mSELECT 4[0m in 0.04s]
[0m13:57:20.535923 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m13:57:20.536145 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m13:57:20.536388 [info ] [Thread-1  ]: 3 of 9 START sql table model staging.stg_deal_changes .......................... [RUN]
[0m13:57:20.536623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m13:57:20.536819 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m13:57:20.538847 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:57:20.539365 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m13:57:20.541617 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:57:20.541979 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:57:20.542168 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m13:57:20.542347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:20.553336 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m13:57:20.553648 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:57:20.553853 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

select
  deal_id,
  change_time::timestamp as change_time_at,
  changed_field_key,
  new_value
from "postgres"."public"."deal_changes"
  );
  
[0m13:57:20.559350 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.005 seconds
[0m13:57:20.561623 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:57:20.561848 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m13:57:20.562441 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:20.564267 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:57:20.564471 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m13:57:20.565002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:20.565788 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:57:20.566023 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:57:20.566218 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:57:20.569099 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:57:20.571757 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_deal_changes__dbt_backup"
[0m13:57:20.572103 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:57:20.572305 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."staging"."stg_deal_changes__dbt_backup" cascade
[0m13:57:20.573936 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:57:20.574772 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m13:57:20.575137 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a91ee0>]}
[0m13:57:20.575532 [info ] [Thread-1  ]: 3 of 9 OK created sql table model staging.stg_deal_changes ..................... [[32mSELECT 15406[0m in 0.04s]
[0m13:57:20.575854 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m13:57:20.576077 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m13:57:20.576330 [info ] [Thread-1  ]: 4 of 9 START sql table model staging.stg_fields ................................ [RUN]
[0m13:57:20.576677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m13:57:20.576903 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m13:57:20.578975 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m13:57:20.579476 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m13:57:20.581712 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m13:57:20.582095 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:57:20.582288 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m13:57:20.582471 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:20.591550 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m13:57:20.591847 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:57:20.592053 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as field_id,
 field_key as field_key,
 name as field_name,
 field_value_options
  from "postgres"."public"."fields"
  );
  
[0m13:57:20.593874 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m13:57:20.596122 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:57:20.596339 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."staging"."stg_fields" rename to "stg_fields__dbt_backup"
[0m13:57:20.596922 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:20.598846 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:57:20.599077 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m13:57:20.599723 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:20.600545 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m13:57:20.600780 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:57:20.600967 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m13:57:20.601749 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:57:20.603471 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_fields__dbt_backup"
[0m13:57:20.603830 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m13:57:20.604022 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."staging"."stg_fields__dbt_backup" cascade
[0m13:57:20.605201 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:57:20.606070 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m13:57:20.606461 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a91ee0>]}
[0m13:57:20.606862 [info ] [Thread-1  ]: 4 of 9 OK created sql table model staging.stg_fields ........................... [[32mSELECT 4[0m in 0.03s]
[0m13:57:20.607190 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m13:57:20.607417 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m13:57:20.607709 [info ] [Thread-1  ]: 5 of 9 START sql table model staging.stg_stages ................................ [RUN]
[0m13:57:20.607961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m13:57:20.608157 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m13:57:20.610108 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m13:57:20.610579 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m13:57:20.613673 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m13:57:20.614110 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:57:20.614315 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m13:57:20.614501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:20.625873 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m13:57:20.626173 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:57:20.626402 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

 select 
 stage_id,
 stage_name
  from "postgres"."public"."stages"
  );
  
[0m13:57:20.627874 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.001 seconds
[0m13:57:20.630158 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:57:20.630378 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m13:57:20.631643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:20.633449 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:57:20.633651 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m13:57:20.634505 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:20.635282 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:57:20.635492 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:57:20.635670 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:57:20.637392 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:57:20.638853 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_stages__dbt_backup"
[0m13:57:20.639152 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:57:20.639339 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."staging"."stg_stages__dbt_backup" cascade
[0m13:57:20.641975 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:57:20.642683 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m13:57:20.643027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa0fd0>]}
[0m13:57:20.643390 [info ] [Thread-1  ]: 5 of 9 OK created sql table model staging.stg_stages ........................... [[32mSELECT 9[0m in 0.04s]
[0m13:57:20.643707 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m13:57:20.644053 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m13:57:20.644509 [info ] [Thread-1  ]: 6 of 9 START sql table model staging.stg_users ................................. [RUN]
[0m13:57:20.644860 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m13:57:20.645075 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m13:57:20.647115 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m13:57:20.647589 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m13:57:20.649735 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m13:57:20.650288 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:57:20.650488 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m13:57:20.650672 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:20.660652 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m13:57:20.660943 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:57:20.661148 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  
    

  create  table "postgres"."staging"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as user_id,
 name as user_name,
 email as user_email,
 modified as modified_at
 from "postgres"."public"."users"
  );
  
[0m13:57:20.663392 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.002 seconds
[0m13:57:20.666496 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:57:20.666724 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."staging"."stg_users" rename to "stg_users__dbt_backup"
[0m13:57:20.667587 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:20.669456 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:57:20.669662 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:57:20.670937 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:20.671628 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:57:20.671817 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:57:20.671992 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:57:20.674356 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:57:20.675845 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_users__dbt_backup"
[0m13:57:20.676154 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:57:20.676340 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."staging"."stg_users__dbt_backup" cascade
[0m13:57:20.679802 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:57:20.680514 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m13:57:20.680876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109906670>]}
[0m13:57:20.681265 [info ] [Thread-1  ]: 6 of 9 OK created sql table model staging.stg_users ............................ [[32mSELECT 1787[0m in 0.04s]
[0m13:57:20.681583 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m13:57:20.681803 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m13:57:20.682051 [info ] [Thread-1  ]: 7 of 9 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m13:57:20.682406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now model.enpal_assessment_project.test_model)
[0m13:57:20.682631 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m13:57:20.684485 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m13:57:20.684955 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m13:57:20.687122 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m13:57:20.687549 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:57:20.687792 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m13:57:20.687999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:20.697900 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m13:57:20.698180 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:57:20.698384 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m13:57:20.701132 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m13:57:20.703291 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:57:20.703517 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m13:57:20.704607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:20.706478 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:57:20.706688 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m13:57:20.707882 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:20.708624 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:57:20.708824 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:57:20.709001 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:57:20.711541 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:57:20.713886 [debug] [Thread-1  ]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m13:57:20.714205 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:57:20.714399 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m13:57:20.716439 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:57:20.717148 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m13:57:20.717492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b01eb0>]}
[0m13:57:20.717863 [info ] [Thread-1  ]: 7 of 9 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 4579[0m in 0.04s]
[0m13:57:20.718176 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m13:57:20.718389 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal_stage_journey
[0m13:57:20.718665 [info ] [Thread-1  ]: 8 of 9 START sql table model ods.ods_deal_stage_journey ........................ [RUN]
[0m13:57:20.718892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now model.enpal_assessment_project.ods_deal_stage_journey)
[0m13:57:20.719082 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal_stage_journey
[0m13:57:20.721255 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:57:20.721701 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal_stage_journey
[0m13:57:20.723730 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:57:20.724140 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:57:20.724359 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: BEGIN
[0m13:57:20.724541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:20.735143 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m13:57:20.735461 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:57:20.735716 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */

  
    

  create  table "postgres"."ods"."ods_deal_stage_journey__dbt_tmp"
  
  
    as
  
  (
    

with stage_changes as (
    -- Filter only stage changes from deal_changes
    select
        deal_id,
        change_time_at,
        changed_field_key,
        new_value as stage_id_str
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'stage_id'
        and new_value is not null
        and deal_id is not null
),
stage_details as (
    select
        stage_id,
        stage_name
    from "postgres"."staging"."stg_stages"
),
enriched_journey as (
    select
        sc.deal_id,
        sc.change_time_at,
        cast(sc.stage_id_str as integer) as stage_id,
        sd.stage_name,
        -- Map to funnel steps (9 steps as per assessment)
        case
            when cast(sc.stage_id_str as integer) = 1 then 'Step 1: Lead Generation'
            when cast(sc.stage_id_str as integer) = 2 then 'Step 2: Qualified Lead'
            when cast(sc.stage_id_str as integer) = 3 then 'Step 3: Needs Assessment'
            when cast(sc.stage_id_str as integer) = 4 then 'Step 4: Proposal/Quote Preparation'
            when cast(sc.stage_id_str as integer) = 5 then 'Step 5: Negotiation'
            when cast(sc.stage_id_str as integer) = 6 then 'Step 6: Closing'
            when cast(sc.stage_id_str as integer) = 7 then 'Step 7: Implementation/Onboarding'
            when cast(sc.stage_id_str as integer) = 8 then 'Step 8: Follow-up/Customer Success'
            when cast(sc.stage_id_str as integer) = 9 then 'Step 9: Renewal/Expansion'
            else 'Unknown Stage'
        end as funnel_step,
        date_trunc('month', sc.change_time_at)::date as month,
        row_number() over (partition by sc.deal_id order by sc.change_time_at) as stage_sequence
    from stage_changes sc
    left join stage_details sd on cast(sc.stage_id_str as integer) = sd.stage_id
)
select
    deal_id,
    change_time_at,
    stage_id,
    stage_name,
    funnel_step,
    month,
    stage_sequence
from enriched_journey
where stage_id is not null
order by deal_id, change_time_at
  );
  
[0m13:57:20.751531 [debug] [Thread-1  ]: SQL status: SELECT 8906 in 0.016 seconds
[0m13:57:20.753823 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:57:20.754057 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */
alter table "postgres"."ods"."ods_deal_stage_journey" rename to "ods_deal_stage_journey__dbt_backup"
[0m13:57:20.754679 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:20.756653 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:57:20.756879 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */
alter table "postgres"."ods"."ods_deal_stage_journey__dbt_tmp" rename to "ods_deal_stage_journey"
[0m13:57:20.757419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:20.758223 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: COMMIT
[0m13:57:20.758439 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:57:20.758631 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: COMMIT
[0m13:57:20.760895 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:57:20.762596 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal_stage_journey__dbt_backup"
[0m13:57:20.762938 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m13:57:20.763148 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */
drop table if exists "postgres"."ods"."ods_deal_stage_journey__dbt_backup" cascade
[0m13:57:20.764445 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:57:20.765248 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: Close
[0m13:57:20.765617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b1ae20>]}
[0m13:57:20.766009 [info ] [Thread-1  ]: 8 of 9 OK created sql table model ods.ods_deal_stage_journey ................... [[32mSELECT 8906[0m in 0.05s]
[0m13:57:20.766345 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal_stage_journey
[0m13:57:20.766579 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal_activity_funnel
[0m13:57:20.766911 [info ] [Thread-1  ]: 9 of 9 START sql table model ods.ods_deal_activity_funnel ...................... [RUN]
[0m13:57:20.767195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal_stage_journey, now model.enpal_assessment_project.ods_deal_activity_funnel)
[0m13:57:20.767409 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal_activity_funnel
[0m13:57:20.769924 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m13:57:20.770427 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal_activity_funnel
[0m13:57:20.773662 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m13:57:20.774195 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m13:57:20.774397 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: BEGIN
[0m13:57:20.774579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:20.781982 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:57:20.782266 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m13:57:20.782582 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_funnel"} */

  
    

  create  table "postgres"."ods"."ods_deal_activity_funnel__dbt_tmp"
  
  
    as
  
  (
    

with activities as (
    select
        activity_id,
        activity_type,
        assigned_to_user,
        deal_id,
        done,
        due_to
    from "postgres"."staging"."stg_activity"
    where deal_id is not null
        and activity_type is not null
),

activity_type_details as (
    select
        activity_type_id,
        activity_name,
        activity_type
    from "postgres"."staging"."stg_activity_types"
),

user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),

enriched_activities as (
    select
        a.activity_id,
        a.deal_id,
        a.activity_type,
        atd.activity_name,
        -- Map activities to funnel sub-steps
        case
            when a.activity_type = 'meeting' then 'Step 2.1: Sales Call 1'
            when a.activity_type = 'sc_2' then 'Step 3.1: Sales Call 2'
            else 'Other Activity'
        end as funnel_step,
        -- Flag if activity is tracked in funnel KPIs
        case
            when a.activity_type in ('meeting', 'sc_2') then true
            else false
        end as is_funnel_tracked,
        a.assigned_to_user,
        ud.user_name,
        ud.user_email,
        a.done as is_completed,
        a.due_to,
        date_trunc('month', a.due_to)::date as month
    from activities a
    left join activity_type_details atd on a.activity_type = atd.activity_type
    left join user_details ud on a.assigned_to_user = ud.user_id
)

select
    activity_id,
    deal_id,
    activity_type,
    activity_name,
    funnel_step,
    is_funnel_tracked,
    assigned_to_user,
    user_name,
    user_email,
    is_completed,
    due_to,
    month
from enriched_activities
order by deal_id, due_to
  );
  
[0m13:57:20.790558 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.008 seconds
[0m13:57:20.793051 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m13:57:20.793288 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_funnel"} */
alter table "postgres"."ods"."ods_deal_activity_funnel__dbt_tmp" rename to "ods_deal_activity_funnel"
[0m13:57:20.793971 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:20.794718 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: COMMIT
[0m13:57:20.794934 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m13:57:20.795126 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: COMMIT
[0m13:57:20.796943 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:57:20.798578 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal_activity_funnel__dbt_backup"
[0m13:57:20.798916 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m13:57:20.799126 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_funnel"} */
drop table if exists "postgres"."ods"."ods_deal_activity_funnel__dbt_backup" cascade
[0m13:57:20.799671 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:57:20.800455 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: Close
[0m13:57:20.800837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5499b9d6-6b59-4029-993b-1d9eff443325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b1ae20>]}
[0m13:57:20.801246 [info ] [Thread-1  ]: 9 of 9 OK created sql table model ods.ods_deal_activity_funnel ................. [[32mSELECT 4579[0m in 0.03s]
[0m13:57:20.801586 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal_activity_funnel
[0m13:57:20.802299 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:20.802491 [debug] [MainThread]: On master: BEGIN
[0m13:57:20.802647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:20.809984 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:57:20.810244 [debug] [MainThread]: On master: COMMIT
[0m13:57:20.810416 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:20.810564 [debug] [MainThread]: On master: COMMIT
[0m13:57:20.810996 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:57:20.811193 [debug] [MainThread]: On master: Close
[0m13:57:20.811455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:20.811613 [debug] [MainThread]: Connection 'model.enpal_assessment_project.ods_deal_activity_funnel' was properly closed.
[0m13:57:20.811853 [info ] [MainThread]: 
[0m13:57:20.812041 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m13:57:20.813033 [debug] [MainThread]: Command end result
[0m13:57:20.833571 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m13:57:20.834731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:57:20.839319 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m13:57:20.839537 [info ] [MainThread]: 
[0m13:57:20.839756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:20.839930 [info ] [MainThread]: 
[0m13:57:20.840111 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m13:57:20.841198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2635146, "process_in_blocks": "0", "process_kernel_time": 0.185508, "process_mem_max_rss": "132055040", "process_out_blocks": "0", "process_user_time": 1.595669}
[0m13:57:20.841428 [debug] [MainThread]: Command `dbt run` succeeded at 13:57:20.841380 after 1.26 seconds
[0m13:57:20.841624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107277850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fca90>]}
[0m13:57:20.841823 [debug] [MainThread]: Flushing usage events
[0m13:57:21.389175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:04.878490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106313850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc4a90>]}


============================== 14:03:04.882081 | 8e806c0d-3cf2-489a-9b87-051e0b970455 ==============================
[0m14:03:04.882081 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:03:04.882435 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'empty': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'introspect': 'True', 'printer_width': '80'}
[0m14:03:04.997725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc4100>]}
[0m14:03:05.034243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c20af0>]}
[0m14:03:05.034946 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:03:05.107556 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:03:05.208131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m14:03:05.208531 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/ods/ods_deal_activity_funnel.yml
[0m14:03:05.208727 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/ods/ods_deal_activity_by_pipeline.sql
[0m14:03:05.208937 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/ods/ods_deal_activity_by_pipeline.yml
[0m14:03:05.209164 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/ods/ods_deal_stage_journey.yml
[0m14:03:05.489095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109537130>]}
[0m14:03:05.554762 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m14:03:05.556251 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:03:05.570095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109514760>]}
[0m14:03:05.570423 [info ] [MainThread]: Found 10 models, 20 data tests, 7 sources, 448 macros
[0m14:03:05.570645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955dac0>]}
[0m14:03:05.571828 [info ] [MainThread]: 
[0m14:03:05.572033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:05.572194 [info ] [MainThread]: 
[0m14:03:05.572483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:05.575275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:03:05.606288 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:03:05.606573 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:03:05.606733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:05.642331 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.036 seconds
[0m14:03:05.643206 [debug] [ThreadPool]: On list_postgres: Close
[0m14:03:05.645065 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:03:05.645362 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:03:05.645520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:05.654633 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m14:03:05.655342 [debug] [ThreadPool]: On list_postgres: Close
[0m14:03:05.656801 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:03:05.657037 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:03:05.657231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:05.665835 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m14:03:05.666570 [debug] [ThreadPool]: On list_postgres: Close
[0m14:03:05.667686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m14:03:05.671503 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:03:05.671711 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:03:05.671869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:05.681451 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:03:05.681690 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:03:05.681877 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:03:05.684892 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m14:03:05.685744 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:03:05.686182 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:03:05.686543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m14:03:05.688603 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m14:03:05.688804 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m14:03:05.688956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:05.696855 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:03:05.697082 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m14:03:05.697264 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m14:03:05.699523 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:03:05.700271 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m14:03:05.700707 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m14:03:05.701034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m14:03:05.702665 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m14:03:05.702861 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m14:03:05.703011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:05.709716 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:03:05.709963 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m14:03:05.710149 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m14:03:05.713175 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:03:05.713933 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m14:03:05.714425 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m14:03:05.718016 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:05.718269 [debug] [MainThread]: On master: BEGIN
[0m14:03:05.718425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:05.727765 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:03:05.727983 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:05.728200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:03:05.731555 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:03:05.732340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095374c0>]}
[0m14:03:05.732651 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:05.733212 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:05.733386 [debug] [MainThread]: On master: BEGIN
[0m14:03:05.734025 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:03:05.734197 [debug] [MainThread]: On master: COMMIT
[0m14:03:05.734358 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:05.734511 [debug] [MainThread]: On master: COMMIT
[0m14:03:05.734941 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:05.735146 [debug] [MainThread]: On master: Close
[0m14:03:05.742905 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity
[0m14:03:05.743364 [info ] [Thread-1  ]: 1 of 10 START sql table model staging.stg_activity ............................. [RUN]
[0m14:03:05.743689 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m14:03:05.743905 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity
[0m14:03:05.749583 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m14:03:05.750768 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity
[0m14:03:05.774588 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m14:03:05.775407 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m14:03:05.775613 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m14:03:05.775791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:05.786465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m14:03:05.786744 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m14:03:05.786954 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  
    

  create  table "postgres"."staging"."stg_activity__dbt_tmp"
  
  
    as
  
  (
    

 select 
 activity_id,
 type as activity_type,
 assigned_to_user,
 deal_id,
 done,
 due_to::timestamp as due_to
 from "postgres"."public"."activity"
  );
  
[0m14:03:05.791402 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.004 seconds
[0m14:03:05.797790 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m14:03:05.798034 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."staging"."stg_activity" rename to "stg_activity__dbt_backup"
[0m14:03:05.798751 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:05.800540 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m14:03:05.800747 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."staging"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m14:03:05.801211 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:05.810659 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m14:03:05.810890 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m14:03:05.811073 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m14:03:05.814049 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m14:03:05.818234 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_activity__dbt_backup"
[0m14:03:05.820580 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m14:03:05.820781 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop table if exists "postgres"."staging"."stg_activity__dbt_backup" cascade
[0m14:03:05.825889 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m14:03:05.827401 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity: Close
[0m14:03:05.828826 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104939370>]}
[0m14:03:05.829281 [info ] [Thread-1  ]: 1 of 10 OK created sql table model staging.stg_activity ........................ [[32mSELECT 4579[0m in 0.08s]
[0m14:03:05.829615 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity
[0m14:03:05.829836 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_activity_types
[0m14:03:05.830144 [info ] [Thread-1  ]: 2 of 10 START sql table model staging.stg_activity_types ....................... [RUN]
[0m14:03:05.830395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m14:03:05.830591 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m14:03:05.832628 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m14:03:05.833073 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m14:03:05.835377 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m14:03:05.836369 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m14:03:05.836639 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m14:03:05.836830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:05.849777 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m14:03:05.850107 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m14:03:05.850319 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  
    

  create  table "postgres"."staging"."stg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as activity_type_id,
 name as activity_name,
 active,
 type as activity_type from "postgres"."public"."activity_types"
  );
  
[0m14:03:05.851705 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.001 seconds
[0m14:03:05.854026 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m14:03:05.854261 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."staging"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m14:03:05.854867 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:05.856728 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m14:03:05.856934 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."staging"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m14:03:05.858362 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:05.859069 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m14:03:05.859265 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m14:03:05.859442 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m14:03:05.860736 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:03:05.862300 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_activity_types__dbt_backup"
[0m14:03:05.862644 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m14:03:05.862841 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop table if exists "postgres"."staging"."stg_activity_types__dbt_backup" cascade
[0m14:03:05.865169 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m14:03:05.865936 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_activity_types: Close
[0m14:03:05.866304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bcc6a0>]}
[0m14:03:05.866675 [info ] [Thread-1  ]: 2 of 10 OK created sql table model staging.stg_activity_types .................. [[32mSELECT 4[0m in 0.04s]
[0m14:03:05.866992 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m14:03:05.867209 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m14:03:05.867494 [info ] [Thread-1  ]: 3 of 10 START sql table model staging.stg_deal_changes ......................... [RUN]
[0m14:03:05.867727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m14:03:05.867917 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m14:03:05.869914 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:03:05.870393 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m14:03:05.873615 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m14:03:05.874093 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:03:05.874281 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m14:03:05.874449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:05.885194 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m14:03:05.885500 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:03:05.885705 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  
    

  create  table "postgres"."staging"."stg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

select
  deal_id,
  change_time::timestamp as change_time_at,
  changed_field_key,
  new_value
from "postgres"."public"."deal_changes"
  );
  
[0m14:03:05.893417 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.007 seconds
[0m14:03:05.895729 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:03:05.895972 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."staging"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m14:03:05.896712 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:05.898586 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:03:05.898797 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."staging"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m14:03:05.899317 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:05.900044 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:03:05.900245 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:03:05.900425 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m14:03:05.902866 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:03:05.904658 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_deal_changes__dbt_backup"
[0m14:03:05.904991 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m14:03:05.905191 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop table if exists "postgres"."staging"."stg_deal_changes__dbt_backup" cascade
[0m14:03:05.906515 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:03:05.907285 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m14:03:05.907642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bcc6a0>]}
[0m14:03:05.908029 [info ] [Thread-1  ]: 3 of 10 OK created sql table model staging.stg_deal_changes .................... [[32mSELECT 15406[0m in 0.04s]
[0m14:03:05.908352 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m14:03:05.908567 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_fields
[0m14:03:05.908860 [info ] [Thread-1  ]: 4 of 10 START sql table model staging.stg_fields ............................... [RUN]
[0m14:03:05.909111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m14:03:05.909302 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_fields
[0m14:03:05.911310 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m14:03:05.911824 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_fields
[0m14:03:05.914062 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m14:03:05.914491 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m14:03:05.914709 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m14:03:05.914892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:05.923547 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m14:03:05.923842 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m14:03:05.924045 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  
    

  create  table "postgres"."staging"."stg_fields__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as field_id,
 field_key as field_key,
 name as field_name,
 field_value_options
  from "postgres"."public"."fields"
  );
  
[0m14:03:05.926008 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.002 seconds
[0m14:03:05.929009 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m14:03:05.929230 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."staging"."stg_fields" rename to "stg_fields__dbt_backup"
[0m14:03:05.929825 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:05.931635 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m14:03:05.931842 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."staging"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m14:03:05.932347 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:05.933093 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m14:03:05.933298 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m14:03:05.933482 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m14:03:05.934555 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:03:05.936059 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_fields__dbt_backup"
[0m14:03:05.936374 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m14:03:05.936570 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop table if exists "postgres"."staging"."stg_fields__dbt_backup" cascade
[0m14:03:05.937767 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:03:05.938499 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_fields: Close
[0m14:03:05.938852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bcc6a0>]}
[0m14:03:05.939233 [info ] [Thread-1  ]: 4 of 10 OK created sql table model staging.stg_fields .......................... [[32mSELECT 4[0m in 0.03s]
[0m14:03:05.939547 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_fields
[0m14:03:05.939766 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_stages
[0m14:03:05.940045 [info ] [Thread-1  ]: 5 of 10 START sql table model staging.stg_stages ............................... [RUN]
[0m14:03:05.940282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m14:03:05.940469 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_stages
[0m14:03:05.942438 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m14:03:05.942876 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_stages
[0m14:03:05.945021 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m14:03:05.945405 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m14:03:05.945609 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m14:03:05.945793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:05.958015 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m14:03:05.958329 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m14:03:05.958530 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  
    

  create  table "postgres"."staging"."stg_stages__dbt_tmp"
  
  
    as
  
  (
    

 select 
 stage_id,
 stage_name
  from "postgres"."public"."stages"
  );
  
[0m14:03:05.959948 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.001 seconds
[0m14:03:05.962387 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m14:03:05.962662 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."staging"."stg_stages" rename to "stg_stages__dbt_backup"
[0m14:03:05.963419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:05.965488 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m14:03:05.965780 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."staging"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m14:03:05.966423 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:05.967236 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m14:03:05.967448 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m14:03:05.967634 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m14:03:05.968346 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:03:06.005478 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_stages__dbt_backup"
[0m14:03:06.005928 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m14:03:06.006130 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop table if exists "postgres"."staging"."stg_stages__dbt_backup" cascade
[0m14:03:06.007771 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:03:06.008607 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_stages: Close
[0m14:03:06.008969 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c256a0>]}
[0m14:03:06.009344 [info ] [Thread-1  ]: 5 of 10 OK created sql table model staging.stg_stages .......................... [[32mSELECT 9[0m in 0.07s]
[0m14:03:06.009661 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_stages
[0m14:03:06.009875 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.stg_users
[0m14:03:06.010150 [info ] [Thread-1  ]: 6 of 10 START sql table model staging.stg_users ................................ [RUN]
[0m14:03:06.010586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m14:03:06.010844 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.stg_users
[0m14:03:06.012998 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m14:03:06.013500 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.stg_users
[0m14:03:06.015687 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m14:03:06.016154 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m14:03:06.016519 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: BEGIN
[0m14:03:06.016711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:06.024073 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:03:06.024407 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m14:03:06.024599 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  
    

  create  table "postgres"."staging"."stg_users__dbt_tmp"
  
  
    as
  
  (
    

 select 
 id as user_id,
 name as user_name,
 email as user_email,
 modified as modified_at
 from "postgres"."public"."users"
  );
  
[0m14:03:06.027350 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.002 seconds
[0m14:03:06.029793 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m14:03:06.030014 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."staging"."stg_users" rename to "stg_users__dbt_backup"
[0m14:03:06.030750 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:06.032567 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m14:03:06.032770 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:03:06.033393 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:06.034134 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m14:03:06.034337 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m14:03:06.034517 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: COMMIT
[0m14:03:06.035992 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:03:06.037656 [debug] [Thread-1  ]: Applying DROP to: "postgres"."staging"."stg_users__dbt_backup"
[0m14:03:06.038018 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m14:03:06.038223 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop table if exists "postgres"."staging"."stg_users__dbt_backup" cascade
[0m14:03:06.040099 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m14:03:06.040971 [debug] [Thread-1  ]: On model.enpal_assessment_project.stg_users: Close
[0m14:03:06.041401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca2f10>]}
[0m14:03:06.041819 [info ] [Thread-1  ]: 6 of 10 OK created sql table model staging.stg_users ........................... [[32mSELECT 1787[0m in 0.03s]
[0m14:03:06.042128 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.stg_users
[0m14:03:06.042340 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m14:03:06.042664 [info ] [Thread-1  ]: 7 of 10 START sql table model pipedrive_analytics.test_model ................... [RUN]
[0m14:03:06.042920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now model.enpal_assessment_project.test_model)
[0m14:03:06.043221 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m14:03:06.045371 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m14:03:06.046226 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m14:03:06.049659 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m14:03:06.050111 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m14:03:06.050292 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m14:03:06.050456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:06.058144 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:03:06.058476 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m14:03:06.058695 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m14:03:06.061848 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.003 seconds
[0m14:03:06.064154 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m14:03:06.064378 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m14:03:06.065024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:06.066820 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m14:03:06.067020 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m14:03:06.067584 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:06.068341 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m14:03:06.068545 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m14:03:06.068724 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m14:03:06.070251 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:03:06.071937 [debug] [Thread-1  ]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m14:03:06.072323 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m14:03:06.072521 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m14:03:06.073841 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:03:06.074688 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m14:03:06.075052 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb2b80>]}
[0m14:03:06.075463 [info ] [Thread-1  ]: 7 of 10 OK created sql table model pipedrive_analytics.test_model .............. [[32mSELECT 4579[0m in 0.03s]
[0m14:03:06.075804 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m14:03:06.076027 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal_stage_journey
[0m14:03:06.076288 [info ] [Thread-1  ]: 8 of 10 START sql table model ods.ods_deal_stage_journey ....................... [RUN]
[0m14:03:06.076571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now model.enpal_assessment_project.ods_deal_stage_journey)
[0m14:03:06.076772 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal_stage_journey
[0m14:03:06.079190 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal_stage_journey"
[0m14:03:06.080048 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal_stage_journey
[0m14:03:06.082522 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal_stage_journey"
[0m14:03:06.083176 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m14:03:06.083380 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: BEGIN
[0m14:03:06.083560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:06.091628 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:03:06.091939 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m14:03:06.092203 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */

  
    

  create  table "postgres"."ods"."ods_deal_stage_journey__dbt_tmp"
  
  
    as
  
  (
    

with stage_changes as (
    -- Filter only stage changes from deal_changes
    select
        deal_id,
        change_time_at,
        changed_field_key,
        new_value as stage_id_str
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'stage_id'
        and new_value is not null
        and deal_id is not null
),
stage_details as (
    select
        stage_id,
        stage_name
    from "postgres"."staging"."stg_stages"
),
enriched_journey as (
    select
        sc.deal_id,
        sc.change_time_at,
        cast(sc.stage_id_str as integer) as stage_id,
        sd.stage_name,
        -- Map to funnel steps (9 steps as per assessment)
        case
            when cast(sc.stage_id_str as integer) = 1 then 'Step 1: Lead Generation'
            when cast(sc.stage_id_str as integer) = 2 then 'Step 2: Qualified Lead'
            when cast(sc.stage_id_str as integer) = 3 then 'Step 3: Needs Assessment'
            when cast(sc.stage_id_str as integer) = 4 then 'Step 4: Proposal/Quote Preparation'
            when cast(sc.stage_id_str as integer) = 5 then 'Step 5: Negotiation'
            when cast(sc.stage_id_str as integer) = 6 then 'Step 6: Closing'
            when cast(sc.stage_id_str as integer) = 7 then 'Step 7: Implementation/Onboarding'
            when cast(sc.stage_id_str as integer) = 8 then 'Step 8: Follow-up/Customer Success'
            when cast(sc.stage_id_str as integer) = 9 then 'Step 9: Renewal/Expansion'
            else 'Unknown Stage'
        end as funnel_step,
        date_trunc('month', sc.change_time_at)::date as month,
        row_number() over (partition by sc.deal_id order by sc.change_time_at) as stage_sequence
    from stage_changes sc
    left join stage_details sd on cast(sc.stage_id_str as integer) = sd.stage_id
)
select
    deal_id,
    change_time_at,
    stage_id,
    stage_name,
    funnel_step,
    month,
    stage_sequence
from enriched_journey
where stage_id is not null
order by deal_id, change_time_at
  );
  
[0m14:03:06.106522 [debug] [Thread-1  ]: SQL status: SELECT 8906 in 0.014 seconds
[0m14:03:06.109879 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m14:03:06.110119 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */
alter table "postgres"."ods"."ods_deal_stage_journey" rename to "ods_deal_stage_journey__dbt_backup"
[0m14:03:06.110753 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:06.112625 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m14:03:06.112841 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */
alter table "postgres"."ods"."ods_deal_stage_journey__dbt_tmp" rename to "ods_deal_stage_journey"
[0m14:03:06.113355 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:06.114079 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: COMMIT
[0m14:03:06.114284 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m14:03:06.114469 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: COMMIT
[0m14:03:06.116697 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:03:06.118307 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal_stage_journey__dbt_backup"
[0m14:03:06.118642 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_stage_journey"
[0m14:03:06.118843 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_stage_journey"} */
drop table if exists "postgres"."ods"."ods_deal_stage_journey__dbt_backup" cascade
[0m14:03:06.120449 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m14:03:06.121204 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_stage_journey: Close
[0m14:03:06.121554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb2b80>]}
[0m14:03:06.121942 [info ] [Thread-1  ]: 8 of 10 OK created sql table model ods.ods_deal_stage_journey .................. [[32mSELECT 8906[0m in 0.04s]
[0m14:03:06.122272 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal_stage_journey
[0m14:03:06.122495 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal_activity_funnel
[0m14:03:06.122825 [info ] [Thread-1  ]: 9 of 10 START sql table model ods.ods_deal_activity_funnel ..................... [RUN]
[0m14:03:06.123132 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal_stage_journey, now model.enpal_assessment_project.ods_deal_activity_funnel)
[0m14:03:06.123350 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal_activity_funnel
[0m14:03:06.125809 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m14:03:06.126326 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal_activity_funnel
[0m14:03:06.128675 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m14:03:06.129150 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m14:03:06.129340 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: BEGIN
[0m14:03:06.129513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:06.137100 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:03:06.137423 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m14:03:06.137693 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_funnel"} */

  
    

  create  table "postgres"."ods"."ods_deal_activity_funnel__dbt_tmp"
  
  
    as
  
  (
    

with activities as (
    select
        activity_id,
        activity_type,
        assigned_to_user,
        deal_id,
        done,
        due_to
    from "postgres"."staging"."stg_activity"
    where deal_id is not null
        and activity_type is not null
),

activity_type_details as (
    select
        activity_type_id,
        activity_name,
        activity_type
    from "postgres"."staging"."stg_activity_types"
),

user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),

enriched_activities as (
    select
        a.activity_id,
        a.deal_id,
        a.activity_type,
        atd.activity_name,
        -- Map activities to funnel sub-steps
        case
            when a.activity_type = 'meeting' then 'Step 2.1: Sales Call 1'
            when a.activity_type = 'sc_2' then 'Step 3.1: Sales Call 2'
            else 'Other Activity'
        end as funnel_step,
        -- Flag if activity is tracked in funnel KPIs
        case
            when a.activity_type in ('meeting', 'sc_2') then true
            else false
        end as is_funnel_tracked,
        a.assigned_to_user,
        ud.user_name,
        ud.user_email,
        a.done as is_completed,
        a.due_to,
        date_trunc('month', a.due_to)::date as month
    from activities a
    left join activity_type_details atd on a.activity_type = atd.activity_type
    left join user_details ud on a.assigned_to_user = ud.user_id
)

select
    activity_id,
    deal_id,
    activity_type,
    activity_name,
    funnel_step,
    is_funnel_tracked,
    assigned_to_user,
    user_name,
    user_email,
    is_completed,
    due_to,
    month
from enriched_activities
order by deal_id, due_to
  );
  
[0m14:03:06.146653 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.009 seconds
[0m14:03:06.149094 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m14:03:06.149336 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_funnel"} */
alter table "postgres"."ods"."ods_deal_activity_funnel" rename to "ods_deal_activity_funnel__dbt_backup"
[0m14:03:06.149991 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:06.151927 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m14:03:06.152145 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_funnel"} */
alter table "postgres"."ods"."ods_deal_activity_funnel__dbt_tmp" rename to "ods_deal_activity_funnel"
[0m14:03:06.152737 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:03:06.153539 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: COMMIT
[0m14:03:06.153755 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m14:03:06.153943 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: COMMIT
[0m14:03:06.155831 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:03:06.158630 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal_activity_funnel__dbt_backup"
[0m14:03:06.158977 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_funnel"
[0m14:03:06.159190 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_funnel"} */
drop table if exists "postgres"."ods"."ods_deal_activity_funnel__dbt_backup" cascade
[0m14:03:06.161097 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m14:03:06.161886 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_funnel: Close
[0m14:03:06.162268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c42a90>]}
[0m14:03:06.162672 [info ] [Thread-1  ]: 9 of 10 OK created sql table model ods.ods_deal_activity_funnel ................ [[32mSELECT 4579[0m in 0.04s]
[0m14:03:06.163008 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal_activity_funnel
[0m14:03:06.163436 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.ods_deal_activity_by_pipeline
[0m14:03:06.163750 [info ] [Thread-1  ]: 10 of 10 START sql table model ods.ods_deal_activity_by_pipeline ............... [RUN]
[0m14:03:06.164026 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.ods_deal_activity_funnel, now model.enpal_assessment_project.ods_deal_activity_by_pipeline)
[0m14:03:06.164238 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.ods_deal_activity_by_pipeline
[0m14:03:06.166561 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.ods_deal_activity_by_pipeline"
[0m14:03:06.167092 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.ods_deal_activity_by_pipeline
[0m14:03:06.169288 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.ods_deal_activity_by_pipeline"
[0m14:03:06.169885 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_by_pipeline"
[0m14:03:06.170144 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_by_pipeline: BEGIN
[0m14:03:06.170332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:06.178590 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:03:06.178888 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_by_pipeline"
[0m14:03:06.179116 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_by_pipeline: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_by_pipeline"} */

  
    

  create  table "postgres"."ods"."ods_deal_activity_by_pipeline__dbt_tmp"
  
  
    as
  
  (
    

with pipeline_deals as (
    -- Get all unique deals that have moved through pipeline stages
    select distinct deal_id
    from "postgres"."ods"."ods_deal_stage_journey"
),

funnel_activities as (
    select
        ea.activity_id,
        ea.deal_id,
        ea.activity_type,
        ea.activity_name,
        ea.funnel_step,
        ea.is_funnel_tracked,
        ea.assigned_to_user,
        ea.user_name,
        ea.due_to,
        ea.month
    from "postgres"."ods"."ods_deal_activity_funnel" ea
    inner join pipeline_deals pd on ea.deal_id = pd.deal_id
    where ea.is_funnel_tracked = true
)

select
    activity_id,
    deal_id,
    activity_type,
    activity_name,
    funnel_step,
    is_funnel_tracked,
    assigned_to_user,
    user_name,
    due_to,
    month
from funnel_activities
order by deal_id, due_to
  );
  
[0m14:03:06.183557 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.004 seconds
[0m14:03:06.185854 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_by_pipeline"
[0m14:03:06.186092 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_by_pipeline: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_by_pipeline"} */
alter table "postgres"."ods"."ods_deal_activity_by_pipeline__dbt_tmp" rename to "ods_deal_activity_by_pipeline"
[0m14:03:06.186845 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:06.187609 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_by_pipeline: COMMIT
[0m14:03:06.187828 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_by_pipeline"
[0m14:03:06.188017 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_by_pipeline: COMMIT
[0m14:03:06.189135 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:03:06.190893 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."ods_deal_activity_by_pipeline__dbt_backup"
[0m14:03:06.191263 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.ods_deal_activity_by_pipeline"
[0m14:03:06.191476 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_by_pipeline: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.ods_deal_activity_by_pipeline"} */
drop table if exists "postgres"."ods"."ods_deal_activity_by_pipeline__dbt_backup" cascade
[0m14:03:06.192121 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m14:03:06.192989 [debug] [Thread-1  ]: On model.enpal_assessment_project.ods_deal_activity_by_pipeline: Close
[0m14:03:06.193377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e806c0d-3cf2-489a-9b87-051e0b970455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c98b50>]}
[0m14:03:06.193787 [info ] [Thread-1  ]: 10 of 10 OK created sql table model ods.ods_deal_activity_by_pipeline .......... [[32mSELECT 4[0m in 0.03s]
[0m14:03:06.194133 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.ods_deal_activity_by_pipeline
[0m14:03:06.194870 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:06.195125 [debug] [MainThread]: On master: BEGIN
[0m14:03:06.195285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:06.202718 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:03:06.202996 [debug] [MainThread]: On master: COMMIT
[0m14:03:06.203179 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:06.203339 [debug] [MainThread]: On master: COMMIT
[0m14:03:06.204215 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:03:06.204404 [debug] [MainThread]: On master: Close
[0m14:03:06.204666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:06.204818 [debug] [MainThread]: Connection 'model.enpal_assessment_project.ods_deal_activity_by_pipeline' was properly closed.
[0m14:03:06.205047 [info ] [MainThread]: 
[0m14:03:06.205230 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m14:03:06.206287 [debug] [MainThread]: Command end result
[0m14:03:06.226807 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m14:03:06.228124 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:03:06.232679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m14:03:06.232873 [info ] [MainThread]: 
[0m14:03:06.233116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:06.233294 [info ] [MainThread]: 
[0m14:03:06.233476 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m14:03:06.234961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4033552, "process_in_blocks": "0", "process_kernel_time": 0.185843, "process_mem_max_rss": "134758400", "process_out_blocks": "0", "process_user_time": 1.733959}
[0m14:03:06.235215 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:06.235165 after 1.40 seconds
[0m14:03:06.235427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106313850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10316a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f7a00>]}
[0m14:03:06.235642 [debug] [MainThread]: Flushing usage events
[0m14:03:06.786543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:11.712663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548f340>]}


============================== 14:03:11.715147 | 12ef2e1a-bbe9-4b66-846e-e0abd3e9b819 ==============================
[0m14:03:11.715147 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:03:11.715487 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'write_json': 'True', 'empty': 'None', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:03:11.818312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12ef2e1a-bbe9-4b66-846e-e0abd3e9b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105419940>]}
[0m14:03:11.855748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12ef2e1a-bbe9-4b66-846e-e0abd3e9b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594e610>]}
[0m14:03:11.856434 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:03:11.926758 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:03:12.016102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:12.016344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:12.049720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12ef2e1a-bbe9-4b66-846e-e0abd3e9b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b0130>]}
[0m14:03:12.142654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m14:03:12.143732 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:03:12.157188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12ef2e1a-bbe9-4b66-846e-e0abd3e9b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b62d00>]}
[0m14:03:12.157492 [info ] [MainThread]: Found 10 models, 20 data tests, 7 sources, 448 macros
[0m14:03:12.157689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ef2e1a-bbe9-4b66-846e-e0abd3e9b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b42b0>]}
[0m14:03:12.159055 [info ] [MainThread]: 
[0m14:03:12.159252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:12.159411 [info ] [MainThread]: 
[0m14:03:12.159678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:12.162446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m14:03:12.188937 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m14:03:12.189208 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m14:03:12.189367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:12.207530 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m14:03:12.207755 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m14:03:12.207928 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m14:03:12.210327 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:03:12.211165 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m14:03:12.211661 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m14:03:12.212038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m14:03:12.213917 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:03:12.214260 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:03:12.214409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:12.222063 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:03:12.222297 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:03:12.222479 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:03:12.224350 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m14:03:12.225312 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:03:12.225767 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:03:12.226156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m14:03:12.227629 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m14:03:12.227829 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m14:03:12.228014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:12.235598 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:03:12.235836 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m14:03:12.236019 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m14:03:12.246054 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m14:03:12.246865 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m14:03:12.247289 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m14:03:12.250822 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:12.251054 [debug] [MainThread]: On master: BEGIN
[0m14:03:12.251210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:12.257823 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:03:12.258058 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:12.258305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:03:12.260487 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:03:12.261178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ef2e1a-bbe9-4b66-846e-e0abd3e9b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542a340>]}
[0m14:03:12.261471 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:12.261914 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:12.262081 [debug] [MainThread]: On master: BEGIN
[0m14:03:12.262735 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:03:12.262926 [debug] [MainThread]: On master: COMMIT
[0m14:03:12.263094 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:12.263247 [debug] [MainThread]: On master: COMMIT
[0m14:03:12.263678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:12.263863 [debug] [MainThread]: On master: Close
[0m14:03:12.265316 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62
[0m14:03:12.265581 [info ] [Thread-1  ]: 1 of 20 START test not_null_ods_deal_activity_by_pipeline_activity_id .......... [RUN]
[0m14:03:12.265855 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_ods, now test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62)
[0m14:03:12.266057 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62
[0m14:03:12.277996 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62"
[0m14:03:12.278735 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62
[0m14:03:12.289728 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62"
[0m14:03:12.290485 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62"
[0m14:03:12.290699 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62: BEGIN
[0m14:03:12.290880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.298289 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:03:12.298579 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62"
[0m14:03:12.298815 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."ods"."ods_deal_activity_by_pipeline"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.299791 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.302483 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62: ROLLBACK
[0m14:03:12.303023 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62: Close
[0m14:03:12.303414 [info ] [Thread-1  ]: 1 of 20 PASS not_null_ods_deal_activity_by_pipeline_activity_id ................ [[32mPASS[0m in 0.04s]
[0m14:03:12.303756 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62
[0m14:03:12.303988 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3
[0m14:03:12.304190 [info ] [Thread-1  ]: 2 of 20 START test not_null_ods_deal_activity_funnel_activity_id ............... [RUN]
[0m14:03:12.304500 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_ods_deal_activity_by_pipeline_activity_id.fb66677d62, now test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3)
[0m14:03:12.304691 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3
[0m14:03:12.308096 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3"
[0m14:03:12.308639 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3
[0m14:03:12.310181 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3"
[0m14:03:12.310808 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3"
[0m14:03:12.311021 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3: BEGIN
[0m14:03:12.311197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.318670 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:03:12.319015 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3"
[0m14:03:12.319241 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."ods"."ods_deal_activity_funnel"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.320450 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.321402 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3: ROLLBACK
[0m14:03:12.321869 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3: Close
[0m14:03:12.322236 [info ] [Thread-1  ]: 2 of 20 PASS not_null_ods_deal_activity_funnel_activity_id ..................... [[32mPASS[0m in 0.02s]
[0m14:03:12.322565 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3
[0m14:03:12.322789 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6
[0m14:03:12.322991 [info ] [Thread-1  ]: 3 of 20 START test not_null_ods_deal_stage_journey_change_time_at .............. [RUN]
[0m14:03:12.323244 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_ods_deal_activity_funnel_activity_id.18341dccc3, now test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6)
[0m14:03:12.323439 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6
[0m14:03:12.326106 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6"
[0m14:03:12.326713 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6
[0m14:03:12.328519 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6"
[0m14:03:12.329068 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6"
[0m14:03:12.329273 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6: BEGIN
[0m14:03:12.329449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.341064 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m14:03:12.341429 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6"
[0m14:03:12.341646 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_time_at
from "postgres"."ods"."ods_deal_stage_journey"
where change_time_at is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.344572 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m14:03:12.345773 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6: ROLLBACK
[0m14:03:12.346305 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6: Close
[0m14:03:12.346740 [info ] [Thread-1  ]: 3 of 20 PASS not_null_ods_deal_stage_journey_change_time_at .................... [[32mPASS[0m in 0.02s]
[0m14:03:12.347091 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6
[0m14:03:12.347326 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542
[0m14:03:12.347612 [info ] [Thread-1  ]: 4 of 20 START test not_null_ods_deal_stage_journey_deal_id ..................... [RUN]
[0m14:03:12.347857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_ods_deal_stage_journey_change_time_at.72f801efe6, now test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542)
[0m14:03:12.348073 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542
[0m14:03:12.351080 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542"
[0m14:03:12.351608 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542
[0m14:03:12.353206 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542"
[0m14:03:12.353582 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542"
[0m14:03:12.353852 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542: BEGIN
[0m14:03:12.354109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.361850 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:03:12.362174 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542"
[0m14:03:12.362427 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."ods"."ods_deal_stage_journey"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.363690 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.364723 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542: ROLLBACK
[0m14:03:12.365255 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542: Close
[0m14:03:12.365651 [info ] [Thread-1  ]: 4 of 20 PASS not_null_ods_deal_stage_journey_deal_id ........................... [[32mPASS[0m in 0.02s]
[0m14:03:12.365994 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542
[0m14:03:12.366223 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298
[0m14:03:12.366472 [info ] [Thread-1  ]: 5 of 20 START test not_null_ods_deal_stage_journey_stage_id .................... [RUN]
[0m14:03:12.366719 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_ods_deal_stage_journey_deal_id.6417591542, now test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298)
[0m14:03:12.366916 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298
[0m14:03:12.369484 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298"
[0m14:03:12.369963 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298
[0m14:03:12.372374 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298"
[0m14:03:12.372987 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298"
[0m14:03:12.373240 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298: BEGIN
[0m14:03:12.373430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.380698 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:03:12.381110 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298"
[0m14:03:12.381357 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."ods"."ods_deal_stage_journey"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.382763 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.383663 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298: ROLLBACK
[0m14:03:12.384111 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298: Close
[0m14:03:12.384476 [info ] [Thread-1  ]: 5 of 20 PASS not_null_ods_deal_stage_journey_stage_id .......................... [[32mPASS[0m in 0.02s]
[0m14:03:12.384802 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298
[0m14:03:12.385028 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m14:03:12.385265 [info ] [Thread-1  ]: 6 of 20 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m14:03:12.385507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_ods_deal_stage_journey_stage_id.7814c18298, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m14:03:12.385704 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m14:03:12.388330 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m14:03:12.389343 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m14:03:12.391080 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m14:03:12.391671 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m14:03:12.391878 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m14:03:12.392062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.399864 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:03:12.400137 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m14:03:12.400341 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."staging"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.401403 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.402323 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m14:03:12.402791 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m14:03:12.403186 [info ] [Thread-1  ]: 6 of 20 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.02s]
[0m14:03:12.403522 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m14:03:12.403746 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m14:03:12.403989 [info ] [Thread-1  ]: 7 of 20 START test not_null_stg_activity_deal_id ............................... [RUN]
[0m14:03:12.404232 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252)
[0m14:03:12.404429 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m14:03:12.407074 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m14:03:12.407543 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m14:03:12.409120 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m14:03:12.409591 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m14:03:12.409891 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: BEGIN
[0m14:03:12.410081 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.417653 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:03:12.417959 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m14:03:12.418172 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."staging"."stg_activity"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.419308 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.420262 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: ROLLBACK
[0m14:03:12.420777 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: Close
[0m14:03:12.421155 [info ] [Thread-1  ]: 7 of 20 PASS not_null_stg_activity_deal_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:03:12.421488 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m14:03:12.421718 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m14:03:12.421921 [info ] [Thread-1  ]: 8 of 20 START test not_null_stg_activity_types_activity_type_id ................ [RUN]
[0m14:03:12.422232 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m14:03:12.422432 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m14:03:12.425154 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m14:03:12.425646 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m14:03:12.427158 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m14:03:12.427572 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m14:03:12.427765 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m14:03:12.427942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.435618 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:03:12.435944 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m14:03:12.436225 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."staging"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.437108 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.438053 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m14:03:12.438519 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m14:03:12.438900 [info ] [Thread-1  ]: 8 of 20 PASS not_null_stg_activity_types_activity_type_id ...................... [[32mPASS[0m in 0.02s]
[0m14:03:12.439229 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m14:03:12.439454 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m14:03:12.439693 [info ] [Thread-1  ]: 9 of 20 START test not_null_stg_deal_changes_change_time_at .................... [RUN]
[0m14:03:12.440066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30)
[0m14:03:12.440298 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m14:03:12.443750 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m14:03:12.444238 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m14:03:12.445730 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m14:03:12.446097 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m14:03:12.446287 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: BEGIN
[0m14:03:12.446461 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.453764 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:03:12.454067 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"
[0m14:03:12.454281 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_time_at
from "postgres"."staging"."stg_deal_changes"
where change_time_at is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.455730 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.456719 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: ROLLBACK
[0m14:03:12.457208 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30: Close
[0m14:03:12.457585 [info ] [Thread-1  ]: 9 of 20 PASS not_null_stg_deal_changes_change_time_at .......................... [[32mPASS[0m in 0.02s]
[0m14:03:12.457912 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30
[0m14:03:12.458132 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m14:03:12.458329 [info ] [Thread-1  ]: 10 of 20 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m14:03:12.458577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_time_at.d538629b30, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m14:03:12.458775 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m14:03:12.461496 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m14:03:12.462045 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m14:03:12.463826 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m14:03:12.464235 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m14:03:12.464424 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m14:03:12.464593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.473654 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m14:03:12.473968 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m14:03:12.474216 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."staging"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.475726 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.476661 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m14:03:12.477113 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m14:03:12.477495 [info ] [Thread-1  ]: 10 of 20 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.02s]
[0m14:03:12.477842 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m14:03:12.478060 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m14:03:12.478261 [info ] [Thread-1  ]: 11 of 20 START test not_null_stg_fields_field_id ............................... [RUN]
[0m14:03:12.478579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5)
[0m14:03:12.478795 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m14:03:12.481386 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m14:03:12.481900 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m14:03:12.483434 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m14:03:12.483941 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m14:03:12.484163 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: BEGIN
[0m14:03:12.484329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.493997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m14:03:12.494318 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m14:03:12.494528 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_id
from "postgres"."staging"."stg_fields"
where field_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.495388 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.496307 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: ROLLBACK
[0m14:03:12.496763 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: Close
[0m14:03:12.497177 [info ] [Thread-1  ]: 11 of 20 PASS not_null_stg_fields_field_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:03:12.497512 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m14:03:12.497742 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m14:03:12.497940 [info ] [Thread-1  ]: 12 of 20 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m14:03:12.498187 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m14:03:12.498377 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m14:03:12.501253 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m14:03:12.501814 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m14:03:12.504367 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m14:03:12.504814 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m14:03:12.505013 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m14:03:12.505184 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.515796 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m14:03:12.516054 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m14:03:12.516252 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."staging"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.517170 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.518210 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m14:03:12.518685 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m14:03:12.519085 [info ] [Thread-1  ]: 12 of 20 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:03:12.519462 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m14:03:12.519687 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m14:03:12.519928 [info ] [Thread-1  ]: 13 of 20 START test not_null_stg_users_user_id ................................. [RUN]
[0m14:03:12.520169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m14:03:12.520363 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m14:03:12.523025 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m14:03:12.523516 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m14:03:12.525291 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m14:03:12.525767 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m14:03:12.525955 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:03:12.526131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.536099 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m14:03:12.536390 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m14:03:12.536599 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."staging"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:12.537590 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.538523 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:03:12.539013 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:03:12.539389 [info ] [Thread-1  ]: 13 of 20 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.02s]
[0m14:03:12.539718 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m14:03:12.539939 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5
[0m14:03:12.540142 [info ] [Thread-1  ]: 14 of 20 START test unique_ods_deal_activity_by_pipeline_activity_id ........... [RUN]
[0m14:03:12.540393 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5)
[0m14:03:12.540680 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5
[0m14:03:12.544745 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5"
[0m14:03:12.545258 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5
[0m14:03:12.546929 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5"
[0m14:03:12.547369 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5"
[0m14:03:12.547553 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5: BEGIN
[0m14:03:12.547726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.555938 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:03:12.556257 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5"
[0m14:03:12.556486 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."ods"."ods_deal_activity_by_pipeline"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:12.557481 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.558440 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5: ROLLBACK
[0m14:03:12.558946 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5: Close
[0m14:03:12.559347 [info ] [Thread-1  ]: 14 of 20 PASS unique_ods_deal_activity_by_pipeline_activity_id ................. [[32mPASS[0m in 0.02s]
[0m14:03:12.559669 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5
[0m14:03:12.559899 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66
[0m14:03:12.560192 [info ] [Thread-1  ]: 15 of 20 START test unique_ods_deal_activity_funnel_activity_id ................ [RUN]
[0m14:03:12.560508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_ods_deal_activity_by_pipeline_activity_id.9f411587b5, now test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66)
[0m14:03:12.560724 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66
[0m14:03:12.563417 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66"
[0m14:03:12.563904 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66
[0m14:03:12.565433 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66"
[0m14:03:12.565938 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66"
[0m14:03:12.566129 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66: BEGIN
[0m14:03:12.566295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.575156 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m14:03:12.575468 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66"
[0m14:03:12.575683 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."ods"."ods_deal_activity_funnel"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:12.577902 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m14:03:12.578900 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66: ROLLBACK
[0m14:03:12.579421 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66: Close
[0m14:03:12.579820 [error] [Thread-1  ]: 15 of 20 FAIL 11 unique_ods_deal_activity_funnel_activity_id ................... [[31mFAIL 11[0m in 0.02s]
[0m14:03:12.580173 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66
[0m14:03:12.580396 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m14:03:12.580661 [info ] [Thread-1  ]: 16 of 20 START test unique_stg_activity_activity_id ............................ [RUN]
[0m14:03:12.580949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_ods_deal_activity_funnel_activity_id.9204728b66, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m14:03:12.581153 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m14:03:12.584995 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m14:03:12.585885 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m14:03:12.587517 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m14:03:12.588154 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m14:03:12.588346 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m14:03:12.588524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.598434 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m14:03:12.598746 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m14:03:12.598939 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:12.601077 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m14:03:12.602129 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m14:03:12.602624 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m14:03:12.603050 [error] [Thread-1  ]: 16 of 20 FAIL 11 unique_stg_activity_activity_id ............................... [[31mFAIL 11[0m in 0.02s]
[0m14:03:12.603387 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m14:03:12.603613 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m14:03:12.603821 [info ] [Thread-1  ]: 17 of 20 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m14:03:12.604109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m14:03:12.604322 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m14:03:12.606961 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m14:03:12.607453 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m14:03:12.608993 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m14:03:12.609404 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m14:03:12.609608 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m14:03:12.609824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.619671 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m14:03:12.619958 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m14:03:12.620175 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:12.621165 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.622071 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m14:03:12.622514 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m14:03:12.622903 [info ] [Thread-1  ]: 17 of 20 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.02s]
[0m14:03:12.623231 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m14:03:12.623457 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m14:03:12.623687 [info ] [Thread-1  ]: 18 of 20 START test unique_stg_fields_field_id ................................. [RUN]
[0m14:03:12.623942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199)
[0m14:03:12.624149 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m14:03:12.626785 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m14:03:12.627257 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m14:03:12.628772 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m14:03:12.629144 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m14:03:12.629331 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: BEGIN
[0m14:03:12.629501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.639290 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m14:03:12.639585 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"
[0m14:03:12.639789 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    field_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_fields"
where field_id is not null
group by field_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:12.640796 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.641708 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: ROLLBACK
[0m14:03:12.642175 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199: Close
[0m14:03:12.642543 [info ] [Thread-1  ]: 18 of 20 PASS unique_stg_fields_field_id ....................................... [[32mPASS[0m in 0.02s]
[0m14:03:12.642871 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199
[0m14:03:12.643091 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m14:03:12.643328 [info ] [Thread-1  ]: 19 of 20 START test unique_stg_stages_stage_id ................................. [RUN]
[0m14:03:12.643563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_fields_field_id.c8559e3199, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m14:03:12.643758 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m14:03:12.646330 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m14:03:12.646783 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m14:03:12.649357 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m14:03:12.649817 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m14:03:12.649997 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m14:03:12.650160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.659892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m14:03:12.660216 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m14:03:12.660440 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:12.661403 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.662349 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m14:03:12.662775 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m14:03:12.663175 [info ] [Thread-1  ]: 19 of 20 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.02s]
[0m14:03:12.663509 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m14:03:12.663735 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m14:03:12.663935 [info ] [Thread-1  ]: 20 of 20 START test unique_stg_users_user_id ................................... [RUN]
[0m14:03:12.664224 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m14:03:12.664441 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m14:03:12.667204 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m14:03:12.667693 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m14:03:12.669242 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m14:03:12.669658 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m14:03:12.669986 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:03:12.670198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:03:12.681146 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m14:03:12.681479 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m14:03:12.681747 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:12.683386 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:12.684346 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:03:12.685353 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:03:12.685718 [info ] [Thread-1  ]: 20 of 20 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m14:03:12.686037 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m14:03:12.686714 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:12.686885 [debug] [MainThread]: On master: BEGIN
[0m14:03:12.687033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:12.694063 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:03:12.694349 [debug] [MainThread]: On master: COMMIT
[0m14:03:12.694535 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:12.694698 [debug] [MainThread]: On master: COMMIT
[0m14:03:12.695097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:12.695291 [debug] [MainThread]: On master: Close
[0m14:03:12.695533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:12.695686 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:03:12.695877 [info ] [MainThread]: 
[0m14:03:12.696055 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m14:03:12.697777 [debug] [MainThread]: Command end result
[0m14:03:12.718352 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m14:03:12.719828 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:03:12.725335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m14:03:12.725542 [info ] [MainThread]: 
[0m14:03:12.725765 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m14:03:12.725941 [info ] [MainThread]: 
[0m14:03:12.726149 [error] [MainThread]: [31mFailure in test unique_ods_deal_activity_funnel_activity_id (models/ods/ods_deal_activity_funnel.yml)[0m
[0m14:03:12.726346 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m14:03:12.726493 [info ] [MainThread]: 
[0m14:03:12.726682 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/ods/ods_deal_activity_funnel.yml/unique_ods_deal_activity_funnel_activity_id.sql
[0m14:03:12.726841 [info ] [MainThread]: 
[0m14:03:12.727029 [error] [MainThread]: [31mFailure in test unique_stg_activity_activity_id (models/staging/stg_activity.yml)[0m
[0m14:03:12.727212 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m14:03:12.727356 [info ] [MainThread]: 
[0m14:03:12.727534 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_activity.yml/unique_stg_activity_activity_id.sql
[0m14:03:12.727697 [info ] [MainThread]: 
[0m14:03:12.727872 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=20
[0m14:03:12.728975 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0571084, "process_in_blocks": "0", "process_kernel_time": 0.155343, "process_mem_max_rss": "129695744", "process_out_blocks": "0", "process_user_time": 1.481946}
[0m14:03:12.729197 [debug] [MainThread]: Command `dbt test` failed at 14:03:12.729151 after 1.06 seconds
[0m14:03:12.729411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b54be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b54880>]}
[0m14:03:12.729632 [debug] [MainThread]: Flushing usage events
[0m14:03:13.159915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:24.486272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104554850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd5490>]}


============================== 14:04:24.489733 | f03d1c04-f1e3-4225-bc1b-573b030f09d0 ==============================
[0m14:04:24.489733 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:04:24.490087 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt test -m stg_activity', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True'}
[0m14:04:24.490388 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:04:24.490595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f03d1c04-f1e3-4225-bc1b-573b030f09d0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480a9a0>]}
[0m14:04:24.607540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f03d1c04-f1e3-4225-bc1b-573b030f09d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb1550>]}
[0m14:04:24.642862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f03d1c04-f1e3-4225-bc1b-573b030f09d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd5670>]}
[0m14:04:24.643469 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:04:24.716087 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:04:24.816087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:04:24.816321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:04:24.852906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f03d1c04-f1e3-4225-bc1b-573b030f09d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af8130>]}
[0m14:04:24.951375 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m14:04:24.952746 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:04:24.970658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f03d1c04-f1e3-4225-bc1b-573b030f09d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3820>]}
[0m14:04:24.970979 [info ] [MainThread]: Found 10 models, 20 data tests, 7 sources, 448 macros
[0m14:04:24.971193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f03d1c04-f1e3-4225-bc1b-573b030f09d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a60910>]}
[0m14:04:24.972034 [info ] [MainThread]: 
[0m14:04:24.972223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:24.972379 [info ] [MainThread]: 
[0m14:04:24.972651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:04:24.975409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_ods'
[0m14:04:25.008211 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m14:04:25.008475 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m14:04:25.008627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:25.040805 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m14:04:25.041086 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m14:04:25.041274 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m14:04:25.043442 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:04:25.044387 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m14:04:25.044855 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m14:04:25.045241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m14:04:25.047292 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:04:25.047504 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:04:25.047661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:25.054929 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:04:25.055191 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:04:25.055384 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:04:25.057211 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m14:04:25.057999 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:04:25.058444 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:04:25.058759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_pipedrive_analytics)
[0m14:04:25.060139 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m14:04:25.060857 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m14:04:25.061013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:25.067826 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:04:25.068053 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m14:04:25.068245 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m14:04:25.069957 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:04:25.070641 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m14:04:25.071108 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m14:04:25.074534 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:25.074755 [debug] [MainThread]: On master: BEGIN
[0m14:04:25.074914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:25.088283 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:04:25.088545 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:25.088780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:04:25.090898 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:04:25.091648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f03d1c04-f1e3-4225-bc1b-573b030f09d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669a0a0>]}
[0m14:04:25.091965 [debug] [MainThread]: On master: ROLLBACK
[0m14:04:25.092422 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:25.092605 [debug] [MainThread]: On master: BEGIN
[0m14:04:25.093226 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:04:25.093412 [debug] [MainThread]: On master: COMMIT
[0m14:04:25.093583 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:25.093744 [debug] [MainThread]: On master: COMMIT
[0m14:04:25.094180 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:04:25.094405 [debug] [MainThread]: On master: Close
[0m14:04:25.096211 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m14:04:25.096457 [info ] [Thread-1  ]: 1 of 3 START test not_null_stg_activity_activity_id ............................ [RUN]
[0m14:04:25.096721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m14:04:25.096922 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m14:04:25.108000 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m14:04:25.108893 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m14:04:25.120460 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m14:04:25.121233 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m14:04:25.121466 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m14:04:25.121651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:25.137544 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m14:04:25.137908 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m14:04:25.138135 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."staging"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m14:04:25.139303 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:04:25.142495 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m14:04:25.143764 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m14:04:25.144220 [info ] [Thread-1  ]: 1 of 3 PASS not_null_stg_activity_activity_id .................................. [[32mPASS[0m in 0.05s]
[0m14:04:25.144551 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m14:04:25.144770 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m14:04:25.144972 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_activity_deal_id ................................ [RUN]
[0m14:04:25.145294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252)
[0m14:04:25.145540 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m14:04:25.149473 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m14:04:25.150066 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m14:04:25.151824 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m14:04:25.152339 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m14:04:25.152538 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: BEGIN
[0m14:04:25.152731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:25.163366 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m14:04:25.163668 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m14:04:25.163887 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."staging"."stg_activity"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m14:04:25.164965 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m14:04:25.165978 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: ROLLBACK
[0m14:04:25.166461 [debug] [Thread-1  ]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: Close
[0m14:04:25.166819 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_activity_deal_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:04:25.167148 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m14:04:25.167366 [debug] [Thread-1  ]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m14:04:25.167567 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_activity_activity_id .............................. [RUN]
[0m14:04:25.167877 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m14:04:25.168111 [debug] [Thread-1  ]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m14:04:25.172277 [debug] [Thread-1  ]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m14:04:25.172777 [debug] [Thread-1  ]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m14:04:25.174449 [debug] [Thread-1  ]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m14:04:25.174915 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m14:04:25.175109 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m14:04:25.175281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:25.183887 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m14:04:25.184193 [debug] [Thread-1  ]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m14:04:25.184448 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:04:25.186320 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m14:04:25.187295 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m14:04:25.187730 [debug] [Thread-1  ]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m14:04:25.188101 [error] [Thread-1  ]: 3 of 3 FAIL 11 unique_stg_activity_activity_id ................................. [[31mFAIL 11[0m in 0.02s]
[0m14:04:25.188437 [debug] [Thread-1  ]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m14:04:25.189169 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:25.189366 [debug] [MainThread]: On master: BEGIN
[0m14:04:25.189517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:25.205544 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:04:25.205863 [debug] [MainThread]: On master: COMMIT
[0m14:04:25.206050 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:25.206218 [debug] [MainThread]: On master: COMMIT
[0m14:04:25.206691 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:04:25.206954 [debug] [MainThread]: On master: Close
[0m14:04:25.207232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:25.207392 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9' was properly closed.
[0m14:04:25.207584 [info ] [MainThread]: 
[0m14:04:25.207768 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m14:04:25.208328 [debug] [MainThread]: Command end result
[0m14:04:25.229040 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m14:04:25.230336 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m14:04:25.234939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m14:04:25.235133 [info ] [MainThread]: 
[0m14:04:25.235360 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:04:25.235542 [info ] [MainThread]: 
[0m14:04:25.235756 [error] [MainThread]: [31mFailure in test unique_stg_activity_activity_id (models/staging/stg_activity.yml)[0m
[0m14:04:25.235960 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m14:04:25.236115 [info ] [MainThread]: 
[0m14:04:25.236303 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/stg_activity.yml/unique_stg_activity_activity_id.sql
[0m14:04:25.236464 [info ] [MainThread]: 
[0m14:04:25.236636 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:04:25.236953 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:04:25.238030 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.795422, "process_in_blocks": "0", "process_kernel_time": 0.170004, "process_mem_max_rss": "127942656", "process_out_blocks": "0", "process_user_time": 1.287889}
[0m14:04:25.238255 [debug] [MainThread]: Command `dbt test` failed at 14:04:25.238204 after 0.80 seconds
[0m14:04:25.238473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104554850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039563a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820f730>]}
[0m14:04:25.238681 [debug] [MainThread]: Flushing usage events
[0m14:04:25.654128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:37.711086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105227820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121053550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121053370>]}


============================== 16:55:37.714277 | f0354a58-e595-4f97-a4f8-23908bd60123 ==============================
[0m16:55:37.714277 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:55:37.714628 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt build -s master_deal', 'log_format': 'default', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False'}
[0m16:55:37.828804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0354a58-e595-4f97-a4f8-23908bd60123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120829ca0>]}
[0m16:55:37.864959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0354a58-e595-4f97-a4f8-23908bd60123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12158e130>]}
[0m16:55:37.865593 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:55:37.938487 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:55:38.038950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:55:38.039319 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/master/master_deal.sql
[0m16:55:38.229457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0354a58-e595-4f97-a4f8-23908bd60123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120828400>]}
[0m16:55:38.294658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m16:55:38.296390 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m16:55:38.316180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0354a58-e595-4f97-a4f8-23908bd60123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12214b310>]}
[0m16:55:38.316493 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m16:55:38.317585 [info ] [MainThread]: 
[0m16:55:38.317786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:38.317949 [info ] [MainThread]: 
[0m16:55:38.318223 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:55:38.318747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:55:38.353104 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:55:38.353384 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:55:38.353550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:38.461647 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.108 seconds
[0m16:55:38.462691 [debug] [ThreadPool]: On list_postgres: Close
[0m16:55:38.463198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m16:55:38.463554 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m16:55:38.468019 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m16:55:38.468286 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m16:55:38.468469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:38.478128 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:55:38.478428 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m16:55:38.478637 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m16:55:38.479292 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m16:55:38.479608 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m16:55:38.480273 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m16:55:38.480543 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:55:38.480759 [debug] [ThreadPool]: On create_postgres_: Close
[0m16:55:38.481250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:38.481433 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m16:55:38.481614 [info ] [MainThread]: 
[0m16:55:38.481816 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m16:55:38.482154 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m16:55:38.484006 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8183792, "process_in_blocks": "0", "process_kernel_time": 0.205969, "process_mem_max_rss": "130383872", "process_out_blocks": "0", "process_user_time": 1.309991}
[0m16:55:38.484335 [debug] [MainThread]: Command `dbt build` failed at 16:55:38.484268 after 0.82 seconds
[0m16:55:38.484592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105227820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221fc970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243704f0>]}
[0m16:55:38.484858 [debug] [MainThread]: Flushing usage events
[0m16:55:38.960484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:12.159424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107497820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f53550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f53370>]}


============================== 17:27:12.163650 | 316b5c73-d472-40b6-80b2-c3e4dd2294e0 ==============================
[0m17:27:12.163650 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:27:12.164215 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None', 'empty': 'False', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'quiet': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s master_deal', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True'}
[0m17:27:12.281529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '316b5c73-d472-40b6-80b2-c3e4dd2294e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f29ca0>]}
[0m17:27:12.316946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '316b5c73-d472-40b6-80b2-c3e4dd2294e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11948e130>]}
[0m17:27:12.317543 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:27:12.390886 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:27:12.491530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:27:12.491953 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m17:27:12.683949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '316b5c73-d472-40b6-80b2-c3e4dd2294e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0fcd30>]}
[0m17:27:12.751311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m17:27:12.752726 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m17:27:12.772426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '316b5c73-d472-40b6-80b2-c3e4dd2294e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194126a0>]}
[0m17:27:12.772754 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m17:27:12.773827 [info ] [MainThread]: 
[0m17:27:12.774024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:12.774184 [info ] [MainThread]: 
[0m17:27:12.774466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:27:12.774934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:27:12.806158 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:27:12.806437 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:27:12.806642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:12.905781 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.099 seconds
[0m17:27:12.906867 [debug] [ThreadPool]: On list_postgres: Close
[0m17:27:12.907410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m17:27:12.907790 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m17:27:12.912200 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m17:27:12.912463 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m17:27:12.912651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:12.922330 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:27:12.922653 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m17:27:12.922858 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m17:27:12.923519 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m17:27:12.923746 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m17:27:12.924298 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m17:27:12.924537 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:27:12.924745 [debug] [ThreadPool]: On create_postgres_: Close
[0m17:27:12.925271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:12.925487 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m17:27:12.925676 [info ] [MainThread]: 
[0m17:27:12.925921 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m17:27:12.926334 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m17:27:12.928064 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.81414074, "process_in_blocks": "0", "process_kernel_time": 0.190752, "process_mem_max_rss": "130269184", "process_out_blocks": "0", "process_user_time": 1.297434}
[0m17:27:12.928367 [debug] [MainThread]: Command `dbt build` failed at 17:27:12.928306 after 0.81 seconds
[0m17:27:12.928624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107497820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a05e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa76490>]}
[0m17:27:12.928884 [debug] [MainThread]: Flushing usage events
[0m17:27:13.356474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:54.175443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fc820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827b370>]}


============================== 18:09:54.178597 | 5d9c21d0-1f59-4cf9-9d82-5c4fecb6fe9c ==============================
[0m18:09:54.178597 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:09:54.178943 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'write_json': 'True', 'invocation_command': 'dbt build -s master_deal', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None'}
[0m18:09:54.294283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d9c21d0-1f59-4cf9-9d82-5c4fecb6fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b51ca0>]}
[0m18:09:54.329756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d9c21d0-1f59-4cf9-9d82-5c4fecb6fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891e130>]}
[0m18:09:54.330340 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:09:54.403728 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:09:54.504853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:09:54.505273 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:09:54.701572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d9c21d0-1f59-4cf9-9d82-5c4fecb6fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109364d30>]}
[0m18:09:54.767141 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:09:54.768559 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:09:54.789295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d9c21d0-1f59-4cf9-9d82-5c4fecb6fe9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877a6a0>]}
[0m18:09:54.789623 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:09:54.790705 [info ] [MainThread]: 
[0m18:09:54.790902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:54.791065 [info ] [MainThread]: 
[0m18:09:54.791342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:54.791806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:09:54.822502 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:09:54.822760 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:09:54.822918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:54.926889 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.104 seconds
[0m18:09:54.927858 [debug] [ThreadPool]: On list_postgres: Close
[0m18:09:54.928325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m18:09:54.928620 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m18:09:54.933052 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m18:09:54.933349 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m18:09:54.933532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:54.944939 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:09:54.945310 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m18:09:54.945537 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m18:09:54.946110 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m18:09:54.946364 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m18:09:54.946982 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m18:09:54.947215 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:09:54.947417 [debug] [ThreadPool]: On create_postgres_: Close
[0m18:09:54.948028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:54.948265 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m18:09:54.948508 [info ] [MainThread]: 
[0m18:09:54.948801 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:09:54.949197 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m18:09:54.950868 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8218263, "process_in_blocks": "0", "process_kernel_time": 0.197163, "process_mem_max_rss": "130908160", "process_out_blocks": "0", "process_user_time": 1.304259}
[0m18:09:54.951143 [debug] [MainThread]: Command `dbt build` failed at 18:09:54.951083 after 0.82 seconds
[0m18:09:54.951383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fc820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c6970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b8490>]}
[0m18:09:54.951640 [debug] [MainThread]: Flushing usage events
[0m18:09:55.513876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:03.964527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ad7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105845cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105845af0>]}


============================== 18:10:03.966951 | 4f5396d1-a4e6-4a6a-8d3a-7a4d9c7303f6 ==============================
[0m18:10:03.966951 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:10:03.967271 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'introspect': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'empty': 'False'}
[0m18:10:04.067477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f5396d1-a4e6-4a6a-8d3a-7a4d9c7303f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102137bb0>]}
[0m18:10:04.103105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f5396d1-a4e6-4a6a-8d3a-7a4d9c7303f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105808250>]}
[0m18:10:04.103630 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:10:04.173109 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:10:04.262856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:04.263108 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:04.296799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f5396d1-a4e6-4a6a-8d3a-7a4d9c7303f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737ae50>]}
[0m18:10:04.390760 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:10:04.391855 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:10:04.400464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f5396d1-a4e6-4a6a-8d3a-7a4d9c7303f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736f7f0>]}
[0m18:10:04.400756 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:10:04.400951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5396d1-a4e6-4a6a-8d3a-7a4d9c7303f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737abe0>]}
[0m18:10:04.402058 [info ] [MainThread]: 
[0m18:10:04.402256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:04.402417 [info ] [MainThread]: 
[0m18:10:04.402685 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:04.405576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:10:04.432714 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:10:04.433025 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:10:04.433187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:04.451799 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.019 seconds
[0m18:10:04.452600 [debug] [ThreadPool]: On list_postgres: Close
[0m18:10:04.454391 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:10:04.454632 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:10:04.454826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:04.462371 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m18:10:04.463125 [debug] [ThreadPool]: On list_postgres: Close
[0m18:10:04.464595 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:10:04.464797 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:10:04.464949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:04.472057 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m18:10:04.472911 [debug] [ThreadPool]: On list_postgres: Close
[0m18:10:04.474393 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:10:04.474605 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:10:04.474757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:04.482412 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m18:10:04.483186 [debug] [ThreadPool]: On list_postgres: Close
[0m18:10:04.483567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m18:10:04.483832 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m18:10:04.487667 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m18:10:04.487882 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m18:10:04.488028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:04.495189 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:10:04.495433 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m18:10:04.495597 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m18:10:04.496199 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m18:10:04.496497 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m18:10:04.497033 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m18:10:04.497234 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:10:04.497409 [debug] [ThreadPool]: On create_postgres_: Close
[0m18:10:04.497840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:04.498030 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m18:10:04.498209 [info ] [MainThread]: 
[0m18:10:04.498408 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:10:04.498704 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m18:10:04.499766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.57536423, "process_in_blocks": "0", "process_kernel_time": 0.131969, "process_mem_max_rss": "125911040", "process_out_blocks": "0", "process_user_time": 1.192028}
[0m18:10:04.500024 [debug] [MainThread]: Command `dbt run` failed at 18:10:04.499967 after 0.58 seconds
[0m18:10:04.500235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ad7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e9d00>]}
[0m18:10:04.500461 [debug] [MainThread]: Flushing usage events
[0m18:10:04.941196 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:11.294192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078337f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a4af0>]}


============================== 18:11:11.296658 | ceaa54fe-46cf-4899-bc95-8d14a3de9a2c ==============================
[0m18:11:11.296658 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:11:11.296985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'introspect': 'True', 'no_print': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m18:11:11.396479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceaa54fe-46cf-4899-bc95-8d14a3de9a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8c790>]}
[0m18:11:11.431984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceaa54fe-46cf-4899-bc95-8d14a3de9a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108868250>]}
[0m18:11:11.432543 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:11:11.501701 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:11:11.591070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:11:11.591479 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:11:11.780206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceaa54fe-46cf-4899-bc95-8d14a3de9a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a8c0d0>]}
[0m18:11:11.843596 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:11:11.844683 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:11:11.852497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceaa54fe-46cf-4899-bc95-8d14a3de9a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a60ca0>]}
[0m18:11:11.852788 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:11:11.852991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceaa54fe-46cf-4899-bc95-8d14a3de9a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4e5e0>]}
[0m18:11:11.854144 [info ] [MainThread]: 
[0m18:11:11.854347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:11.854513 [info ] [MainThread]: 
[0m18:11:11.854772 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:11:11.857644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:11:11.884303 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:11:11.884581 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:11:11.884746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:11.905239 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m18:11:11.906056 [debug] [ThreadPool]: On list_postgres: Close
[0m18:11:11.907715 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:11:11.907923 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:11:11.908091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:11.916576 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m18:11:11.917305 [debug] [ThreadPool]: On list_postgres: Close
[0m18:11:11.918758 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:11:11.918971 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:11:11.919125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:11.926285 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m18:11:11.927105 [debug] [ThreadPool]: On list_postgres: Close
[0m18:11:11.928638 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:11:11.928869 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:11:11.929077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:11.937884 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m18:11:11.938614 [debug] [ThreadPool]: On list_postgres: Close
[0m18:11:11.939171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m18:11:11.939544 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m18:11:11.943038 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m18:11:11.943233 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m18:11:11.943393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:11.952977 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:11:11.953233 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m18:11:11.953412 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m18:11:11.954088 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m18:11:11.954339 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m18:11:11.954844 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m18:11:11.955065 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:11:11.955243 [debug] [ThreadPool]: On create_postgres_: Close
[0m18:11:11.955657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:11.955820 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m18:11:11.955989 [info ] [MainThread]: 
[0m18:11:11.956175 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:11:11.956462 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m18:11:11.957640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.70629704, "process_in_blocks": "0", "process_kernel_time": 0.137379, "process_mem_max_rss": "130547712", "process_out_blocks": "0", "process_user_time": 1.309705}
[0m18:11:11.957884 [debug] [MainThread]: Command `dbt run` failed at 18:11:11.957831 after 0.71 seconds
[0m18:11:11.958099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078337f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0b580>]}
[0m18:11:11.958355 [debug] [MainThread]: Flushing usage events
[0m18:11:12.401091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:43.272135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103617820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c5b50>]}


============================== 18:12:43.274616 | cac2ea10-cfe8-45b3-ba7d-59c176803f69 ==============================
[0m18:12:43.274616 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:12:43.274932 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'warn_error': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False'}
[0m18:12:43.374927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cac2ea10-cfe8-45b3-ba7d-59c176803f69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101b5baf0>]}
[0m18:12:43.410547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cac2ea10-cfe8-45b3-ba7d-59c176803f69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588bcd0>]}
[0m18:12:43.411109 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:12:43.480177 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:12:43.570692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:12:43.571087 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:12:43.757590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cac2ea10-cfe8-45b3-ba7d-59c176803f69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105953be0>]}
[0m18:12:43.820571 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:12:43.821843 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:12:43.833684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cac2ea10-cfe8-45b3-ba7d-59c176803f69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c4970>]}
[0m18:12:43.833993 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:12:43.834195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cac2ea10-cfe8-45b3-ba7d-59c176803f69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517d490>]}
[0m18:12:43.835351 [info ] [MainThread]: 
[0m18:12:43.835552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:43.835713 [info ] [MainThread]: 
[0m18:12:43.835980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:43.838855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:12:43.869998 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:12:43.870281 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:12:43.870447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:43.890665 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m18:12:43.891477 [debug] [ThreadPool]: On list_postgres: Close
[0m18:12:43.893206 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:12:43.893414 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:12:43.893579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:43.901848 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m18:12:43.902605 [debug] [ThreadPool]: On list_postgres: Close
[0m18:12:43.904011 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:12:43.904227 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:12:43.904425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:43.911668 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m18:12:43.912426 [debug] [ThreadPool]: On list_postgres: Close
[0m18:12:43.913972 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:12:43.914201 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:12:43.914386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:43.923286 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m18:12:43.924038 [debug] [ThreadPool]: On list_postgres: Close
[0m18:12:43.924428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_)
[0m18:12:43.924708 [debug] [ThreadPool]: Creating schema "database: "postgres"
"
[0m18:12:43.928092 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m18:12:43.928309 [debug] [ThreadPool]: On create_postgres_: BEGIN
[0m18:12:43.928468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:43.936585 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:12:43.936823 [debug] [ThreadPool]: Using postgres connection "create_postgres_"
[0m18:12:43.937024 [debug] [ThreadPool]: On create_postgres_: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_"} */
create schema if not exists ""
[0m18:12:43.937673 [debug] [ThreadPool]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 2: create schema if not exists ""
                                    ^

[0m18:12:43.937918 [debug] [ThreadPool]: On create_postgres_: ROLLBACK
[0m18:12:43.938408 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m18:12:43.938627 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:12:43.938806 [debug] [ThreadPool]: On create_postgres_: Close
[0m18:12:43.939230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:43.939397 [debug] [MainThread]: Connection 'create_postgres_' was properly closed.
[0m18:12:43.939565 [info ] [MainThread]: 
[0m18:12:43.939752 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m18:12:43.940044 [error] [MainThread]: Encountered an error:
Database Error
  zero-length delimited identifier at or near """"
  LINE 2: create schema if not exists ""
                                      ^
[0m18:12:43.941160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7112089, "process_in_blocks": "0", "process_kernel_time": 0.14241, "process_mem_max_rss": "129400832", "process_out_blocks": "0", "process_user_time": 1.302738}
[0m18:12:43.941406 [debug] [MainThread]: Command `dbt run` failed at 18:12:43.941353 after 0.71 seconds
[0m18:12:43.941625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103617820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106389520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0f5b0>]}
[0m18:12:43.941855 [debug] [MainThread]: Flushing usage events
[0m18:12:44.398984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:13.761579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cad7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111853310>]}


============================== 18:17:13.765029 | 9d069676-2937-44f6-8579-6f18e789abbc ==============================
[0m18:17:13.765029 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:17:13.765414 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt build -s master_deal', 'empty': 'False', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'fail_fast': 'False', 'target_path': 'None'}
[0m18:17:13.880556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d069676-2937-44f6-8579-6f18e789abbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e6a30>]}
[0m18:17:13.915884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d069676-2937-44f6-8579-6f18e789abbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d23940>]}
[0m18:17:13.916516 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:17:13.989504 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:17:14.068545 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:17:14.068906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d069676-2937-44f6-8579-6f18e789abbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e65e0>]}
[0m18:17:14.848015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d069676-2937-44f6-8579-6f18e789abbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114364130>]}
[0m18:17:14.940037 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:17:14.941607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:17:14.961625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d069676-2937-44f6-8579-6f18e789abbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd5820>]}
[0m18:17:14.961952 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:17:14.963041 [info ] [MainThread]: 
[0m18:17:14.963243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:14.963406 [info ] [MainThread]: 
[0m18:17:14.963678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:14.964143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:17:14.995274 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:17:14.995552 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:17:14.995719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:15.028825 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.033 seconds
[0m18:17:15.029656 [debug] [ThreadPool]: On list_postgres: Close
[0m18:17:15.033000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m18:17:15.036853 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:17:15.037046 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:17:15.037195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:15.047818 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:17:15.048037 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:17:15.048220 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:17:15.054836 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m18:17:15.055596 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:17:15.056067 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:17:15.056386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_ods)
[0m18:17:15.058439 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:17:15.058675 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:17:15.058842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:15.066519 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:17:15.066755 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:17:15.066941 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:17:15.069202 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m18:17:15.069955 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:17:15.070379 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:17:15.070687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m18:17:15.072392 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:17:15.072602 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:17:15.072759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:15.079894 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:17:15.080154 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:17:15.080343 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:17:15.082483 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:17:15.083246 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:17:15.083708 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:17:15.087510 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:15.087755 [debug] [MainThread]: On master: BEGIN
[0m18:17:15.087916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:15.095314 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:17:15.095576 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:15.095796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:17:15.098765 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m18:17:15.099494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d069676-2937-44f6-8579-6f18e789abbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c2beb0>]}
[0m18:17:15.099779 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:15.100239 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:15.100441 [debug] [MainThread]: On master: BEGIN
[0m18:17:15.101177 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:17:15.101380 [debug] [MainThread]: On master: COMMIT
[0m18:17:15.101552 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:15.101708 [debug] [MainThread]: On master: COMMIT
[0m18:17:15.102210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:17:15.102393 [debug] [MainThread]: On master: Close
[0m18:17:15.104805 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:17:15.105151 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:17:15.105423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.master_deal)
[0m18:17:15.105627 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:17:15.112064 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:17:15.112744 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:17:15.137084 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:17:15.137894 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:17:15.138182 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:17:15.138375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:17:15.151962 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m18:17:15.152247 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:17:15.152617 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date
        -- Derived Metrics
       -- datediff(day, ls.latest_stage_change_at::date, current_date) as days_in_current_stage,
       -- datediff(day, fs.first_stage_entered_at::date, current_date) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:17:15.188733 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.036 seconds
[0m18:17:15.196954 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:17:15.197273 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */
alter table "postgres"."ods"."master_deal__dbt_tmp" rename to "master_deal"
[0m18:17:15.198565 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:17:15.208378 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: COMMIT
[0m18:17:15.208746 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:17:15.208986 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: COMMIT
[0m18:17:15.211270 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m18:17:15.215695 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."master_deal__dbt_backup"
[0m18:17:15.218283 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:17:15.218509 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */
drop table if exists "postgres"."ods"."master_deal__dbt_backup" cascade
[0m18:17:15.219077 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m18:17:15.220619 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:17:15.221981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d069676-2937-44f6-8579-6f18e789abbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146a3160>]}
[0m18:17:15.222416 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ods.master_deal .............................. [[32mSELECT 1995[0m in 0.12s]
[0m18:17:15.222760 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:17:15.223533 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:15.223764 [debug] [MainThread]: On master: BEGIN
[0m18:17:15.223935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:15.231678 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:17:15.231945 [debug] [MainThread]: On master: COMMIT
[0m18:17:15.232176 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:15.232421 [debug] [MainThread]: On master: COMMIT
[0m18:17:15.232991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:17:15.233297 [debug] [MainThread]: On master: Close
[0m18:17:15.233584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:15.233747 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:17:15.233918 [info ] [MainThread]: 
[0m18:17:15.234103 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m18:17:15.234501 [debug] [MainThread]: Command end result
[0m18:17:15.254100 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:17:15.255273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:17:15.259359 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:17:15.259564 [info ] [MainThread]: 
[0m18:17:15.259802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:15.259973 [info ] [MainThread]: 
[0m18:17:15.260155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:17:15.261478 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5452545, "process_in_blocks": "0", "process_kernel_time": 0.183447, "process_mem_max_rss": "136970240", "process_out_blocks": "0", "process_user_time": 2.012915}
[0m18:17:15.261727 [debug] [MainThread]: Command `dbt build` succeeded at 18:17:15.261680 after 1.55 seconds
[0m18:17:15.261942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cad7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111678ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114154a30>]}
[0m18:17:15.262174 [debug] [MainThread]: Flushing usage events
[0m18:17:15.694688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:23:31.432212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108557490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085572b0>]}


============================== 18:23:31.435289 | 1f44c4b4-30ea-4a5a-9e20-bf4ad6d76e13 ==============================
[0m18:23:31.435289 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:23:31.435634 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'empty': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt build -s master_deal', 'static_parser': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs'}
[0m18:23:31.548799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f44c4b4-30ea-4a5a-9e20-bf4ad6d76e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a284f0>]}
[0m18:23:31.584346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f44c4b4-30ea-4a5a-9e20-bf4ad6d76e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c03400>]}
[0m18:23:31.585362 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:23:31.658481 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:23:31.757158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:23:31.757583 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:23:31.947469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f44c4b4-30ea-4a5a-9e20-bf4ad6d76e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108557d00>]}
[0m18:23:32.011857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:23:32.013193 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:23:32.032677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f44c4b4-30ea-4a5a-9e20-bf4ad6d76e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095acac0>]}
[0m18:23:32.032995 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:23:32.034072 [info ] [MainThread]: 
[0m18:23:32.034266 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:32.034426 [info ] [MainThread]: 
[0m18:23:32.034703 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:32.035149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:23:32.066224 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:23:32.066524 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:23:32.066685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:32.100159 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.033 seconds
[0m18:23:32.100983 [debug] [ThreadPool]: On list_postgres: Close
[0m18:23:32.104280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m18:23:32.108163 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:23:32.108352 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:23:32.108504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:32.119582 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:23:32.119851 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:23:32.120034 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:23:32.122429 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:23:32.123334 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:23:32.123789 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:23:32.124160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m18:23:32.125585 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:23:32.126146 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:23:32.126308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:32.134025 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:23:32.134304 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:23:32.134503 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:23:32.136252 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:23:32.137028 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:23:32.137515 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:23:32.137839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_pipedrive_analytics)
[0m18:23:32.139636 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:23:32.140302 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:23:32.140458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:32.147796 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:23:32.148044 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:23:32.148242 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:23:32.150131 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:23:32.150856 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:23:32.151280 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:23:32.154783 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.155032 [debug] [MainThread]: On master: BEGIN
[0m18:23:32.155190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:32.162118 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:23:32.162401 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.162635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:23:32.164786 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:23:32.165502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f44c4b4-30ea-4a5a-9e20-bf4ad6d76e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b74100>]}
[0m18:23:32.165797 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:32.166245 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.166435 [debug] [MainThread]: On master: BEGIN
[0m18:23:32.167111 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:23:32.167296 [debug] [MainThread]: On master: COMMIT
[0m18:23:32.167465 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.167649 [debug] [MainThread]: On master: COMMIT
[0m18:23:32.168047 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:32.168219 [debug] [MainThread]: On master: Close
[0m18:23:32.170006 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:23:32.170367 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:23:32.170650 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.master_deal)
[0m18:23:32.170852 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:23:32.177347 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:23:32.177871 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:23:32.201258 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:23:32.201935 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:23:32.202148 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:23:32.202330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:32.214232 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m18:23:32.214443 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:23:32.214773 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       datediff(day, ls.latest_stage_change_at::date, current_date) as days_in_current_stage,
       datediff(day, fs.first_stage_entered_at::date, current_date) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:23:32.216568 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "day" does not exist
LINE 146:        datediff(day, ls.latest_stage_change_at::date, curren...
                          ^

[0m18:23:32.216818 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:23:32.217317 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:23:32.232591 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146:        datediff(day, ls.latest_stage_change_at::date, curren...
                            ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:23:32.233898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f44c4b4-30ea-4a5a-9e20-bf4ad6d76e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f6fa0>]}
[0m18:23:32.234308 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:23:32.234640 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:23:32.234949 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146:        datediff(day, ls.latest_stage_change_at::date, curren...
                            ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:23:32.235563 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.235746 [debug] [MainThread]: On master: BEGIN
[0m18:23:32.235891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:32.246239 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m18:23:32.246539 [debug] [MainThread]: On master: COMMIT
[0m18:23:32.246713 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.246870 [debug] [MainThread]: On master: COMMIT
[0m18:23:32.247329 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:32.247609 [debug] [MainThread]: On master: Close
[0m18:23:32.247877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:32.248036 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:23:32.248221 [info ] [MainThread]: 
[0m18:23:32.248402 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m18:23:32.248820 [debug] [MainThread]: Command end result
[0m18:23:32.268421 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:23:32.269611 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:23:32.273802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:23:32.274053 [info ] [MainThread]: 
[0m18:23:32.274279 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:23:32.274462 [info ] [MainThread]: 
[0m18:23:32.274678 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:23:32.274887 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146:        datediff(day, ls.latest_stage_change_at::date, curren...
                            ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:23:32.275055 [info ] [MainThread]: 
[0m18:23:32.275244 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:23:32.275399 [info ] [MainThread]: 
[0m18:23:32.275573 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:23:32.276616 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.88688415, "process_in_blocks": "0", "process_kernel_time": 0.172017, "process_mem_max_rss": "132005888", "process_out_blocks": "0", "process_user_time": 1.406293}
[0m18:23:32.276848 [debug] [MainThread]: Command `dbt build` failed at 18:23:32.276801 after 0.89 seconds
[0m18:23:32.277062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a284f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4dbb0>]}
[0m18:23:32.277279 [debug] [MainThread]: Flushing usage events
[0m18:23:32.719550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:23:54.838945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105579760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f7400>]}


============================== 18:23:54.841467 | 24fbcf16-0688-4518-9fe0-de3c59842a4a ==============================
[0m18:23:54.841467 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:23:54.841808 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'invocation_command': 'dbt build -s master_deal', 'fail_fast': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'partial_parse': 'True'}
[0m18:23:54.941952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24fbcf16-0688-4518-9fe0-de3c59842a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026d31c0>]}
[0m18:23:54.977546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24fbcf16-0688-4518-9fe0-de3c59842a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecefa0>]}
[0m18:23:54.978055 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:23:55.046595 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:23:55.135050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:23:55.135437 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:23:55.322004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24fbcf16-0688-4518-9fe0-de3c59842a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c04c0>]}
[0m18:23:55.385903 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:23:55.387035 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:23:55.401451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24fbcf16-0688-4518-9fe0-de3c59842a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104065910>]}
[0m18:23:55.401769 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:23:55.402848 [info ] [MainThread]: 
[0m18:23:55.403044 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:55.403213 [info ] [MainThread]: 
[0m18:23:55.403482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:55.403947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:23:55.432304 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:23:55.432601 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:23:55.432763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:55.452216 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.019 seconds
[0m18:23:55.453026 [debug] [ThreadPool]: On list_postgres: Close
[0m18:23:55.456369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m18:23:55.460134 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:23:55.460329 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:23:55.460482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:55.470350 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:23:55.470590 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:23:55.470829 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:23:55.472848 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:23:55.473636 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:23:55.474090 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:23:55.474429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m18:23:55.475797 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:23:55.476342 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:23:55.476495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:55.483612 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:23:55.483858 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:23:55.484049 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:23:55.485828 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:23:55.486835 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:23:55.487277 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:23:55.487614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_pipedrive_analytics)
[0m18:23:55.489441 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:23:55.490139 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:23:55.490303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:55.500072 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:23:55.500327 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:23:55.500524 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:23:55.502266 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:23:55.503000 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:23:55.503415 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:23:55.506903 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:55.507130 [debug] [MainThread]: On master: BEGIN
[0m18:23:55.507286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:55.514436 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:23:55.514696 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:55.514949 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:23:55.517160 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:23:55.517915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24fbcf16-0688-4518-9fe0-de3c59842a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe3430>]}
[0m18:23:55.518204 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:55.518639 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:55.518798 [debug] [MainThread]: On master: BEGIN
[0m18:23:55.519457 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:23:55.519648 [debug] [MainThread]: On master: COMMIT
[0m18:23:55.519817 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:55.519976 [debug] [MainThread]: On master: COMMIT
[0m18:23:55.520418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:55.520609 [debug] [MainThread]: On master: Close
[0m18:23:55.522088 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:23:55.522456 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:23:55.522732 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.master_deal)
[0m18:23:55.522943 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:23:55.529202 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:23:55.529740 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:23:55.553433 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:23:55.554138 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:23:55.554362 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:23:55.554551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:55.565555 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:23:55.565782 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:23:55.566106 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       datediff('day', ls.latest_stage_change_at::date, current_date) as days_in_current_stage,
       datediff('day', fs.first_stage_entered_at::date, current_date) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:23:55.568069 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function datediff(unknown, date, date) does not exist
LINE 146:        datediff('day', ls.latest_stage_change_at::date, curr...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:23:55.568304 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:23:55.569308 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:23:55.582235 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, date, date) does not exist
  LINE 146:        datediff('day', ls.latest_stage_change_at::date, curr...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:23:55.583567 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24fbcf16-0688-4518-9fe0-de3c59842a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d72700>]}
[0m18:23:55.583971 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:23:55.584309 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:23:55.584644 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, date, date) does not exist
  LINE 146:        datediff('day', ls.latest_stage_change_at::date, curr...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:23:55.585275 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:55.585452 [debug] [MainThread]: On master: BEGIN
[0m18:23:55.585604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:55.594661 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:23:55.594921 [debug] [MainThread]: On master: COMMIT
[0m18:23:55.595295 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:55.595545 [debug] [MainThread]: On master: COMMIT
[0m18:23:55.596084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:55.596275 [debug] [MainThread]: On master: Close
[0m18:23:55.596542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:55.596695 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:23:55.596859 [info ] [MainThread]: 
[0m18:23:55.597030 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:23:55.597417 [debug] [MainThread]: Command end result
[0m18:23:55.617600 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:23:55.618834 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:23:55.623273 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:23:55.623501 [info ] [MainThread]: 
[0m18:23:55.623732 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:23:55.623926 [info ] [MainThread]: 
[0m18:23:55.624133 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:23:55.624348 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, date, date) does not exist
  LINE 146:        datediff('day', ls.latest_stage_change_at::date, curr...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:23:55.624577 [info ] [MainThread]: 
[0m18:23:55.624810 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:23:55.624987 [info ] [MainThread]: 
[0m18:23:55.625173 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:23:55.626472 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.82883245, "process_in_blocks": "0", "process_kernel_time": 0.152177, "process_mem_max_rss": "133677056", "process_out_blocks": "0", "process_user_time": 1.409118}
[0m18:23:55.626714 [debug] [MainThread]: Command `dbt build` failed at 18:23:55.626666 after 0.83 seconds
[0m18:23:55.626956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105579760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107593880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105865070>]}
[0m18:23:55.627178 [debug] [MainThread]: Flushing usage events
[0m18:23:56.086272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:52.903122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a17460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a17280>]}


============================== 18:24:52.906079 | 70c6fdae-7183-40bb-b8ee-08ec27cb18a6 ==============================
[0m18:24:52.906079 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:24:52.906424 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None', 'invocation_command': 'dbt build -s master_deal', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'quiet': 'False', 'printer_width': '80', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'static_parser': 'True'}
[0m18:24:53.007736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70c6fdae-7183-40bb-b8ee-08ec27cb18a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef61f0>]}
[0m18:24:53.042911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70c6fdae-7183-40bb-b8ee-08ec27cb18a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100af31c0>]}
[0m18:24:53.043957 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:24:53.114970 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:24:53.207925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:53.208329 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:24:53.398041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70c6fdae-7183-40bb-b8ee-08ec27cb18a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102467220>]}
[0m18:24:53.461670 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:24:53.462728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:24:53.476940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70c6fdae-7183-40bb-b8ee-08ec27cb18a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ace850>]}
[0m18:24:53.477247 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:24:53.478336 [info ] [MainThread]: 
[0m18:24:53.478552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:53.478718 [info ] [MainThread]: 
[0m18:24:53.478983 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:53.479444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:24:53.505443 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:24:53.505720 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:24:53.505888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:53.526725 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.021 seconds
[0m18:24:53.527515 [debug] [ThreadPool]: On list_postgres: Close
[0m18:24:53.530759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m18:24:53.534640 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:24:53.534861 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:24:53.535030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:53.545438 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:24:53.545637 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:24:53.545819 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:24:53.547753 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:53.548510 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:24:53.549001 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:24:53.549336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m18:24:53.550711 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:24:53.551040 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:24:53.551200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:53.558089 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:24:53.558344 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:24:53.558552 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:24:53.560322 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:24:53.561095 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:24:53.561511 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:24:53.561856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m18:24:53.564150 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:24:53.564359 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:24:53.564507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:53.573228 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:24:53.573457 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:24:53.573652 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:24:53.575485 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:24:53.576259 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:24:53.576674 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:24:53.580278 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:53.580499 [debug] [MainThread]: On master: BEGIN
[0m18:24:53.580656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:53.589493 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:24:53.589697 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:53.589908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:24:53.592481 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:24:53.593177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70c6fdae-7183-40bb-b8ee-08ec27cb18a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105152c70>]}
[0m18:24:53.593480 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:53.593896 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:53.594074 [debug] [MainThread]: On master: BEGIN
[0m18:24:53.594697 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:24:53.594898 [debug] [MainThread]: On master: COMMIT
[0m18:24:53.595074 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:53.595234 [debug] [MainThread]: On master: COMMIT
[0m18:24:53.595618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:53.595810 [debug] [MainThread]: On master: Close
[0m18:24:53.597277 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:24:53.597710 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:24:53.598021 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_ods, now model.enpal_assessment_project.master_deal)
[0m18:24:53.598238 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:24:53.606210 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:24:53.607176 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:24:53.630884 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:24:53.631595 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:24:53.631800 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:24:53.631985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:24:53.642874 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:24:53.643074 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:24:53.643387 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       datediff('day', ls.latest_stage_change_at, current_date) as days_in_current_stage,
       datediff('day', fs.first_stage_entered_at, current_date) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:24:53.645105 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function datediff(unknown, timestamp without time zone, date) does not exist
LINE 146:        datediff('day', ls.latest_stage_change_at, current_da...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:24:53.645376 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:24:53.645990 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:24:53.661047 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 146:        datediff('day', ls.latest_stage_change_at, current_da...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:24:53.662358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70c6fdae-7183-40bb-b8ee-08ec27cb18a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8e1f0>]}
[0m18:24:53.662766 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:24:53.663105 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:24:53.663411 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 146:        datediff('day', ls.latest_stage_change_at, current_da...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:24:53.664134 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:53.664320 [debug] [MainThread]: On master: BEGIN
[0m18:24:53.664472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:53.675059 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m18:24:53.675393 [debug] [MainThread]: On master: COMMIT
[0m18:24:53.675570 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:53.675726 [debug] [MainThread]: On master: COMMIT
[0m18:24:53.676243 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:53.676517 [debug] [MainThread]: On master: Close
[0m18:24:53.676776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:53.676924 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:24:53.677094 [info ] [MainThread]: 
[0m18:24:53.677269 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:24:53.677663 [debug] [MainThread]: Command end result
[0m18:24:53.697463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:24:53.698594 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:24:53.702848 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:24:53.703129 [info ] [MainThread]: 
[0m18:24:53.703361 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:24:53.703542 [info ] [MainThread]: 
[0m18:24:53.703752 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:24:53.703966 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 146:        datediff('day', ls.latest_stage_change_at, current_da...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:24:53.704131 [info ] [MainThread]: 
[0m18:24:53.704317 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:24:53.704476 [info ] [MainThread]: 
[0m18:24:53.704656 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:24:53.705781 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.84508103, "process_in_blocks": "0", "process_kernel_time": 0.145138, "process_mem_max_rss": "135004160", "process_out_blocks": "0", "process_user_time": 1.399874}
[0m18:24:53.706008 [debug] [MainThread]: Command `dbt build` failed at 18:24:53.705961 after 0.85 seconds
[0m18:24:53.706226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100af31c0>]}
[0m18:24:53.706449 [debug] [MainThread]: Flushing usage events
[0m18:24:54.169159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:25:15.263782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103369730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e7340>]}


============================== 18:25:15.266558 | 51fa5317-7c80-4463-8a82-adfc6139dba0 ==============================
[0m18:25:15.266558 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:25:15.266906 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'version_check': 'True', 'empty': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'partial_parse': 'True', 'invocation_command': 'dbt build -s master_deal'}
[0m18:25:15.367003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51fa5317-7c80-4463-8a82-adfc6139dba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d04e20>]}
[0m18:25:15.402818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51fa5317-7c80-4463-8a82-adfc6139dba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abb5e0>]}
[0m18:25:15.403366 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:25:15.472968 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:25:15.561263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:25:15.561666 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:25:15.750705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51fa5317-7c80-4463-8a82-adfc6139dba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b0b20>]}
[0m18:25:15.814292 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:25:15.815357 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:25:15.829746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51fa5317-7c80-4463-8a82-adfc6139dba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac8040>]}
[0m18:25:15.830048 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:25:15.831117 [info ] [MainThread]: 
[0m18:25:15.831313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:15.831473 [info ] [MainThread]: 
[0m18:25:15.831739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:25:15.832183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:25:15.858339 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:25:15.858629 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:25:15.858801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:15.878418 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m18:25:15.879215 [debug] [ThreadPool]: On list_postgres: Close
[0m18:25:15.882479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m18:25:15.886340 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:25:15.886544 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:25:15.886702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:15.896935 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:25:15.897164 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:25:15.897365 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:25:15.899670 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:25:15.900425 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:25:15.900882 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:25:15.901195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_ods)
[0m18:25:15.902561 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:25:15.902899 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:25:15.903073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:15.910131 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:25:15.910360 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:25:15.910536 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:25:15.912549 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:25:15.913309 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:25:15.913748 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:25:15.914099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m18:25:15.916352 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:25:15.916571 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:25:15.916730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:15.923793 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:25:15.924164 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:25:15.924407 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:25:15.926416 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:25:15.927363 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:25:15.927846 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:25:15.931737 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.932020 [debug] [MainThread]: On master: BEGIN
[0m18:25:15.932212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:15.939322 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:25:15.939562 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.939789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:25:15.941877 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:25:15.942562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51fa5317-7c80-4463-8a82-adfc6139dba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b0730>]}
[0m18:25:15.942844 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:15.943305 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.943497 [debug] [MainThread]: On master: BEGIN
[0m18:25:15.944192 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:25:15.944385 [debug] [MainThread]: On master: COMMIT
[0m18:25:15.944551 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.944704 [debug] [MainThread]: On master: COMMIT
[0m18:25:15.945109 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:25:15.945290 [debug] [MainThread]: On master: Close
[0m18:25:15.946727 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:25:15.947100 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:25:15.947402 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.master_deal)
[0m18:25:15.947608 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:25:15.954132 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:25:15.954748 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:25:15.977889 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:25:15.978523 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:25:15.978721 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:25:15.978904 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:25:15.989262 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:25:15.989513 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:25:15.989837 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       datediff('day', ls.latest_stage_change_at, current_timestamp) as days_in_current_stage,
       datediff('day', fs.first_stage_entered_at, current_timestamp) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:25:15.992272 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function datediff(unknown, timestamp without time zone, timestamp with time zone) does not exist
LINE 146:        datediff('day', ls.latest_stage_change_at, current_ti...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:25:15.992544 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:25:15.993391 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:25:16.006313 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, timestamp without time zone, timestamp with time zone) does not exist
  LINE 146:        datediff('day', ls.latest_stage_change_at, current_ti...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:25:16.007471 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51fa5317-7c80-4463-8a82-adfc6139dba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b177c0>]}
[0m18:25:16.007896 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:25:16.008244 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:25:16.008527 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, timestamp without time zone, timestamp with time zone) does not exist
  LINE 146:        datediff('day', ls.latest_stage_change_at, current_ti...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:25:16.009208 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:16.009385 [debug] [MainThread]: On master: BEGIN
[0m18:25:16.009535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:16.019302 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m18:25:16.019538 [debug] [MainThread]: On master: COMMIT
[0m18:25:16.019704 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:16.019857 [debug] [MainThread]: On master: COMMIT
[0m18:25:16.020318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:25:16.020599 [debug] [MainThread]: On master: Close
[0m18:25:16.020855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:16.021013 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:25:16.021215 [info ] [MainThread]: 
[0m18:25:16.021409 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:25:16.021828 [debug] [MainThread]: Command end result
[0m18:25:16.041759 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:25:16.043026 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:25:16.047015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:25:16.047204 [info ] [MainThread]: 
[0m18:25:16.047424 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:25:16.047605 [info ] [MainThread]: 
[0m18:25:16.047817 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:25:16.048025 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, timestamp without time zone, timestamp with time zone) does not exist
  LINE 146:        datediff('day', ls.latest_stage_change_at, current_ti...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:25:16.048191 [info ] [MainThread]: 
[0m18:25:16.048374 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:25:16.048530 [info ] [MainThread]: 
[0m18:25:16.048705 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:25:16.049659 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8263939, "process_in_blocks": "0", "process_kernel_time": 0.138252, "process_mem_max_rss": "135004160", "process_out_blocks": "0", "process_user_time": 1.409135}
[0m18:25:16.049875 [debug] [MainThread]: Command `dbt build` failed at 18:25:16.049827 after 0.83 seconds
[0m18:25:16.050079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103369730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ec640>]}
[0m18:25:16.050282 [debug] [MainThread]: Flushing usage events
[0m18:25:16.494775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:25:55.059734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109713460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109713280>]}


============================== 18:25:55.062276 | bbc2430f-78e5-44a3-80ad-1dcd80e067c6 ==============================
[0m18:25:55.062276 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:25:55.062610 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'empty': 'False', 'write_json': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -s master_deal', 'printer_width': '80', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'no_print': 'None', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:25:55.162259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbc2430f-78e5-44a3-80ad-1dcd80e067c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4be1f0>]}
[0m18:25:55.197816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbc2430f-78e5-44a3-80ad-1dcd80e067c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a131c0>]}
[0m18:25:55.198343 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:25:55.267459 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:25:55.357725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:25:55.358174 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:25:55.548253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbc2430f-78e5-44a3-80ad-1dcd80e067c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487220>]}
[0m18:25:55.614446 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:25:55.615610 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:25:55.630314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbc2430f-78e5-44a3-80ad-1dcd80e067c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b09e850>]}
[0m18:25:55.630634 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:25:55.631814 [info ] [MainThread]: 
[0m18:25:55.632057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:55.632239 [info ] [MainThread]: 
[0m18:25:55.632535 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:25:55.633013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:25:55.659185 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:25:55.659477 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:25:55.659639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:55.679742 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m18:25:55.680551 [debug] [ThreadPool]: On list_postgres: Close
[0m18:25:55.683785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m18:25:55.687615 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:25:55.687816 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:25:55.687978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:55.698724 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:25:55.698933 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:25:55.699136 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:25:55.701128 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:25:55.701937 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:25:55.702370 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:25:55.702683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m18:25:55.704649 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:25:55.704852 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:25:55.705007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:55.711741 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:25:55.711966 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:25:55.712218 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:25:55.714069 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:25:55.714835 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:25:55.715276 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:25:55.715603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m18:25:55.717819 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:25:55.718035 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:25:55.718188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:55.725354 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:25:55.725597 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:25:55.725783 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:25:55.727579 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:25:55.728337 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:25:55.728766 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:25:55.732099 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:55.732331 [debug] [MainThread]: On master: BEGIN
[0m18:25:55.732488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:55.739400 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:25:55.739625 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:55.739841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:25:55.741942 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:25:55.742615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbc2430f-78e5-44a3-80ad-1dcd80e067c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a7c70>]}
[0m18:25:55.742896 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:55.743348 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:55.743540 [debug] [MainThread]: On master: BEGIN
[0m18:25:55.744193 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:25:55.744375 [debug] [MainThread]: On master: COMMIT
[0m18:25:55.744540 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:55.744694 [debug] [MainThread]: On master: COMMIT
[0m18:25:55.745134 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:25:55.745301 [debug] [MainThread]: On master: Close
[0m18:25:55.746752 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:25:55.747120 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:25:55.747406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.master_deal)
[0m18:25:55.747609 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:25:55.754078 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:25:55.754759 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:25:55.778223 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:25:55.778887 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:25:55.779098 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:25:55.779280 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:25:55.791972 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m18:25:55.792293 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:25:55.792632 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       datediff(day, ls.latest_stage_change_at, current_timestamp) as days_in_current_stage,
       datediff(day, fs.first_stage_entered_at, current_timestamp) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:25:55.794571 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "day" does not exist
LINE 146:        datediff(day, ls.latest_stage_change_at, current_time...
                          ^

[0m18:25:55.794830 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:25:55.795539 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:25:55.809139 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146:        datediff(day, ls.latest_stage_change_at, current_time...
                            ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:25:55.810276 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbc2430f-78e5-44a3-80ad-1dcd80e067c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b05e1f0>]}
[0m18:25:55.810684 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:25:55.811020 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:25:55.811303 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146:        datediff(day, ls.latest_stage_change_at, current_time...
                            ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:25:55.811967 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:55.812152 [debug] [MainThread]: On master: BEGIN
[0m18:25:55.812303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:55.821317 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:25:55.821579 [debug] [MainThread]: On master: COMMIT
[0m18:25:55.821756 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:55.821911 [debug] [MainThread]: On master: COMMIT
[0m18:25:55.822359 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:25:55.822566 [debug] [MainThread]: On master: Close
[0m18:25:55.822820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:55.822987 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:25:55.823173 [info ] [MainThread]: 
[0m18:25:55.823353 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:25:55.823749 [debug] [MainThread]: Command end result
[0m18:25:55.843386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:25:55.844497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:25:55.848234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:25:55.848409 [info ] [MainThread]: 
[0m18:25:55.848621 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:25:55.848792 [info ] [MainThread]: 
[0m18:25:55.848990 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:25:55.849184 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146:        datediff(day, ls.latest_stage_change_at, current_time...
                            ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:25:55.849337 [info ] [MainThread]: 
[0m18:25:55.849513 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:25:55.849660 [info ] [MainThread]: 
[0m18:25:55.849825 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:25:55.851088 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8326713, "process_in_blocks": "0", "process_kernel_time": 0.144228, "process_mem_max_rss": "134217728", "process_out_blocks": "0", "process_user_time": 1.408491}
[0m18:25:55.851437 [debug] [MainThread]: Command `dbt build` failed at 18:25:55.851381 after 0.83 seconds
[0m18:25:55.851666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a9580>]}
[0m18:25:55.851881 [debug] [MainThread]: Flushing usage events
[0m18:25:56.316346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:22.021033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a54880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad3340>]}


============================== 18:26:22.023504 | a9641035-8bec-44ab-bc8a-95ea244b1359 ==============================
[0m18:26:22.023504 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:26:22.023831 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'invocation_command': 'dbt build -s master_deal', 'use_colors': 'True', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m18:26:22.123308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9641035-8bec-44ab-bc8a-95ea244b1359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa5f70>]}
[0m18:26:22.158790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9641035-8bec-44ab-bc8a-95ea244b1359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d19d0>]}
[0m18:26:22.159293 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:26:22.228605 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:26:22.317588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:22.317982 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:26:22.506094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9641035-8bec-44ab-bc8a-95ea244b1359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8fb50>]}
[0m18:26:22.569888 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:26:22.570964 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:26:22.585267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9641035-8bec-44ab-bc8a-95ea244b1359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107234670>]}
[0m18:26:22.585568 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:26:22.586653 [info ] [MainThread]: 
[0m18:26:22.586874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:26:22.587037 [info ] [MainThread]: 
[0m18:26:22.587307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:26:22.587766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:26:22.614301 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:26:22.614580 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:26:22.614745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:22.635108 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m18:26:22.635910 [debug] [ThreadPool]: On list_postgres: Close
[0m18:26:22.639202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m18:26:22.643057 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:26:22.643274 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:26:22.643427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:22.651085 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:26:22.651338 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:26:22.651529 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:26:22.653497 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:26:22.654313 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:26:22.654765 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:26:22.655097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m18:26:22.656491 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:26:22.656681 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:26:22.656832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:22.663644 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:26:22.663879 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:26:22.664067 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:26:22.665947 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:26:22.666722 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:26:22.667133 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:26:22.667466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_pipedrive_analytics)
[0m18:26:22.669274 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:26:22.669478 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:26:22.669633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:22.677147 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:26:22.677357 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:26:22.677538 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:26:22.679394 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:26:22.680129 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:26:22.680549 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:26:22.683815 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:22.684035 [debug] [MainThread]: On master: BEGIN
[0m18:26:22.684191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:22.691030 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:26:22.691257 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:22.691476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:26:22.693419 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:26:22.694062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9641035-8bec-44ab-bc8a-95ea244b1359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b88af0>]}
[0m18:26:22.694330 [debug] [MainThread]: On master: ROLLBACK
[0m18:26:22.694778 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:22.694975 [debug] [MainThread]: On master: BEGIN
[0m18:26:22.695752 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:26:22.696049 [debug] [MainThread]: On master: COMMIT
[0m18:26:22.696232 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:22.696388 [debug] [MainThread]: On master: COMMIT
[0m18:26:22.696828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:26:22.697045 [debug] [MainThread]: On master: Close
[0m18:26:22.698422 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:26:22.698790 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:26:22.699090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.master_deal)
[0m18:26:22.699306 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:26:22.705810 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:26:22.706415 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:26:22.729630 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:26:22.730339 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:26:22.730543 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:26:22.730725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:26:22.742028 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:26:22.742225 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:26:22.742552 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       datediff(ls.latest_stage_change_at, current_timestamp,day) as days_in_current_stage,
       datediff(fs.first_stage_entered_at, current_timestamp,day) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:26:22.744562 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "day" does not exist
LINE 146: ...diff(ls.latest_stage_change_at, current_timestamp,day) as da...
                                                               ^

[0m18:26:22.744823 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:26:22.745643 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:26:22.758858 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146: ...diff(ls.latest_stage_change_at, current_timestamp,day) as da...
                                                                 ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:26:22.760019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9641035-8bec-44ab-bc8a-95ea244b1359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b29eb0>]}
[0m18:26:22.760441 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:26:22.760781 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:26:22.761054 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146: ...diff(ls.latest_stage_change_at, current_timestamp,day) as da...
                                                                 ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:26:22.761696 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:22.761862 [debug] [MainThread]: On master: BEGIN
[0m18:26:22.762003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:22.771961 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m18:26:22.772189 [debug] [MainThread]: On master: COMMIT
[0m18:26:22.772345 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:22.772487 [debug] [MainThread]: On master: COMMIT
[0m18:26:22.772959 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:26:22.773249 [debug] [MainThread]: On master: Close
[0m18:26:22.773504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:22.773665 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:26:22.773843 [info ] [MainThread]: 
[0m18:26:22.774025 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:26:22.774428 [debug] [MainThread]: Command end result
[0m18:26:22.795148 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:26:22.796455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:26:22.800422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:26:22.800600 [info ] [MainThread]: 
[0m18:26:22.800810 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:26:22.800991 [info ] [MainThread]: 
[0m18:26:22.801194 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:26:22.801391 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146: ...diff(ls.latest_stage_change_at, current_timestamp,day) as da...
                                                                 ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:26:22.801546 [info ] [MainThread]: 
[0m18:26:22.801731 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:26:22.801880 [info ] [MainThread]: 
[0m18:26:22.802047 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:26:22.802985 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.82420343, "process_in_blocks": "0", "process_kernel_time": 0.133626, "process_mem_max_rss": "133890048", "process_out_blocks": "0", "process_user_time": 1.401083}
[0m18:26:22.803196 [debug] [MainThread]: Command `dbt build` failed at 18:26:22.803151 after 0.82 seconds
[0m18:26:22.803472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a54880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107250100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4c370>]}
[0m18:26:22.803711 [debug] [MainThread]: Flushing usage events
[0m18:26:23.214812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:27:33.144416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a08820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d934c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d932e0>]}


============================== 18:27:33.146832 | fd8ed0c8-53b7-44c4-bcc9-1e1db6e7641d ==============================
[0m18:27:33.146832 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:27:33.147167 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'empty': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt build -s master_deal', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None'}
[0m18:27:33.246147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd8ed0c8-53b7-44c4-bcc9-1e1db6e7641d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d65070>]}
[0m18:27:33.281731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd8ed0c8-53b7-44c4-bcc9-1e1db6e7641d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7ddf0>]}
[0m18:27:33.282256 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:27:33.351961 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:27:33.439190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:33.439591 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:27:33.627375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd8ed0c8-53b7-44c4-bcc9-1e1db6e7641d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c9b50>]}
[0m18:27:33.691098 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:27:33.692178 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:27:33.706486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd8ed0c8-53b7-44c4-bcc9-1e1db6e7641d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b65c10>]}
[0m18:27:33.706794 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:27:33.707873 [info ] [MainThread]: 
[0m18:27:33.708064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:33.708224 [info ] [MainThread]: 
[0m18:27:33.708486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:27:33.708931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:27:33.735085 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:27:33.735383 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:27:33.735548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:33.755818 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m18:27:33.756581 [debug] [ThreadPool]: On list_postgres: Close
[0m18:27:33.759821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m18:27:33.763668 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:27:33.763875 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:27:33.764043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:33.774673 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:27:33.774928 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:27:33.775115 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:27:33.777312 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:27:33.778207 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:27:33.778657 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:27:33.779026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m18:27:33.780985 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:27:33.781229 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:27:33.781395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:33.790339 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:27:33.790632 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:27:33.790834 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:27:33.792765 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:27:33.793580 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:27:33.794097 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:27:33.794533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m18:27:33.796691 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:27:33.796929 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:27:33.797099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:33.806409 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:27:33.806633 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:27:33.806819 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:27:33.808740 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:27:33.809669 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:27:33.810149 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:27:33.814195 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:33.814441 [debug] [MainThread]: On master: BEGIN
[0m18:27:33.814605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:33.821509 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:27:33.821671 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:33.821875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:27:33.824154 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:27:33.825010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd8ed0c8-53b7-44c4-bcc9-1e1db6e7641d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bd3eb0>]}
[0m18:27:33.825317 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:33.826582 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:33.826766 [debug] [MainThread]: On master: BEGIN
[0m18:27:33.838961 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m18:27:33.839288 [debug] [MainThread]: On master: COMMIT
[0m18:27:33.839663 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:33.839890 [debug] [MainThread]: On master: COMMIT
[0m18:27:33.840463 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:27:33.840781 [debug] [MainThread]: On master: Close
[0m18:27:33.843278 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:27:33.843754 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:27:33.844102 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.master_deal)
[0m18:27:33.844340 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:27:33.851632 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:27:33.852211 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:27:33.876566 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:27:33.877251 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:27:33.877453 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:27:33.877636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:33.889056 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:27:33.889285 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:27:33.889634 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       datediff('month',ls.latest_stage_change_at, current_timestamp) as days_in_current_stage,
       datediff('month',fs.first_stage_entered_at, current_timestamp) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:27:33.891339 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function datediff(unknown, timestamp without time zone, timestamp with time zone) does not exist
LINE 146:        datediff('month',ls.latest_stage_change_at, current_t...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:27:33.891622 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:27:33.892163 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:27:33.907472 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, timestamp without time zone, timestamp with time zone) does not exist
  LINE 146:        datediff('month',ls.latest_stage_change_at, current_t...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:27:33.908843 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8ed0c8-53b7-44c4-bcc9-1e1db6e7641d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c4e7f0>]}
[0m18:27:33.909268 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:27:33.909605 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:27:33.909934 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, timestamp without time zone, timestamp with time zone) does not exist
  LINE 146:        datediff('month',ls.latest_stage_change_at, current_t...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:27:33.910657 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:33.910871 [debug] [MainThread]: On master: BEGIN
[0m18:27:33.911018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:33.924952 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m18:27:33.925271 [debug] [MainThread]: On master: COMMIT
[0m18:27:33.925455 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:33.925617 [debug] [MainThread]: On master: COMMIT
[0m18:27:33.926028 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:27:33.926227 [debug] [MainThread]: On master: Close
[0m18:27:33.926492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:33.926651 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:27:33.926822 [info ] [MainThread]: 
[0m18:27:33.926999 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:27:33.927389 [debug] [MainThread]: Command end result
[0m18:27:33.947097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:27:33.948461 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:27:33.952406 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:27:33.952601 [info ] [MainThread]: 
[0m18:27:33.952811 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:27:33.952983 [info ] [MainThread]: 
[0m18:27:33.953179 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:27:33.953376 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, timestamp without time zone, timestamp with time zone) does not exist
  LINE 146:        datediff('month',ls.latest_stage_change_at, current_t...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:27:33.953534 [info ] [MainThread]: 
[0m18:27:33.953709 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:27:33.953865 [info ] [MainThread]: 
[0m18:27:33.954033 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:27:33.955069 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8508927, "process_in_blocks": "0", "process_kernel_time": 0.141617, "process_mem_max_rss": "131710976", "process_out_blocks": "0", "process_user_time": 1.403579}
[0m18:27:33.955285 [debug] [MainThread]: Command `dbt build` failed at 18:27:33.955238 after 0.85 seconds
[0m18:27:33.955483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a08820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b65e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e00490>]}
[0m18:27:33.955679 [debug] [MainThread]: Flushing usage events
[0m18:27:34.417418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:12.471231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10301d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409b310>]}


============================== 18:28:12.474184 | b729aba0-db58-43ea-9e8c-a87b2d290b38 ==============================
[0m18:28:12.474184 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:28:12.474547 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'invocation_command': 'dbt build -s master_deal', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'empty': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True'}
[0m18:28:12.580816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b729aba0-db58-43ea-9e8c-a87b2d290b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10176ca30>]}
[0m18:28:12.616819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b729aba0-db58-43ea-9e8c-a87b2d290b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ab940>]}
[0m18:28:12.617353 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:28:12.688455 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:28:12.778347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:12.778752 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:28:12.967442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b729aba0-db58-43ea-9e8c-a87b2d290b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103910e50>]}
[0m18:28:13.031166 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:28:13.032255 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:28:13.047038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b729aba0-db58-43ea-9e8c-a87b2d290b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f6b20>]}
[0m18:28:13.047344 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:28:13.048416 [info ] [MainThread]: 
[0m18:28:13.048607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:13.048764 [info ] [MainThread]: 
[0m18:28:13.049018 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:28:13.049455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:28:13.075911 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:28:13.076281 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:28:13.076516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:13.098281 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.022 seconds
[0m18:28:13.099184 [debug] [ThreadPool]: On list_postgres: Close
[0m18:28:13.102458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m18:28:13.106254 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:28:13.106460 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:28:13.106613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:13.116131 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:28:13.116384 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:28:13.116580 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:28:13.118684 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:28:13.119481 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:28:13.119903 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:28:13.120219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m18:28:13.121644 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:28:13.122350 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:28:13.122515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:13.130026 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:28:13.130286 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:28:13.130474 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:28:13.132633 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:28:13.133508 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:28:13.133969 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:28:13.134326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m18:28:13.136694 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:28:13.136925 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:28:13.137089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:13.145579 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:28:13.145812 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:28:13.145998 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:28:13.148236 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:28:13.149031 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:28:13.149459 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:28:13.152918 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:13.153149 [debug] [MainThread]: On master: BEGIN
[0m18:28:13.153308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:13.162193 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:28:13.162425 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:13.162648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:28:13.165148 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:28:13.165890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b729aba0-db58-43ea-9e8c-a87b2d290b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051451c0>]}
[0m18:28:13.166187 [debug] [MainThread]: On master: ROLLBACK
[0m18:28:13.166610 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:13.166781 [debug] [MainThread]: On master: BEGIN
[0m18:28:13.167451 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:28:13.167686 [debug] [MainThread]: On master: COMMIT
[0m18:28:13.168009 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:13.168210 [debug] [MainThread]: On master: COMMIT
[0m18:28:13.168834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:28:13.169066 [debug] [MainThread]: On master: Close
[0m18:28:13.170464 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:28:13.170832 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:28:13.171116 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.master_deal)
[0m18:28:13.171325 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:28:13.178541 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:28:13.179143 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:28:13.202374 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:28:13.203051 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:28:13.203271 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:28:13.203482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:28:13.214654 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:28:13.214896 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:28:13.215215 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       datediff('month',cast(ls.latest_stage_change_at as date), current_date) as days_in_current_stage,
       datediff('month',cast(fs.first_stage_entered_at as date), current_date) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:28:13.218717 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function datediff(unknown, date, date) does not exist
LINE 146:        datediff('month',cast(ls.latest_stage_change_at as da...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:28:13.219180 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:28:13.219763 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:28:13.235594 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, date, date) does not exist
  LINE 146:        datediff('month',cast(ls.latest_stage_change_at as da...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:28:13.237014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b729aba0-db58-43ea-9e8c-a87b2d290b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032ee8b0>]}
[0m18:28:13.237449 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:28:13.237794 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:28:13.238110 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, date, date) does not exist
  LINE 146:        datediff('month',cast(ls.latest_stage_change_at as da...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:28:13.238750 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:13.238933 [debug] [MainThread]: On master: BEGIN
[0m18:28:13.239079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:13.251948 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m18:28:13.252294 [debug] [MainThread]: On master: COMMIT
[0m18:28:13.252520 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:13.252691 [debug] [MainThread]: On master: COMMIT
[0m18:28:13.253172 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:28:13.253356 [debug] [MainThread]: On master: Close
[0m18:28:13.253618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:13.253771 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:28:13.253937 [info ] [MainThread]: 
[0m18:28:13.254113 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:28:13.254574 [debug] [MainThread]: Command end result
[0m18:28:13.273860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:28:13.275078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:28:13.279473 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:28:13.279762 [info ] [MainThread]: 
[0m18:28:13.280025 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:28:13.280245 [info ] [MainThread]: 
[0m18:28:13.280496 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:28:13.280912 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  function datediff(unknown, date, date) does not exist
  LINE 146:        datediff('month',cast(ls.latest_stage_change_at as da...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:28:13.281166 [info ] [MainThread]: 
[0m18:28:13.281448 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:28:13.281676 [info ] [MainThread]: 
[0m18:28:13.281886 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:28:13.283212 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.85455155, "process_in_blocks": "0", "process_kernel_time": 0.145799, "process_mem_max_rss": "132399104", "process_out_blocks": "0", "process_user_time": 1.405572}
[0m18:28:13.283574 [debug] [MainThread]: Command `dbt build` failed at 18:28:13.283497 after 0.85 seconds
[0m18:28:13.283878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10301d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10519cdc0>]}
[0m18:28:13.284175 [debug] [MainThread]: Flushing usage events
[0m18:28:13.715266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:36:49.425431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbf520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbf340>]}


============================== 18:36:49.428637 | dbc838ba-67cb-46af-8bc3-c74fb75db48a ==============================
[0m18:36:49.428637 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:36:49.428985 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'write_json': 'True', 'invocation_command': 'dbt build -s master_deal', 'log_format': 'default', 'warn_error': 'None'}
[0m18:36:49.544425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbc838ba-67cb-46af-8bc3-c74fb75db48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f91f70>]}
[0m18:36:49.579979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbc838ba-67cb-46af-8bc3-c74fb75db48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bc9d0>]}
[0m18:36:49.580995 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:36:49.654161 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:36:49.750691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:36:49.751094 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:36:49.945025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbc838ba-67cb-46af-8bc3-c74fb75db48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5fb50>]}
[0m18:36:50.008499 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:36:50.009814 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:36:50.029447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbc838ba-67cb-46af-8bc3-c74fb75db48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107720670>]}
[0m18:36:50.029785 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:36:50.030884 [info ] [MainThread]: 
[0m18:36:50.031085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:36:50.031245 [info ] [MainThread]: 
[0m18:36:50.031512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:36:50.031961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:36:50.062972 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:36:50.063260 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:36:50.063422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:50.168830 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.105 seconds
[0m18:36:50.170042 [debug] [ThreadPool]: On list_postgres: Close
[0m18:36:50.174156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m18:36:50.178765 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:36:50.179013 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:36:50.179204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:50.191856 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m18:36:50.192170 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:36:50.192391 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:36:50.195968 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m18:36:50.196917 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:36:50.197610 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:36:50.197996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m18:36:50.200547 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:36:50.200830 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:36:50.201023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:50.222666 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m18:36:50.222997 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:36:50.223216 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:36:50.225536 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:36:50.226655 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:36:50.227234 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:36:50.227684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m18:36:50.230519 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:36:50.230827 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:36:50.231017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:50.239778 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:36:50.240054 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:36:50.240273 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:36:50.242791 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:36:50.243876 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:36:50.244998 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:36:50.249075 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:50.249355 [debug] [MainThread]: On master: BEGIN
[0m18:36:50.249545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:50.263975 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m18:36:50.264201 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:50.264447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:36:50.267815 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m18:36:50.268779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbc838ba-67cb-46af-8bc3-c74fb75db48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108075af0>]}
[0m18:36:50.269137 [debug] [MainThread]: On master: ROLLBACK
[0m18:36:50.269679 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:50.269874 [debug] [MainThread]: On master: BEGIN
[0m18:36:50.270657 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:36:50.270882 [debug] [MainThread]: On master: COMMIT
[0m18:36:50.271067 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:50.271243 [debug] [MainThread]: On master: COMMIT
[0m18:36:50.271749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:36:50.272000 [debug] [MainThread]: On master: Close
[0m18:36:50.273848 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:36:50.274252 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:36:50.274611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.master_deal)
[0m18:36:50.274896 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:36:50.282216 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:36:50.282743 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:36:50.307503 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:36:50.308103 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:36:50.308314 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:36:50.308498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:36:50.321456 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m18:36:50.321788 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:36:50.322140 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       date_diff('month',cast(ls.latest_stage_change_at as date), current_date) as days_in_current_stage,
       date_diff('month',cast(fs.first_stage_entered_at as date), current_date) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:36:50.324529 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_diff(unknown, date, date) does not exist
LINE 146:        date_diff('month',cast(ls.latest_stage_change_at as d...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:36:50.324826 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:36:50.326011 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:36:50.341265 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 146:        date_diff('month',cast(ls.latest_stage_change_at as d...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:36:50.342642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc838ba-67cb-46af-8bc3-c74fb75db48a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108013550>]}
[0m18:36:50.343060 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.07s]
[0m18:36:50.343398 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:36:50.343732 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 146:        date_diff('month',cast(ls.latest_stage_change_at as d...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:36:50.344399 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:50.344575 [debug] [MainThread]: On master: BEGIN
[0m18:36:50.344728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:50.355391 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m18:36:50.355740 [debug] [MainThread]: On master: COMMIT
[0m18:36:50.355922 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:50.356073 [debug] [MainThread]: On master: COMMIT
[0m18:36:50.356561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:36:50.356722 [debug] [MainThread]: On master: Close
[0m18:36:50.356954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:50.357097 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:36:50.357257 [info ] [MainThread]: 
[0m18:36:50.357425 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:36:50.357797 [debug] [MainThread]: Command end result
[0m18:36:50.379468 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:36:50.381206 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:36:50.385340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:36:50.385545 [info ] [MainThread]: 
[0m18:36:50.385772 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:36:50.385954 [info ] [MainThread]: 
[0m18:36:50.386179 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:36:50.386428 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 146:        date_diff('month',cast(ls.latest_stage_change_at as d...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:36:50.386597 [info ] [MainThread]: 
[0m18:36:50.386789 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:36:50.386944 [info ] [MainThread]: 
[0m18:36:50.387117 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:36:50.388555 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.0077425, "process_in_blocks": "0", "process_kernel_time": 0.174762, "process_mem_max_rss": "131678208", "process_out_blocks": "0", "process_user_time": 1.426897}
[0m18:36:50.388795 [debug] [MainThread]: Command `dbt build` failed at 18:36:50.388747 after 1.01 seconds
[0m18:36:50.389011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106238370>]}
[0m18:36:50.389215 [debug] [MainThread]: Flushing usage events
[0m18:36:50.813212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:37:52.233612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ceb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105893550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105893370>]}


============================== 18:37:52.237283 | f0f6b315-6122-4976-8e85-7b9a594a17b6 ==============================
[0m18:37:52.237283 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:37:52.237676 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_format': 'default', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt build -s master_deal'}
[0m18:37:52.350927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0f6b315-6122-4976-8e85-7b9a594a17b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105069ca0>]}
[0m18:37:52.386536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0f6b315-6122-4976-8e85-7b9a594a17b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f37130>]}
[0m18:37:52.387592 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:37:52.459896 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:37:52.555530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:37:52.555919 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:37:52.743290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0f6b315-6122-4976-8e85-7b9a594a17b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5bb80>]}
[0m18:37:52.806724 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:37:52.808050 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:37:52.826653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0f6b315-6122-4976-8e85-7b9a594a17b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0ab80>]}
[0m18:37:52.826997 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:37:52.828111 [info ] [MainThread]: 
[0m18:37:52.828309 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:52.828470 [info ] [MainThread]: 
[0m18:37:52.828744 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:37:52.829204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:37:52.857737 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:37:52.858027 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:37:52.858188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:52.897423 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.039 seconds
[0m18:37:52.898349 [debug] [ThreadPool]: On list_postgres: Close
[0m18:37:52.901839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m18:37:52.905712 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:37:52.905900 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:37:52.906054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:52.916666 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:37:52.916894 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:37:52.917081 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:37:52.919263 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:37:52.920098 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:37:52.920558 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:37:52.920970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m18:37:52.922477 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:37:52.923066 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:37:52.923235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:52.930788 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:37:52.931104 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:37:52.931303 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:37:52.933201 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:37:52.934067 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:37:52.934504 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:37:52.934825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m18:37:52.936800 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:37:52.937000 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:37:52.937157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:52.946900 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:37:52.947142 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:37:52.947335 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:37:52.949436 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:37:52.950417 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:37:52.950844 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:37:52.954697 [debug] [MainThread]: Using postgres connection "master"
[0m18:37:52.954928 [debug] [MainThread]: On master: BEGIN
[0m18:37:52.955096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:37:52.964208 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:37:52.964431 [debug] [MainThread]: Using postgres connection "master"
[0m18:37:52.964644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:37:52.967882 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m18:37:52.968686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0f6b315-6122-4976-8e85-7b9a594a17b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5bcd0>]}
[0m18:37:52.969008 [debug] [MainThread]: On master: ROLLBACK
[0m18:37:52.969497 [debug] [MainThread]: Using postgres connection "master"
[0m18:37:52.969736 [debug] [MainThread]: On master: BEGIN
[0m18:37:52.970426 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:37:52.970673 [debug] [MainThread]: On master: COMMIT
[0m18:37:52.970856 [debug] [MainThread]: Using postgres connection "master"
[0m18:37:52.971020 [debug] [MainThread]: On master: COMMIT
[0m18:37:52.975367 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m18:37:52.975636 [debug] [MainThread]: On master: Close
[0m18:37:52.977685 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:37:52.978081 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:37:52.978374 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.master_deal)
[0m18:37:52.978585 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:37:52.985265 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:37:52.985895 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:37:53.009972 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:37:53.010676 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:37:53.010917 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:37:53.011111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:53.023053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m18:37:53.023326 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:37:53.023679 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       date_diff(cast(ls.latest_stage_change_at as date), current_date,'day') as days_in_current_stage,
       date_diff(cast(fs.first_stage_entered_at as date), current_date,'day') as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:37:53.025369 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_diff(date, date, unknown) does not exist
LINE 146:        date_diff(cast(ls.latest_stage_change_at as date), cu...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:37:53.025634 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:37:53.026391 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:37:53.041481 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(date, date, unknown) does not exist
  LINE 146:        date_diff(cast(ls.latest_stage_change_at as date), cu...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:37:53.042791 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0f6b315-6122-4976-8e85-7b9a594a17b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce78b0>]}
[0m18:37:53.043211 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:37:53.043553 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:37:53.043882 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(date, date, unknown) does not exist
  LINE 146:        date_diff(cast(ls.latest_stage_change_at as date), cu...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:37:53.044518 [debug] [MainThread]: Using postgres connection "master"
[0m18:37:53.044690 [debug] [MainThread]: On master: BEGIN
[0m18:37:53.044833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:37:53.054960 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m18:37:53.055262 [debug] [MainThread]: On master: COMMIT
[0m18:37:53.055441 [debug] [MainThread]: Using postgres connection "master"
[0m18:37:53.055601 [debug] [MainThread]: On master: COMMIT
[0m18:37:53.056048 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:37:53.056211 [debug] [MainThread]: On master: Close
[0m18:37:53.056453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:53.056595 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:37:53.056755 [info ] [MainThread]: 
[0m18:37:53.056924 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:37:53.057313 [debug] [MainThread]: Command end result
[0m18:37:53.077662 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:37:53.078924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:37:53.083010 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:37:53.083216 [info ] [MainThread]: 
[0m18:37:53.083436 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:37:53.083618 [info ] [MainThread]: 
[0m18:37:53.083827 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:37:53.084029 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(date, date, unknown) does not exist
  LINE 146:        date_diff(cast(ls.latest_stage_change_at as date), cu...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:37:53.084192 [info ] [MainThread]: 
[0m18:37:53.084378 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:37:53.084534 [info ] [MainThread]: 
[0m18:37:53.084705 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:37:53.085745 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8939162, "process_in_blocks": "0", "process_kernel_time": 0.163731, "process_mem_max_rss": "132169728", "process_out_blocks": "0", "process_user_time": 1.411235}
[0m18:37:53.085958 [debug] [MainThread]: Command `dbt build` failed at 18:37:53.085914 after 0.89 seconds
[0m18:37:53.086160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ceb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104101490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581b4c0>]}
[0m18:37:53.086362 [debug] [MainThread]: Flushing usage events
[0m18:37:53.525545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:35.064308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109693460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109693280>]}


============================== 18:38:35.066903 | 282c58bf-e87a-4d5a-acee-0b49008e7f91 ==============================
[0m18:38:35.066903 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:38:35.067249 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build -s master_deal', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False'}
[0m18:38:35.165952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '282c58bf-e87a-4d5a-acee-0b49008e7f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b721f0>]}
[0m18:38:35.201567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '282c58bf-e87a-4d5a-acee-0b49008e7f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041931c0>]}
[0m18:38:35.202066 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:38:35.269808 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:38:35.358740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:35.359013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:35.392582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '282c58bf-e87a-4d5a-acee-0b49008e7f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b039ee0>]}
[0m18:38:35.488724 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:38:35.489842 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:38:35.504142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '282c58bf-e87a-4d5a-acee-0b49008e7f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b036cd0>]}
[0m18:38:35.504455 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:38:35.505508 [info ] [MainThread]: 
[0m18:38:35.505707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:35.505865 [info ] [MainThread]: 
[0m18:38:35.506132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:38:35.506581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:38:35.533082 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:38:35.533387 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:38:35.533573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:35.553643 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m18:38:35.554419 [debug] [ThreadPool]: On list_postgres: Close
[0m18:38:35.557698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m18:38:35.561496 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:38:35.561696 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:38:35.561854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:35.573384 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:38:35.573633 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:38:35.573820 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:38:35.576134 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:38:35.576968 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:38:35.577438 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:38:35.577788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m18:38:35.579247 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:38:35.579588 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:38:35.579759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:35.586916 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:38:35.587158 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:38:35.587348 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:38:35.589360 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:38:35.590166 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:38:35.590605 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:38:35.590936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m18:38:35.593319 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:38:35.593521 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:38:35.593677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:35.602309 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:38:35.602523 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:38:35.602697 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:38:35.604465 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:38:35.605221 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:38:35.605676 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:38:35.609149 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:35.609376 [debug] [MainThread]: On master: BEGIN
[0m18:38:35.609536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:35.617307 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:38:35.617586 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:35.617846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:38:35.620385 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:38:35.621082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '282c58bf-e87a-4d5a-acee-0b49008e7f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b93d60>]}
[0m18:38:35.621367 [debug] [MainThread]: On master: ROLLBACK
[0m18:38:35.621843 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:35.622030 [debug] [MainThread]: On master: BEGIN
[0m18:38:35.622671 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:38:35.622853 [debug] [MainThread]: On master: COMMIT
[0m18:38:35.623017 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:35.623169 [debug] [MainThread]: On master: COMMIT
[0m18:38:35.623610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:38:35.623785 [debug] [MainThread]: On master: Close
[0m18:38:35.625181 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:38:35.625600 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:38:35.625911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_ods, now model.enpal_assessment_project.master_deal)
[0m18:38:35.626119 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:38:35.632609 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:38:35.633120 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:38:35.656280 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:38:35.656960 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:38:35.657182 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:38:35.657367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:35.667925 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:38:35.668144 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:38:35.668463 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       date_diff(cast(ls.latest_stage_change_at as date), current_date,'day') as days_in_current_stage,
       date_diff(cast(fs.first_stage_entered_at as date), current_date,'day') as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:38:35.670603 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_diff(date, date, unknown) does not exist
LINE 146:        date_diff(cast(ls.latest_stage_change_at as date), cu...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:38:35.670839 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:38:35.671634 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:38:35.684431 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(date, date, unknown) does not exist
  LINE 146:        date_diff(cast(ls.latest_stage_change_at as date), cu...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:38:35.685576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282c58bf-e87a-4d5a-acee-0b49008e7f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6eeb20>]}
[0m18:38:35.685981 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:38:35.686321 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:38:35.686599 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(date, date, unknown) does not exist
  LINE 146:        date_diff(cast(ls.latest_stage_change_at as date), cu...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:38:35.687234 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:35.687416 [debug] [MainThread]: On master: BEGIN
[0m18:38:35.687567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:38:35.699105 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m18:38:35.699498 [debug] [MainThread]: On master: COMMIT
[0m18:38:35.699694 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:35.699850 [debug] [MainThread]: On master: COMMIT
[0m18:38:35.700361 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:38:35.700611 [debug] [MainThread]: On master: Close
[0m18:38:35.700871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:35.701029 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:38:35.701210 [info ] [MainThread]: 
[0m18:38:35.701388 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:38:35.701798 [debug] [MainThread]: Command end result
[0m18:38:35.722088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:38:35.723271 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:38:35.727185 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:38:35.727380 [info ] [MainThread]: 
[0m18:38:35.727597 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:38:35.727777 [info ] [MainThread]: 
[0m18:38:35.727989 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:38:35.728193 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(date, date, unknown) does not exist
  LINE 146:        date_diff(cast(ls.latest_stage_change_at as date), cu...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:38:35.728358 [info ] [MainThread]: 
[0m18:38:35.728550 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:38:35.728707 [info ] [MainThread]: 
[0m18:38:35.728883 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:38:35.730496 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7068534, "process_in_blocks": "0", "process_kernel_time": 0.133915, "process_mem_max_rss": "127680512", "process_out_blocks": "0", "process_user_time": 1.28353}
[0m18:38:35.730791 [debug] [MainThread]: Command `dbt build` failed at 18:38:35.730738 after 0.71 seconds
[0m18:38:35.731011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7beeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df6580>]}
[0m18:38:35.731232 [debug] [MainThread]: Flushing usage events
[0m18:38:36.144080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:09.675931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e13550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e13370>]}


============================== 18:39:09.678267 | 8ba12434-1dca-42d0-a471-2391c20a658a ==============================
[0m18:39:09.678267 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:39:09.678597 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'log_cache_events': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt build -s master_deal'}
[0m18:39:09.777118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ba12434-1dca-42d0-a471-2391c20a658a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e9ca0>]}
[0m18:39:09.812567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ba12434-1dca-42d0-a471-2391c20a658a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdf130>]}
[0m18:39:09.813066 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:39:09.882727 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:39:09.971019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:39:09.971406 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:39:10.166075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ba12434-1dca-42d0-a471-2391c20a658a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b03b80>]}
[0m18:39:10.229378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:39:10.230716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:39:10.249305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ba12434-1dca-42d0-a471-2391c20a658a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097edb80>]}
[0m18:39:10.249653 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:39:10.250751 [info ] [MainThread]: 
[0m18:39:10.250952 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:10.251115 [info ] [MainThread]: 
[0m18:39:10.251388 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:10.251872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:39:10.280377 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:39:10.280667 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:39:10.280830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:10.301675 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.021 seconds
[0m18:39:10.302491 [debug] [ThreadPool]: On list_postgres: Close
[0m18:39:10.305727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m18:39:10.309464 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:39:10.309665 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:39:10.309818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:10.319816 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:39:10.320000 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:39:10.320184 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:39:10.322320 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:39:10.323076 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:39:10.323530 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:39:10.323844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_ods)
[0m18:39:10.325396 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:39:10.325634 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:39:10.325826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:10.332575 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:39:10.332829 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:39:10.333016 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:39:10.335005 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:39:10.335767 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:39:10.336215 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:39:10.336543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m18:39:10.338851 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:39:10.339145 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:39:10.339319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:10.347762 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:39:10.347965 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:39:10.348144 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:39:10.349990 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:39:10.350934 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:39:10.351373 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:39:10.355165 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:10.355402 [debug] [MainThread]: On master: BEGIN
[0m18:39:10.355575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:10.363977 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:39:10.364228 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:10.364467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:39:10.366557 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:39:10.367260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ba12434-1dca-42d0-a471-2391c20a658a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b1af70>]}
[0m18:39:10.367563 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:10.368534 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:10.368700 [debug] [MainThread]: On master: BEGIN
[0m18:39:10.369784 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:39:10.369942 [debug] [MainThread]: On master: COMMIT
[0m18:39:10.370096 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:10.370243 [debug] [MainThread]: On master: COMMIT
[0m18:39:10.371179 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:39:10.371364 [debug] [MainThread]: On master: Close
[0m18:39:10.373175 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:39:10.373518 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:39:10.373782 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.master_deal)
[0m18:39:10.373986 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:39:10.380653 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:39:10.381450 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:39:10.406818 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:39:10.407547 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:39:10.407759 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:39:10.407943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:10.418499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:39:10.418750 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:39:10.419096 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       date_diff(DATE(ls.latest_stage_change_at), current_date,'day') as days_in_current_stage,
       date_diff(DATE(fs.first_stage_entered_at), current_date,'day') as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:39:10.420789 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_diff(date, date, unknown) does not exist
LINE 146:        date_diff(DATE(ls.latest_stage_change_at), current_da...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:39:10.421101 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:39:10.421751 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:39:10.436915 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(date, date, unknown) does not exist
  LINE 146:        date_diff(DATE(ls.latest_stage_change_at), current_da...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:39:10.438270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba12434-1dca-42d0-a471-2391c20a658a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa78b0>]}
[0m18:39:10.438694 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:39:10.439040 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:39:10.439360 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(date, date, unknown) does not exist
  LINE 146:        date_diff(DATE(ls.latest_stage_change_at), current_da...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:39:10.440027 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:10.440202 [debug] [MainThread]: On master: BEGIN
[0m18:39:10.440344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:39:10.452740 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m18:39:10.453049 [debug] [MainThread]: On master: COMMIT
[0m18:39:10.453232 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:10.453384 [debug] [MainThread]: On master: COMMIT
[0m18:39:10.453843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:39:10.454035 [debug] [MainThread]: On master: Close
[0m18:39:10.454288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:10.454443 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:39:10.454618 [info ] [MainThread]: 
[0m18:39:10.454801 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:39:10.455217 [debug] [MainThread]: Command end result
[0m18:39:10.475630 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:39:10.476958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:39:10.480842 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:39:10.481024 [info ] [MainThread]: 
[0m18:39:10.481247 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:39:10.481427 [info ] [MainThread]: 
[0m18:39:10.481644 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:39:10.481855 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  function date_diff(date, date, unknown) does not exist
  LINE 146:        date_diff(DATE(ls.latest_stage_change_at), current_da...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:39:10.482022 [info ] [MainThread]: 
[0m18:39:10.482208 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:39:10.482365 [info ] [MainThread]: 
[0m18:39:10.482542 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:39:10.483566 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8500212, "process_in_blocks": "0", "process_kernel_time": 0.146718, "process_mem_max_rss": "133726208", "process_out_blocks": "0", "process_user_time": 1.415073}
[0m18:39:10.483780 [debug] [MainThread]: Command `dbt build` failed at 18:39:10.483735 after 0.85 seconds
[0m18:39:10.483986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d31460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9b4c0>]}
[0m18:39:10.484246 [debug] [MainThread]: Flushing usage events
[0m18:39:10.919740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:33.087591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a99790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e535b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e533d0>]}


============================== 18:39:33.090097 | d9425d17-c8aa-4920-8e5c-4198be3abe5e ==============================
[0m18:39:33.090097 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:39:33.090441 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'target_path': 'None', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt build -s master_deal', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None'}
[0m18:39:33.189918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9425d17-c8aa-4920-8e5c-4198be3abe5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb1220>]}
[0m18:39:33.225314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9425d17-c8aa-4920-8e5c-4198be3abe5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6b520>]}
[0m18:39:33.225801 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:39:33.295043 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:39:33.382705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:39:33.383075 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:39:33.572587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9425d17-c8aa-4920-8e5c-4198be3abe5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c77d00>]}
[0m18:39:33.635897 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:39:33.636954 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:39:33.651308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9425d17-c8aa-4920-8e5c-4198be3abe5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110709b50>]}
[0m18:39:33.651612 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:39:33.652676 [info ] [MainThread]: 
[0m18:39:33.652868 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:33.653029 [info ] [MainThread]: 
[0m18:39:33.653292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:33.653787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:39:33.680333 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:39:33.680622 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:39:33.680789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:33.699549 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.019 seconds
[0m18:39:33.700316 [debug] [ThreadPool]: On list_postgres: Close
[0m18:39:33.703551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_ods)
[0m18:39:33.707378 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:39:33.707582 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:39:33.707736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:33.717646 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:39:33.717825 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:39:33.718000 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:39:33.719954 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:39:33.720764 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:39:33.721222 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:39:33.721528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m18:39:33.723307 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:39:33.723501 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:39:33.723654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:33.730705 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:39:33.730943 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:39:33.731140 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:39:33.733088 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:39:33.733843 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:39:33.734263 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:39:33.734613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_staging)
[0m18:39:33.736659 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:39:33.736869 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:39:33.737021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:33.745842 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:39:33.746105 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:39:33.746298 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:39:33.748725 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:39:33.749648 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:39:33.750101 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:39:33.753864 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:33.754090 [debug] [MainThread]: On master: BEGIN
[0m18:39:33.754249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:33.763367 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:39:33.763573 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:33.763789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:39:33.765801 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:39:33.766536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9425d17-c8aa-4920-8e5c-4198be3abe5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a69730>]}
[0m18:39:33.766839 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:33.767294 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:33.767507 [debug] [MainThread]: On master: BEGIN
[0m18:39:33.768344 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:39:33.768540 [debug] [MainThread]: On master: COMMIT
[0m18:39:33.768715 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:33.768875 [debug] [MainThread]: On master: COMMIT
[0m18:39:33.769292 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:39:33.769479 [debug] [MainThread]: On master: Close
[0m18:39:33.770889 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:39:33.771261 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:39:33.771550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.master_deal)
[0m18:39:33.771754 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:39:33.778614 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:39:33.779280 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:39:33.801980 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:39:33.802595 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:39:33.802801 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:39:33.802983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:33.814450 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:39:33.814703 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:39:33.815070 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
       date_diff(DATE(ls.latest_stage_change_at), current_date,day) as days_in_current_stage,
       date_diff(DATE(fs.first_stage_entered_at), current_date,day) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:39:33.816833 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "day" does not exist
LINE 146: ...iff(DATE(ls.latest_stage_change_at), current_date,day) as da...
                                                               ^

[0m18:39:33.817070 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:39:33.818046 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:39:33.831528 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146: ...iff(DATE(ls.latest_stage_change_at), current_date,day) as da...
                                                                 ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:39:33.832654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9425d17-c8aa-4920-8e5c-4198be3abe5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118eb220>]}
[0m18:39:33.833054 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:39:33.833396 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:39:33.833678 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146: ...iff(DATE(ls.latest_stage_change_at), current_date,day) as da...
                                                                 ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:39:33.834300 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:33.834464 [debug] [MainThread]: On master: BEGIN
[0m18:39:33.834605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:39:33.844564 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m18:39:33.844834 [debug] [MainThread]: On master: COMMIT
[0m18:39:33.845010 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:33.845159 [debug] [MainThread]: On master: COMMIT
[0m18:39:33.845544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:39:33.845742 [debug] [MainThread]: On master: Close
[0m18:39:33.845988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:33.846139 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:39:33.846308 [info ] [MainThread]: 
[0m18:39:33.846481 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:39:33.846883 [debug] [MainThread]: Command end result
[0m18:39:33.867392 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:39:33.868725 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:39:33.872640 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:39:33.872818 [info ] [MainThread]: 
[0m18:39:33.873024 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:39:33.873237 [info ] [MainThread]: 
[0m18:39:33.873435 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:39:33.873630 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  column "day" does not exist
  LINE 146: ...iff(DATE(ls.latest_stage_change_at), current_date,day) as da...
                                                                 ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:39:33.873783 [info ] [MainThread]: 
[0m18:39:33.873959 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:39:33.874105 [info ] [MainThread]: 
[0m18:39:33.874269 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:39:33.875245 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.828306, "process_in_blocks": "0", "process_kernel_time": 0.141044, "process_mem_max_rss": "132628480", "process_out_blocks": "0", "process_user_time": 1.406785}
[0m18:39:33.875464 [debug] [MainThread]: Command `dbt build` failed at 18:39:33.875414 after 0.83 seconds
[0m18:39:33.875679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a99790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d465b0>]}
[0m18:39:33.875886 [debug] [MainThread]: Flushing usage events
[0m18:39:34.305082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:47.743214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067835b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067833d0>]}


============================== 18:40:47.746291 | b20a6f2a-37a4-41d6-9c03-2dcdc23708dc ==============================
[0m18:40:47.746291 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:40:47.746618 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'introspect': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'empty': 'False', 'invocation_command': 'dbt build -s master_deal', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'debug': 'False', 'use_colors': 'True'}
[0m18:40:47.858786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b20a6f2a-37a4-41d6-9c03-2dcdc23708dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5c220>]}
[0m18:40:47.894395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b20a6f2a-37a4-41d6-9c03-2dcdc23708dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4b520>]}
[0m18:40:47.895436 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:40:47.967372 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:40:48.064467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:48.064885 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:40:48.254538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b20a6f2a-37a4-41d6-9c03-2dcdc23708dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a7d00>]}
[0m18:40:48.318696 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:40:48.320070 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:40:48.339397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b20a6f2a-37a4-41d6-9c03-2dcdc23708dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780cb50>]}
[0m18:40:48.339718 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:40:48.340809 [info ] [MainThread]: 
[0m18:40:48.341000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:48.341160 [info ] [MainThread]: 
[0m18:40:48.341427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:40:48.341874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:40:48.372790 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:40:48.373075 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:40:48.373244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:48.403271 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.030 seconds
[0m18:40:48.404145 [debug] [ThreadPool]: On list_postgres: Close
[0m18:40:48.407555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m18:40:48.411372 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:40:48.411580 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:40:48.411735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:48.423270 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m18:40:48.423496 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:40:48.423680 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:40:48.425699 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:40:48.426427 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:40:48.428640 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:40:48.428960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_ods)
[0m18:40:48.430531 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:40:48.430750 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:40:48.430915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:48.440533 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:40:48.440759 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:40:48.440937 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:40:48.442939 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:40:48.443719 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:40:48.444186 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:40:48.444531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_staging)
[0m18:40:48.446769 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:40:48.446978 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:40:48.447132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:48.456260 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:40:48.456472 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:40:48.456651 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:40:48.458426 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:40:48.459215 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:40:48.459626 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:40:48.463292 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:48.463519 [debug] [MainThread]: On master: BEGIN
[0m18:40:48.463677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:48.470504 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:40:48.470739 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:48.470962 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:40:48.473098 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:40:48.473797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b20a6f2a-37a4-41d6-9c03-2dcdc23708dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c49730>]}
[0m18:40:48.474074 [debug] [MainThread]: On master: ROLLBACK
[0m18:40:48.474515 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:48.474676 [debug] [MainThread]: On master: BEGIN
[0m18:40:48.475310 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:40:48.475494 [debug] [MainThread]: On master: COMMIT
[0m18:40:48.475664 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:48.475820 [debug] [MainThread]: On master: COMMIT
[0m18:40:48.478304 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:40:48.478488 [debug] [MainThread]: On master: Close
[0m18:40:48.480928 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:40:48.481273 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:40:48.481595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.enpal_assessment_project.master_deal)
[0m18:40:48.481803 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:40:48.488933 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:40:48.489642 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:40:48.515488 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:40:48.516211 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:40:48.516452 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:40:48.516652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:48.527648 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:40:48.527865 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:40:48.528189 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
        (current_date - ls.latest_stage_change_at::date)  as days_in_current_stage
      -- date_diff(DATE(fs.first_stage_entered_at), current_date,day) as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:40:48.562295 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.034 seconds
[0m18:40:48.570325 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:40:48.570659 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */
alter table "postgres"."ods"."master_deal" rename to "master_deal__dbt_backup"
[0m18:40:48.572040 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:40:48.574489 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:40:48.574743 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */
alter table "postgres"."ods"."master_deal__dbt_tmp" rename to "master_deal"
[0m18:40:48.575521 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:40:48.587428 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: COMMIT
[0m18:40:48.587700 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:40:48.587910 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: COMMIT
[0m18:40:48.590386 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m18:40:48.594289 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."master_deal__dbt_backup"
[0m18:40:48.596811 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:40:48.597039 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */
drop table if exists "postgres"."ods"."master_deal__dbt_backup" cascade
[0m18:40:48.599623 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m18:40:48.601297 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:40:48.602748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b20a6f2a-37a4-41d6-9c03-2dcdc23708dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc45b0>]}
[0m18:40:48.603234 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ods.master_deal .............................. [[32mSELECT 1995[0m in 0.12s]
[0m18:40:48.603578 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:40:48.604251 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:48.604432 [debug] [MainThread]: On master: BEGIN
[0m18:40:48.604584 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:40:48.611604 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:40:48.611872 [debug] [MainThread]: On master: COMMIT
[0m18:40:48.612082 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:48.612263 [debug] [MainThread]: On master: COMMIT
[0m18:40:48.612703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:40:48.612872 [debug] [MainThread]: On master: Close
[0m18:40:48.613160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:48.613320 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:40:48.613625 [info ] [MainThread]: 
[0m18:40:48.613877 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m18:40:48.614297 [debug] [MainThread]: Command end result
[0m18:40:48.634633 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:40:48.636015 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:40:48.640078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:40:48.640270 [info ] [MainThread]: 
[0m18:40:48.640503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:40:48.640672 [info ] [MainThread]: 
[0m18:40:48.640856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:40:48.641939 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.94232035, "process_in_blocks": "0", "process_kernel_time": 0.168361, "process_mem_max_rss": "132022272", "process_out_blocks": "0", "process_user_time": 1.433342}
[0m18:40:48.642168 [debug] [MainThread]: Command `dbt build` succeeded at 18:40:48.642122 after 0.94 seconds
[0m18:40:48.642370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e26ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ac850>]}
[0m18:40:48.642576 [debug] [MainThread]: Flushing usage events
[0m18:40:49.123623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:24.046448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108637460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108637280>]}


============================== 18:41:24.049572 | 136eb089-06c0-42d1-8b35-ba26c6e48834 ==============================
[0m18:41:24.049572 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:41:24.049907 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s master_deal', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'empty': 'False'}
[0m18:41:24.162730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '136eb089-06c0-42d1-8b35-ba26c6e48834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b161f0>]}
[0m18:41:24.198176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '136eb089-06c0-42d1-8b35-ba26c6e48834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047131c0>]}
[0m18:41:24.199272 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:41:24.269631 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:41:24.365254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:41:24.365637 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:41:24.564779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '136eb089-06c0-42d1-8b35-ba26c6e48834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106087220>]}
[0m18:41:24.633531 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:41:24.635045 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:41:24.655150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '136eb089-06c0-42d1-8b35-ba26c6e48834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ee850>]}
[0m18:41:24.655507 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:41:24.656633 [info ] [MainThread]: 
[0m18:41:24.656831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:24.656993 [info ] [MainThread]: 
[0m18:41:24.657275 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:24.657749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:41:24.688676 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:41:24.688958 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:41:24.689116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:24.724411 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.035 seconds
[0m18:41:24.725279 [debug] [ThreadPool]: On list_postgres: Close
[0m18:41:24.728614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m18:41:24.732389 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:41:24.732596 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:41:24.732796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:24.744030 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:41:24.744288 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:41:24.744482 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:41:24.746680 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:41:24.747560 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:41:24.748067 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:41:24.748527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_ods)
[0m18:41:24.750083 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:41:24.750300 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:41:24.750994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:24.758882 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:41:24.759137 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:41:24.759333 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:41:24.761260 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:41:24.762131 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:41:24.762639 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:41:24.763004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_ods, now list_postgres_pipedrive_analytics)
[0m18:41:24.765276 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:41:24.765491 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:41:24.765671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:24.776055 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:41:24.776297 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:41:24.776484 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:41:24.778744 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:41:24.779521 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:41:24.780037 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:41:24.783469 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:24.783717 [debug] [MainThread]: On master: BEGIN
[0m18:41:24.783878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:24.793951 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m18:41:24.794219 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:24.794441 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:41:24.797260 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m18:41:24.798078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136eb089-06c0-42d1-8b35-ba26c6e48834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108affc70>]}
[0m18:41:24.798399 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:24.799007 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:24.799231 [debug] [MainThread]: On master: BEGIN
[0m18:41:24.801303 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:41:24.801777 [debug] [MainThread]: On master: COMMIT
[0m18:41:24.802021 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:24.802192 [debug] [MainThread]: On master: COMMIT
[0m18:41:24.802727 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:24.803023 [debug] [MainThread]: On master: Close
[0m18:41:24.805644 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:41:24.806107 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:41:24.806516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.master_deal)
[0m18:41:24.806776 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:41:24.813864 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:41:24.814575 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:41:24.838298 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:41:24.839060 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:41:24.839299 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:41:24.839496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:24.852110 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m18:41:24.852462 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:41:24.852800 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
        (current_date - ls.latest_stage_change_at::date)  as days_in_current_stage
       (current_date - fs.first_stage_entered_at::date)as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:41:24.853739 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 147:        (current_date - fs.first_stage_entered_at::date)as da...
                 ^

[0m18:41:24.854341 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: ROLLBACK
[0m18:41:24.855123 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:41:24.870889 [debug] [Thread-1  ]: Database Error in model master_deal (models/master/master_deal.sql)
  syntax error at or near "("
  LINE 147:        (current_date - fs.first_stage_entered_at::date)as da...
                   ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:41:24.872432 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136eb089-06c0-42d1-8b35-ba26c6e48834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783c4f0>]}
[0m18:41:24.873010 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ods.master_deal .......................... [[31mERROR[0m in 0.06s]
[0m18:41:24.873388 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:41:24.873772 [debug] [Thread-4  ]: Marking all children of 'model.enpal_assessment_project.master_deal' to be skipped because of status 'error'.  Reason: Database Error in model master_deal (models/master/master_deal.sql)
  syntax error at or near "("
  LINE 147:        (current_date - fs.first_stage_entered_at::date)as da...
                   ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql.
[0m18:41:24.874529 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:24.874744 [debug] [MainThread]: On master: BEGIN
[0m18:41:24.874916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:24.887716 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m18:41:24.888066 [debug] [MainThread]: On master: COMMIT
[0m18:41:24.888347 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:24.888594 [debug] [MainThread]: On master: COMMIT
[0m18:41:24.889256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:24.889517 [debug] [MainThread]: On master: Close
[0m18:41:24.889935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:24.890170 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:41:24.890355 [info ] [MainThread]: 
[0m18:41:24.890537 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:41:24.890916 [debug] [MainThread]: Command end result
[0m18:41:24.910498 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:41:24.911796 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:41:24.916244 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:41:24.916456 [info ] [MainThread]: 
[0m18:41:24.916661 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:41:24.916828 [info ] [MainThread]: 
[0m18:41:24.917024 [error] [MainThread]: [31mFailure in model master_deal (models/master/master_deal.sql)[0m
[0m18:41:24.917213 [error] [MainThread]:   Database Error in model master_deal (models/master/master_deal.sql)
  syntax error at or near "("
  LINE 147:        (current_date - fs.first_stage_entered_at::date)as da...
                   ^
  compiled code at target/run/enpal_assessment_project/models/master/master_deal.sql
[0m18:41:24.917363 [info ] [MainThread]: 
[0m18:41:24.917539 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/master/master_deal.sql
[0m18:41:24.917683 [info ] [MainThread]: 
[0m18:41:24.917848 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:41:24.918858 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.9135387, "process_in_blocks": "0", "process_kernel_time": 0.165888, "process_mem_max_rss": "132300800", "process_out_blocks": "0", "process_user_time": 1.419792}
[0m18:41:24.919069 [debug] [MainThread]: Command `dbt build` failed at 18:41:24.919025 after 0.91 seconds
[0m18:41:24.919273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108613c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047131c0>]}
[0m18:41:24.919626 [debug] [MainThread]: Flushing usage events
[0m18:41:25.344163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:32.997955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b73850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf3430>]}


============================== 18:41:33.000584 | 225fd1c2-addb-46ef-9f01-ce546730afd8 ==============================
[0m18:41:33.000584 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:41:33.000935 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/sudharsan/dbt_enpal_assessment', 'invocation_command': 'dbt build -s master_deal', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sudharsan/dbt_enpal_assessment/logs', 'warn_error': 'None', 'empty': 'False', 'cache_selected_only': 'False'}
[0m18:41:33.101914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '225fd1c2-addb-46ef-9f01-ce546730afd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c23a0>]}
[0m18:41:33.138386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '225fd1c2-addb-46ef-9f01-ce546730afd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a17bb0>]}
[0m18:41:33.138958 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:41:33.206584 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:41:33.294980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:41:33.295389 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/master/master_deal.sql
[0m18:41:33.486329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '225fd1c2-addb-46ef-9f01-ce546730afd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf3eb0>]}
[0m18:41:33.550006 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:41:33.551089 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:41:33.565399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '225fd1c2-addb-46ef-9f01-ce546730afd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7cfa0>]}
[0m18:41:33.565709 [info ] [MainThread]: Found 11 models, 20 data tests, 7 sources, 448 macros
[0m18:41:33.566855 [info ] [MainThread]: 
[0m18:41:33.567070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:33.567233 [info ] [MainThread]: 
[0m18:41:33.567512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:33.567969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:41:33.594299 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:41:33.594593 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:41:33.594758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:33.613771 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.019 seconds
[0m18:41:33.614548 [debug] [ThreadPool]: On list_postgres: Close
[0m18:41:33.617681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m18:41:33.621433 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:41:33.621619 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:41:33.621776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:33.631159 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:41:33.631414 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:41:33.631611 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:41:33.633567 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m18:41:33.634352 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:41:33.634777 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:41:33.635096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_staging, now list_postgres_pipedrive_analytics)
[0m18:41:33.636514 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:41:33.637220 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m18:41:33.637400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:33.644686 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:41:33.644934 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m18:41:33.645125 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m18:41:33.646955 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:41:33.647691 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m18:41:33.648174 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m18:41:33.648501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now list_postgres_ods)
[0m18:41:33.650370 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:41:33.650574 [debug] [ThreadPool]: On list_postgres_ods: BEGIN
[0m18:41:33.650854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:33.657546 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:41:33.657776 [debug] [ThreadPool]: Using postgres connection "list_postgres_ods"
[0m18:41:33.657952 [debug] [ThreadPool]: On list_postgres_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_ods"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:41:33.659730 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:41:33.660476 [debug] [ThreadPool]: On list_postgres_ods: ROLLBACK
[0m18:41:33.660898 [debug] [ThreadPool]: On list_postgres_ods: Close
[0m18:41:33.664487 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:33.664710 [debug] [MainThread]: On master: BEGIN
[0m18:41:33.664859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:33.671863 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:41:33.672126 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:33.672377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:41:33.674412 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:41:33.675102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '225fd1c2-addb-46ef-9f01-ce546730afd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d22b0>]}
[0m18:41:33.675387 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:33.675824 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:33.676006 [debug] [MainThread]: On master: BEGIN
[0m18:41:33.676806 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:41:33.677087 [debug] [MainThread]: On master: COMMIT
[0m18:41:33.677269 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:33.677437 [debug] [MainThread]: On master: COMMIT
[0m18:41:33.677838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:33.678053 [debug] [MainThread]: On master: Close
[0m18:41:33.679376 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.master_deal
[0m18:41:33.679731 [info ] [Thread-1  ]: 1 of 1 START sql table model ods.master_deal ................................... [RUN]
[0m18:41:33.680000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_ods, now model.enpal_assessment_project.master_deal)
[0m18:41:33.680204 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.master_deal
[0m18:41:33.686433 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.master_deal"
[0m18:41:33.686867 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.master_deal
[0m18:41:33.710242 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.master_deal"
[0m18:41:33.710895 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:41:33.711104 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: BEGIN
[0m18:41:33.711283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:33.721834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:41:33.722051 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:41:33.722382 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */

  
    

  create  table "postgres"."ods"."master_deal__dbt_tmp"
  
  
    as
  
  (
    
-- Get the current stage (most recent stage change)
with latest_stage as (
    select
        deal_id,
        stage_id as current_stage_id,
        stage_name as current_stage_name,
        funnel_step as current_funnel_step,
        change_time_at as latest_stage_change_at,
        month as current_month,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
latest_stage_final as (
    select
        deal_id,
        current_stage_id,
        current_stage_name,
        current_funnel_step,
        latest_stage_change_at,
        current_month
    from latest_stage
    where rn = 1
),
-- Get the first stage (entry point into pipeline)
first_stage as (
    select
        deal_id,
        stage_id as first_stage_id,
        stage_name as first_stage_name,
        change_time_at as first_stage_entered_at,
        month as month_entered_pipeline,
        row_number() over (partition by deal_id order by change_time_at asc) as rn
    from "postgres"."ods"."ods_deal_stage_journey"
),
first_stage_final as (
    select
        deal_id,
        first_stage_id,
        first_stage_name,
        first_stage_entered_at,
        month_entered_pipeline
    from first_stage
    where rn = 1
),
-- Get current owner (most recent user_id assignment)
owner_extraction as (
    select
        deal_id,
        cast(new_value as integer) as current_owner_id,
        change_time_at,
        row_number() over (partition by deal_id order by change_time_at desc) as rn
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
),
current_owner as (
    select
        deal_id,
        current_owner_id
    from owner_extraction
    where rn = 1
),
-- Get owner user details
user_details as (
    select
        user_id,
        user_name,
        user_email
    from "postgres"."staging"."stg_users"
),
-- Aggregate all deal changes
deal_changes_summary as (
    select
        deal_id,
        count(distinct changed_field_key) as total_field_changes,
        max(change_time_at) as last_change_at,
        min(change_time_at) as first_change_at
    from "postgres"."staging"."stg_deal_changes"
    where deal_id is not null
    group by deal_id
),
-- Count owner reassignments (times deal was reassigned)
owner_reassignments as (
    select
        deal_id,
        count(distinct new_value) as times_reassigned
    from "postgres"."staging"."stg_deal_changes"
    where changed_field_key = 'user_id'
        and new_value is not null
    group by deal_id
),
-- Aggregate activities on the deal
activity_summary as (
    select
        deal_id,
        count(distinct activity_id) as total_activities,
        count(distinct case when is_completed then activity_id end) as completed_activities,
        count(distinct case when is_funnel_tracked then activity_id end) as funnel_tracked_activities,
        max(due_to) as last_activity_date,
        count(distinct assigned_to_user) as unique_users_performed_activities
    from "postgres"."ods"."ods_deal_activity_funnel"
    where deal_id is not null
    group by deal_id
),
-- Combine all metrics
final_combined as (
    select
        ls.deal_id,       
        -- Latest stage of the deal 
        ls.current_stage_id,
        ls.current_stage_name,
        ls.current_funnel_step,
        ls.latest_stage_change_at,
        ls.current_month,  
        -- First stage of the deal 
        fs.first_stage_id,
        fs.first_stage_name,
        fs.first_stage_entered_at,
        -- Current Owner
        co.current_owner_id,
        ud.user_name as current_owner_name,
        ud.user_email as current_owner_email,
        -- Deal Changes Summary
        coalesce(dcs.total_field_changes, 0) as total_field_changes,
        dcs.last_change_at as last_change_at,
        dcs.first_change_at as first_change_at,
        coalesce(ore.times_reassigned, 0) as times_reassigned, 
        -- Activity Summary
        coalesce(act.total_activities, 0) as total_activities,
        coalesce(act.completed_activities, 0) as completed_activities,
        coalesce(act.funnel_tracked_activities, 0) as funnel_tracked_activities,
        act.last_activity_date,
        -- Derived Metrics
        (current_date - ls.latest_stage_change_at::date)  as days_in_current_stage,
       (current_date - fs.first_stage_entered_at::date)as days_in_pipeline
    from latest_stage_final ls
    left join first_stage_final fs on ls.deal_id = fs.deal_id
    left join deal_changes_summary dcs on ls.deal_id = dcs.deal_id
    left join owner_reassignments ore on ls.deal_id = ore.deal_id
    left join activity_summary act on ls.deal_id = act.deal_id
    left join current_owner co on ls.deal_id = co.deal_id
    left join user_details ud on co.current_owner_id = ud.user_id
)
select * from final_combined
  );
  
[0m18:41:33.759921 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.037 seconds
[0m18:41:33.767200 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:41:33.767479 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */
alter table "postgres"."ods"."master_deal" rename to "master_deal__dbt_backup"
[0m18:41:33.768178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:41:33.770328 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:41:33.770573 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */
alter table "postgres"."ods"."master_deal__dbt_tmp" rename to "master_deal"
[0m18:41:33.771112 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:41:33.782396 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: COMMIT
[0m18:41:33.782660 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:41:33.782865 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: COMMIT
[0m18:41:33.784514 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:41:33.788504 [debug] [Thread-1  ]: Applying DROP to: "postgres"."ods"."master_deal__dbt_backup"
[0m18:41:33.791033 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.master_deal"
[0m18:41:33.791254 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.master_deal"} */
drop table if exists "postgres"."ods"."master_deal__dbt_backup" cascade
[0m18:41:33.792911 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m18:41:33.794474 [debug] [Thread-1  ]: On model.enpal_assessment_project.master_deal: Close
[0m18:41:33.795624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225fd1c2-addb-46ef-9f01-ce546730afd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21c970>]}
[0m18:41:33.796066 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ods.master_deal .............................. [[32mSELECT 1995[0m in 0.11s]
[0m18:41:33.796406 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.master_deal
[0m18:41:33.797018 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:33.797217 [debug] [MainThread]: On master: BEGIN
[0m18:41:33.797376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:33.804444 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:41:33.804705 [debug] [MainThread]: On master: COMMIT
[0m18:41:33.804877 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:33.805032 [debug] [MainThread]: On master: COMMIT
[0m18:41:33.805524 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:41:33.805819 [debug] [MainThread]: On master: Close
[0m18:41:33.806088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:33.806249 [debug] [MainThread]: Connection 'model.enpal_assessment_project.master_deal' was properly closed.
[0m18:41:33.806424 [info ] [MainThread]: 
[0m18:41:33.806612 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:41:33.807014 [debug] [MainThread]: Command end result
[0m18:41:33.827431 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sudharsan/dbt_enpal_assessment/target/manifest.json
[0m18:41:33.828638 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sudharsan/dbt_enpal_assessment/target/semantic_manifest.json
[0m18:41:33.832877 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sudharsan/dbt_enpal_assessment/target/run_results.json
[0m18:41:33.833118 [info ] [MainThread]: 
[0m18:41:33.833358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:33.833560 [info ] [MainThread]: 
[0m18:41:33.833770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:41:33.834791 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.87705815, "process_in_blocks": "0", "process_kernel_time": 0.139285, "process_mem_max_rss": "132841472", "process_out_blocks": "0", "process_user_time": 1.430931}
[0m18:41:33.835022 [debug] [MainThread]: Command `dbt build` succeeded at 18:41:33.834971 after 0.88 seconds
[0m18:41:33.835244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b73850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e8790>]}
[0m18:41:33.835467 [debug] [MainThread]: Flushing usage events
[0m18:41:34.269123 [debug] [MainThread]: An error was encountered while trying to flush usage events
